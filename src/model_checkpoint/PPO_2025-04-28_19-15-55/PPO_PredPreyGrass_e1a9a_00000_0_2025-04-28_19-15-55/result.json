{"timers": {"training_iteration": 23.154309026000192, "restore_env_runners": 1.2433999927452533e-05, "training_step": 23.154175748999933, "env_runner_sampling_timer": 1.1146069820001685, "learner_update_timer": 22.029542643999775, "synch_weights": 0.00755895700012843}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 706, "speed_1_prey_5": 684, "speed_1_prey_2": 637, "speed_1_predator_0": 621, "speed_2_predator_2": 712, "speed_1_prey_7": 42, "speed_2_prey_5": 458, "speed_1_prey_3": 594, "speed_1_prey_6": 44, "speed_2_prey_3": 559, "speed_1_predator_2": 613, "speed_2_prey_0": 694, "speed_1_predator_4": 34, "speed_1_prey_8": 23, "speed_2_predator_0": 623, "speed_2_prey_4": 753, "speed_2_predator_3": 793, "speed_1_prey_9": 2, "speed_1_prey_1": 582, "speed_1_prey_0": 480, "speed_1_predator_1": 765, "speed_1_predator_3": 598, "speed_2_predator_1": 565, "speed_2_prey_1": 528, "speed_1_prey_4": 616}, "agent_episode_returns_mean": {"speed_1_prey_2": 0.0, "speed_1_prey_1": 2.5, "speed_1_predator_1": 1.25, "speed_2_predator_1": 0.0, "speed_1_prey_7": 0.0, "speed_2_prey_1": 0.0, "speed_1_prey_4": 0.0, "speed_1_prey_5": 2.5, "speed_1_predator_0": 0.0, "speed_2_predator_2": 0.0, "speed_2_prey_5": 1.25, "speed_1_prey_3": 1.25, "speed_1_prey_6": 0.0, "speed_2_prey_3": 0.0, "speed_1_predator_2": 0.0, "speed_2_prey_0": 0.0, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 5.0, "speed_2_predator_0": 0.0, "speed_1_predator_3": 0.0, "speed_2_prey_4": 7.5, "speed_2_predator_3": 1.25, "speed_2_prey_2": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.241527550244489e-05, "add_states_from_episodes_to_batch": 7.15557676075372e-06, "add_observations_from_episodes_to_batch": 9.862241950665032e-05, "add_time_dim_to_batch_and_zero_pad": 1.3085512447678237e-05, "agent_to_module_mapping": 1.041025947616574e-05, "numpy_to_tensor": 7.986147964272349e-05}}, "connector_pipeline_timer": 0.0003171093636714275}, "num_agent_steps_sampled": {"speed_1_prey_9": 2, "speed_1_prey_1": 582, "speed_1_prey_0": 480, "speed_1_predator_1": 765, "speed_1_predator_3": 598, "speed_2_predator_1": 565, "speed_2_prey_1": 528, "speed_1_prey_4": 616, "speed_2_prey_2": 706, "speed_1_prey_5": 684, "speed_1_prey_2": 637, "speed_1_predator_0": 621, "speed_2_predator_2": 712, "speed_1_prey_7": 42, "speed_2_prey_5": 458, "speed_1_prey_3": 594, "speed_1_prey_6": 44, "speed_2_prey_3": 559, "speed_1_predator_2": 613, "speed_1_predator_4": 34, "speed_1_prey_8": 23, "speed_2_predator_0": 623, "speed_2_prey_4": 753, "speed_2_predator_3": 793, "speed_2_prey_0": 694}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 48.625, "speed_1_prey_0": 44.375, "speed_1_predator_1": 64.375, "speed_1_predator_3": 46.25, "speed_1_prey_4": 65.5, "speed_2_prey_2": 62.625, "speed_1_prey_5": 59.125, "speed_1_prey_2": 58.25, "speed_2_predator_2": 58.0, "speed_2_predator_1": 40.5, "speed_1_prey_7": 41.0, "speed_2_prey_1": 49.125, "speed_2_prey_5": 38.0, "speed_2_prey_3": 39.375, "speed_1_predator_2": 49.875, "speed_1_predator_0": 49.125, "speed_1_predator_4": 34.0, "speed_1_prey_3": 48.75, "speed_1_prey_6": 43.0, "speed_1_prey_8": 22.0, "speed_2_predator_0": 44.625, "speed_2_prey_4": 73.0, "speed_2_predator_3": 68.625, "speed_2_prey_0": 61.25}, "num_module_steps_sampled": {"speed_2_prey": 3698, "speed_1_prey": 3704, "speed_2_predator": 2693, "speed_1_predator": 2631}, "module_episode_returns_mean": {"speed_2_predator": 1.25, "speed_2_prey": 1.25, "speed_1_prey": 2.5, "speed_1_predator": 0.0}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.364653177879392e-06, "tensor_to_numpy": 0.0001508476986008954, "listify_data_for_vector_env": 5.8426249771616936e-05, "un_batch_to_individual_items": 0.00016292439028779598, "get_actions": 0.0005683564394775573, "remove_single_ts_time_rank_from_batch": 1.964674744842603e-06, "normalize_and_clip_actions": 0.00023987915249849235}}, "connector_pipeline_timer": 0.0012663202352916755}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 8, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 60.0, "num_episodes_lifetime": 8, "num_module_steps_sampled_lifetime": {"speed_2_predator": 2693, "speed_2_prey": 3698, "speed_1_prey": 3704, "speed_1_predator": 2631}, "env_step_timer": 0.002624124597380928, "episode_return_min": 0.0, "episode_length": 79.53, "rlmodule_inference_timer": 0.0033700102744441147, "episode_return_mean": 22.5, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime": 1024, "episode_len_max": 123, "num_env_steps_sampled": 1024, "env_to_module_sum_episodes_length_out": 62.74745409789266, "env_to_module_sum_episodes_length_in": 62.74745409789266, "sample": 0.9458658477500421, "episode_len_mean": 93.25, "episode_len_min": 61, "episode_duration_sec_mean": 0.6651598614999443, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.6372925639152527, "policy_loss": -0.052799977362155914, "entropy": 2.192376136779785, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "weights_seq_no": 1.0, "total_loss": 0.02758336067199707, "gradients_default_optimizer_global_norm": 0.021304504945874214, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.07936525344848633, "num_module_steps_trained_lifetime": 114816, "mean_kl_loss": 0.005090388003736734, "vf_explained_var": -0.001694321632385254, "num_module_steps_trained": 114816, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1668570520000685, "add_states_from_episodes_to_batch": 8.25000006443588e-06, "general_advantage_estimation": 0.1540500080000129, "add_columns_from_episodes_to_train_batch": 0.09667361399988295, "add_one_ts_to_episodes_and_truncate": 0.03743563499983793, "add_observations_from_episodes_to_batch": 0.0015740439998808142, "add_time_dim_to_batch_and_zero_pad": 2.5267999717470957e-05, "agent_to_module_mapping": 0.006360653000228922, "numpy_to_tensor": 0.007662917000288871}}, "connector_pipeline_timer": 0.47093767800015485}, "learner_connector_sum_episodes_length_out": 1024, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 459264, "learner_connector_sum_episodes_length_in": 1024, "num_module_steps_trained": 459264, "num_trainable_parameters": 341960, "num_env_steps_trained_lifetime": 918528, "num_env_steps_trained": 918528, "num_env_steps_trained_lifetime_throughput": NaN}, "speed_2_predator": {"num_module_steps_trained_lifetime": 114816, "mean_kl_loss": 0.01654306799173355, "vf_explained_var": 2.1576881408691406e-05, "num_module_steps_trained": 114816, "num_trainable_parameters": 94938, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.595705509185791, "policy_loss": -0.2959398925304413, "entropy": 3.2019238471984863, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224, "weights_seq_no": 1.0, "total_loss": 0.02736896090209484, "gradients_default_optimizer_global_norm": 0.041100431233644485, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.32000023126602173}, "speed_2_prey": {"vf_explained_var": 5.84721565246582e-05, "policy_loss": -0.23488713800907135, "entropy": 3.1781539916992188, "curr_kl_coeff": 0.30000001192092896, "weights_seq_no": 1.0, "total_loss": 0.6531738042831421, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.14026299118995667, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.8800002336502075, "num_module_steps_trained": 114816, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826, "num_module_steps_trained_lifetime": 114816, "mean_kl_loss": 0.04030361771583557, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 15.746804237365723}, "speed_1_prey": {"policy_loss": -0.20101825892925262, "entropy": 2.163524866104126, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896, "weights_seq_no": 1.0, "total_loss": 0.9959593415260315, "gradients_default_optimizer_global_norm": 0.43811309337615967, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.190476417541504, "num_module_steps_trained_lifetime": 114816, "vf_explained_var": -0.0002734661102294922, "num_module_steps_trained": 114816, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946, "mean_kl_loss": 0.03250507265329361, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 13.7941312789917}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 1024, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": NaN, "done": false, "training_iteration": 1, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-16-28", "timestamp": 1745892988, "time_this_iter_s": 23.862523555755615, "time_total_s": 23.862523555755615, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0976d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.862523555755615, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 9.684375, "ram_util_percent": 40.728125, "gpu_util_percent0": 0.3103125, "vram_util_percent0": 0.15725248330890734}, "timing/iter_minutes": 0.5190902551015218, "timing/avg_minutes_per_iter": 0.5190902551015218, "timing/total_hours_elapsed": 0.008651504251692031}
{"timers": {"training_iteration": 23.134511617360193, "restore_env_runners": 1.247053992756264e-05, "training_step": 23.134376586109934, "env_runner_sampling_timer": 1.113800309820167, "learner_update_timer": 22.01054509282978, "synch_weights": 0.007557950360128417, "synch_env_connectors": 0.0023140770003919897}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 1408, "speed_1_prey_5": 1093, "speed_1_prey_2": 1316, "speed_1_predator_0": 1141, "speed_2_predator_2": 1375, "speed_1_prey_7": 42, "speed_2_prey_5": 975, "speed_1_prey_3": 1211, "speed_1_prey_6": 44, "speed_2_prey_3": 1199, "speed_1_predator_2": 1109, "speed_2_prey_0": 1463, "speed_1_predator_4": 34, "speed_1_prey_8": 23, "speed_2_predator_0": 1167, "speed_2_prey_4": 1161, "speed_2_predator_3": 1206, "speed_1_prey_9": 2, "speed_1_prey_1": 1302, "speed_1_prey_0": 990, "speed_1_predator_1": 1270, "speed_1_predator_3": 1054, "speed_2_predator_1": 1197, "speed_2_prey_1": 1049, "speed_1_prey_4": 1076, "speed_2_prey_6": 9}, "agent_episode_returns_mean": {"speed_1_prey_2": 1.2, "speed_1_prey_1": 1.9, "speed_1_predator_1": 0.7, "speed_2_predator_1": 0.0, "speed_1_prey_7": 0.0, "speed_2_prey_1": 0.0, "speed_1_prey_4": 0.0, "speed_1_prey_5": 1.5, "speed_1_predator_0": 0.0, "speed_2_predator_2": 0.0, "speed_2_prey_5": 0.7, "speed_1_prey_3": 0.7, "speed_1_prey_6": 0.0, "speed_2_prey_3": 1.6, "speed_1_predator_2": 0.0, "speed_2_prey_0": 1.6, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 3.2, "speed_2_predator_0": 0.0, "speed_1_predator_3": 0.0, "speed_2_prey_4": 4.7, "speed_2_predator_3": 0.8, "speed_2_prey_2": 0.4, "speed_2_prey_6": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.215584650594851e-05, "add_states_from_episodes_to_batch": 7.150462945195806e-06, "add_observations_from_episodes_to_batch": 9.829490800184329e-05, "add_time_dim_to_batch_and_zero_pad": 1.3051721625647708e-05, "agent_to_module_mapping": 1.0370630410477168e-05, "numpy_to_tensor": 7.974329044910246e-05}}, "connector_pipeline_timer": 0.0003161535552889729}, "num_agent_steps_sampled": {"speed_1_prey_9": 0, "speed_1_prey_1": 720, "speed_1_prey_0": 510, "speed_1_predator_1": 505, "speed_1_predator_3": 456, "speed_2_predator_1": 632, "speed_2_prey_1": 521, "speed_1_prey_4": 460, "speed_2_prey_2": 702, "speed_1_prey_5": 409, "speed_1_prey_2": 679, "speed_1_predator_0": 520, "speed_2_predator_2": 663, "speed_1_prey_7": 0, "speed_2_prey_5": 517, "speed_1_prey_3": 617, "speed_1_prey_6": 0, "speed_2_prey_3": 640, "speed_1_predator_2": 496, "speed_1_predator_4": 0, "speed_1_prey_8": 0, "speed_2_predator_0": 544, "speed_2_prey_4": 408, "speed_2_predator_3": 413, "speed_2_prey_0": 769, "speed_2_prey_6": 9}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 55.29, "speed_1_prey_0": 44.28, "speed_1_predator_1": 60.91, "speed_1_predator_3": 45.0, "speed_1_prey_4": 53.62, "speed_2_prey_2": 60.93, "speed_1_prey_5": 55.57, "speed_1_prey_2": 59.63, "speed_2_predator_2": 58.62, "speed_2_predator_1": 46.9, "speed_1_prey_7": 41.0, "speed_2_prey_1": 51.37, "speed_2_prey_5": 39.91, "speed_2_prey_3": 45.28, "speed_1_predator_2": 45.21, "speed_1_predator_0": 46.97, "speed_1_predator_4": 34.0, "speed_1_prey_3": 50.76, "speed_1_prey_6": 43.0, "speed_1_prey_8": 22.0, "speed_2_predator_0": 49.45, "speed_2_prey_4": 62.73, "speed_2_predator_3": 59.2, "speed_2_prey_0": 60.48, "speed_2_prey_6": 3.0}, "num_module_steps_sampled": {"speed_2_prey": 3566, "speed_1_prey": 3395, "speed_2_predator": 2252, "speed_1_predator": 1977}, "module_episode_returns_mean": {"speed_2_predator": 0.8, "speed_2_prey": 1.9, "speed_1_prey": 1.5, "speed_1_predator": 0.0}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.320087124872988e-06, "tensor_to_numpy": 0.0001490014151447324, "listify_data_for_vector_env": 5.7958750839143426e-05, "un_batch_to_individual_items": 0.00016149752311235872, "get_actions": 0.0005642637958880103, "remove_single_ts_time_rank_from_batch": 1.956883045417073e-06, "normalize_and_clip_actions": 0.00023688166162860516}}, "connector_pipeline_timer": 0.0012549594122332215}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 10, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 60.0, "num_episodes_lifetime": 18, "num_module_steps_sampled_lifetime": {"speed_2_predator": 4945, "speed_2_prey": 7264, "speed_1_prey": 7099, "speed_1_predator": 4608}, "env_step_timer": 0.002611814335357992, "episode_return_min": 0.0, "episode_length": 79.5354525215997, "rlmodule_inference_timer": 0.0033401960644147935, "episode_return_mean": 18.7, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 2050, "episode_len_max": 132, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 63.31219739687072, "env_to_module_sum_episodes_length_in": 63.31219739687072, "sample": 0.9458517441505082, "episode_len_mean": 90.63, "episode_len_min": 53, "episode_duration_sec_mean": 0.6381615800900227, "time_between_sampling": 22.26271316700013, "num_env_steps_sampled_lifetime_throughput": 48.33016216104865}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 7.526554668402241e-08, "policy_loss": -0.15039373934268951, "entropy": 2.1438145637512207, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896, "weights_seq_no": 2.0, "total_loss": -0.14139193296432495, "gradients_default_optimizer_global_norm": 0.2099572718143463, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 7.526554668402241e-08, "num_module_steps_trained_lifetime": 224512, "mean_kl_loss": 0.04500874876976013, "vf_explained_var": 0.9269513487815857, "num_module_steps_trained": 109696, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1668564718500685, "add_states_from_episodes_to_batch": 8.249825864459126e-06, "general_advantage_estimation": 0.15403806319641292, "add_columns_from_episodes_to_train_batch": 0.09667237241098296, "add_one_ts_to_episodes_and_truncate": 0.03743332111173795, "add_observations_from_episodes_to_batch": 0.0015739978848808276, "add_time_dim_to_batch_and_zero_pad": 2.5267641517484663e-05, "agent_to_module_mapping": 0.0063605297102288655, "numpy_to_tensor": 0.007662962127688843}}, "connector_pipeline_timer": 0.47092145726425483}, "learner_connector_sum_episodes_length_out": 1024.0002, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 898048, "learner_connector_sum_episodes_length_in": 1024.0002, "num_module_steps_trained": 438784, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 1797810, "num_env_steps_trained": 879282, "num_env_steps_trained_lifetime_throughput": 41418.822668775}, "speed_2_predator": {"num_module_steps_trained_lifetime": 224512, "mean_kl_loss": 0.036097459495067596, "vf_explained_var": 0.9163443446159363, "num_module_steps_trained": 109696, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 9.633415487542152e-08, "policy_loss": -0.15190398693084717, "entropy": 3.157956600189209, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896, "weights_seq_no": 2.0, "total_loss": -0.14468441903591156, "gradients_default_optimizer_global_norm": 0.20387400686740875, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 9.633415487542152e-08}, "speed_2_prey": {"vf_explained_var": -0.00014197826385498047, "policy_loss": -0.2502053380012512, "entropy": 3.1449503898620605, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 2.0, "total_loss": 1.2806603908538818, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.26860862970352173, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.5199999809265137, "num_module_steps_trained": 109696, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 224512, "mean_kl_loss": 0.03621852770447731, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 10.747333526611328}, "speed_1_prey": {"policy_loss": 0.03505370765924454, "entropy": 2.1511058807373047, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30000001192092896, "weights_seq_no": 2.0, "total_loss": 0.3630737066268921, "gradients_default_optimizer_global_norm": 0.29412102699279785, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3225807249546051, "num_module_steps_trained_lifetime": 224512, "vf_explained_var": 0.00010782480239868164, "num_module_steps_trained": 109696, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.01813085563480854, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.2529475688934326}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2050, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 48.33016216104865, "done": false, "training_iteration": 2, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-16-50", "timestamp": 1745893010, "time_this_iter_s": 21.881853818893433, "time_total_s": 45.74437737464905, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0977c40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.74437737464905, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 9.48333333333333, "ram_util_percent": 41.36333333333334, "gpu_util_percent0": 0.35666666666666674, "vram_util_percent0": 0.16099440916245994}, "timing/iter_minutes": 0.36547985474268596, "timing/avg_minutes_per_iter": 0.4422850549221039, "timing/total_hours_elapsed": 0.01474283516407013}
{"timers": {"training_iteration": 23.12621769247659, "restore_env_runners": 1.2438054530730368e-05, "training_step": 23.126080709018837, "env_runner_sampling_timer": 1.1122287706119658, "learner_update_timer": 22.003821881971483, "synch_weights": 0.007550856766523658, "synch_env_connectors": 0.0023139544803871103}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 1952, "speed_1_prey_5": 1414, "speed_1_prey_2": 1905, "speed_1_predator_0": 1633, "speed_2_predator_2": 1865, "speed_1_prey_7": 42, "speed_2_prey_5": 1461, "speed_1_prey_3": 1945, "speed_1_prey_6": 76, "speed_2_prey_3": 1875, "speed_1_predator_2": 1576, "speed_2_prey_0": 2325, "speed_1_predator_4": 34, "speed_1_prey_8": 23, "speed_2_predator_0": 1659, "speed_2_prey_4": 1696, "speed_2_predator_3": 1771, "speed_1_prey_9": 2, "speed_1_prey_1": 1933, "speed_1_prey_0": 1732, "speed_1_predator_1": 1664, "speed_1_predator_3": 1501, "speed_2_predator_1": 1818, "speed_2_prey_1": 1525, "speed_1_prey_4": 1699, "speed_2_prey_6": 84, "speed_2_predator_4": 68, "speed_2_predator_5": 83, "speed_2_prey_7": 111}, "agent_episode_returns_mean": {"speed_1_prey_2": 1.2, "speed_1_prey_1": 2.0, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.4, "speed_1_prey_7": 0.0, "speed_2_prey_1": 0.0, "speed_1_prey_4": 0.0, "speed_1_prey_5": 1.0, "speed_1_predator_0": 0.0, "speed_2_predator_2": 0.0, "speed_2_prey_5": 0.2, "speed_1_prey_3": 1.2, "speed_1_prey_6": 0.0, "speed_2_prey_3": 2.4, "speed_1_predator_2": 0.0, "speed_2_prey_0": 3.2, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 2.4, "speed_2_predator_0": 0.0, "speed_1_predator_3": 0.0, "speed_2_prey_4": 2.4, "speed_2_predator_3": 1.0, "speed_2_prey_2": 0.8, "speed_2_prey_6": 0.0, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.18530327765536e-05, "add_states_from_episodes_to_batch": 7.1458486925499474e-06, "add_observations_from_episodes_to_batch": 9.792401763115423e-05, "add_time_dim_to_batch_and_zero_pad": 1.2999714007111396e-05, "agent_to_module_mapping": 1.0319453232300268e-05, "numpy_to_tensor": 7.958506121402357e-05}}, "connector_pipeline_timer": 0.00031499134710021395}, "num_agent_steps_sampled": {"speed_1_prey_9": 0, "speed_1_prey_1": 631, "speed_1_prey_0": 742, "speed_1_predator_1": 394, "speed_1_predator_3": 447, "speed_2_predator_1": 621, "speed_2_prey_1": 476, "speed_1_prey_4": 623, "speed_2_prey_2": 544, "speed_1_prey_5": 321, "speed_1_prey_2": 589, "speed_1_predator_0": 492, "speed_2_predator_2": 490, "speed_1_prey_7": 0, "speed_2_prey_5": 486, "speed_1_prey_3": 734, "speed_1_prey_6": 32, "speed_2_prey_3": 676, "speed_1_predator_2": 467, "speed_1_predator_4": 0, "speed_1_prey_8": 0, "speed_2_predator_0": 492, "speed_2_prey_4": 535, "speed_2_predator_3": 565, "speed_2_prey_0": 862, "speed_2_prey_6": 75, "speed_2_predator_5": 83, "speed_2_prey_7": 111, "speed_2_predator_4": 68}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 63.1, "speed_1_prey_0": 50.68, "speed_1_predator_1": 49.72, "speed_1_predator_3": 42.52, "speed_1_prey_4": 47.22, "speed_2_prey_2": 60.06, "speed_1_prey_5": 43.72, "speed_1_prey_2": 57.48, "speed_2_predator_2": 61.24, "speed_2_predator_1": 58.56, "speed_1_prey_7": 41.0, "speed_2_prey_1": 47.26, "speed_2_prey_5": 42.9, "speed_2_prey_3": 59.24, "speed_1_predator_2": 46.72, "speed_1_predator_0": 50.92, "speed_1_predator_4": 34.0, "speed_1_prey_3": 59.92, "speed_1_prey_6": 43.0, "speed_1_prey_8": 22.0, "speed_2_predator_0": 48.44, "speed_2_prey_4": 52.2, "speed_2_predator_3": 50.9, "speed_2_prey_0": 70.34, "speed_2_prey_6": 3.0, "speed_2_predator_5": 83.0, "speed_2_predator_4": 34.0}, "num_module_steps_sampled": {"speed_2_prey": 3765, "speed_1_prey": 3672, "speed_2_predator": 2319, "speed_1_predator": 1800}, "module_episode_returns_mean": {"speed_2_predator": 0.2, "speed_2_prey": 2.4, "speed_1_prey": 1.8, "speed_1_predator": 0.0}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.265769818800472e-06, "tensor_to_numpy": 0.00014663044856532383, "listify_data_for_vector_env": 5.740026355180886e-05, "un_batch_to_individual_items": 0.00015981549838910348, "get_actions": 0.0005586993294629703, "remove_single_ts_time_rank_from_batch": 1.9452222240851617e-06, "normalize_and_clip_actions": 0.00023325507443359842}}, "connector_pipeline_timer": 0.001240463567004433}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 10, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 60.0, "num_episodes_lifetime": 28, "num_module_steps_sampled_lifetime": {"speed_2_predator": 7264, "speed_2_prey": 11029, "speed_1_prey": 10771, "speed_1_predator": 6408}, "env_step_timer": 0.002597632182249322, "episode_return_min": 0.0, "episode_length": 79.56545674300317, "rlmodule_inference_timer": 0.003301802404868207, "episode_return_mean": 16.8, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": 3076, "episode_len_max": 161, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 64.10680310763692, "env_to_module_sum_episodes_length_in": 64.10680310763692, "sample": 0.945814818097594, "episode_len_mean": 95.26, "episode_len_min": 53, "episode_duration_sec_mean": 0.6424665808400732, "time_between_sampling": 22.26194742921379, "num_env_steps_sampled_lifetime_throughput": 45.883014855672336}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 3.431963335742694e-08, "policy_loss": -0.3038673400878906, "entropy": 2.1133017539978027, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 3.0, "total_loss": -0.2958075702190399, "gradients_default_optimizer_global_norm": 0.27781248092651367, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 3.431963335742694e-08, "num_module_steps_trained_lifetime": 340480, "mean_kl_loss": 0.02686573565006256, "vf_explained_var": 0.9708589911460876, "num_module_steps_trained": 115968, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1668547517675685, "add_states_from_episodes_to_batch": 8.249594248489302e-06, "general_advantage_estimation": 0.15401473013708494, "add_columns_from_episodes_to_train_batch": 0.09667005146896099, "add_one_ts_to_episodes_and_truncate": 0.037428785707099975, "add_observations_from_episodes_to_batch": 0.0015739021572808486, "add_time_dim_to_batch_and_zero_pad": 2.5267223781521353e-05, "agent_to_module_mapping": 0.006360294959528776, "numpy_to_tensor": 0.007662780584440752}}, "connector_pipeline_timer": 0.47088900534967276}, "learner_connector_sum_episodes_length_out": 1024.0005959999999, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 1361920, "learner_connector_sum_episodes_length_in": 1024.0005959999999, "num_module_steps_trained": 463872, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 2727366, "num_env_steps_trained": 929556, "num_env_steps_trained_lifetime_throughput": 41570.084355372244}, "speed_2_predator": {"num_module_steps_trained_lifetime": 340480, "mean_kl_loss": 0.028341831639409065, "vf_explained_var": -4.029273986816406e-05, "num_module_steps_trained": 115968, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 5.497128963470459, "policy_loss": -0.10709061473608017, "entropy": 3.133812189102173, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 3.0, "total_loss": 0.385282963514328, "gradients_default_optimizer_global_norm": 0.14076277613639832, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.4838710129261017}, "speed_2_prey": {"vf_explained_var": 2.5570392608642578e-05, "policy_loss": -0.1814219057559967, "entropy": 3.100511074066162, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 3.0, "total_loss": 1.1704190969467163, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.5520385503768921, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.3385826349258423, "num_module_steps_trained": 115968, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 340480, "mean_kl_loss": 0.029462577775120735, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 8.68813419342041}, "speed_1_prey": {"policy_loss": -0.2876380980014801, "entropy": 2.123645305633545, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 3.0, "total_loss": 0.8405348658561707, "gradients_default_optimizer_global_norm": 0.31374260783195496, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.1200000047683716, "num_module_steps_trained_lifetime": 340480, "vf_explained_var": -1.7642974853515625e-05, "num_module_steps_trained": 115968, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.02724265865981579, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 7.499492168426514}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 3076, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.883014855672336, "done": false, "training_iteration": 3, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-17-12", "timestamp": 1745893032, "time_this_iter_s": 22.313300132751465, "time_total_s": 68.05767750740051, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0977ec0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.05767750740051, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 9.412903225806453, "ram_util_percent": 41.45806451612904, "gpu_util_percent0": 0.3638709677419356, "vram_util_percent0": 0.16056016935352543}, "timing/iter_minutes": 0.3726832588513692, "timing/avg_minutes_per_iter": 0.41908445623185897, "timing/total_hours_elapsed": 0.02095422281159295}
{"timers": {"training_iteration": 23.118869052001823, "restore_env_runners": 1.243470398786985e-05, "training_step": 23.118730159338647, "env_runner_sampling_timer": 1.1107447011458482, "learner_update_timer": 21.997951588211766, "synch_weights": 0.007545773648857186, "synch_env_connectors": 0.0023114365455846383}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 2604, "speed_1_prey_5": 1811, "speed_1_prey_2": 2630, "speed_1_predator_0": 2167, "speed_2_predator_2": 2385, "speed_1_prey_7": 42, "speed_2_prey_5": 2030, "speed_1_prey_3": 2483, "speed_1_prey_6": 89, "speed_2_prey_3": 2459, "speed_1_predator_2": 2032, "speed_2_prey_0": 2886, "speed_1_predator_4": 68, "speed_1_prey_8": 23, "speed_2_predator_0": 2280, "speed_2_prey_4": 2366, "speed_2_predator_3": 2570, "speed_1_prey_9": 2, "speed_1_prey_1": 2436, "speed_1_prey_0": 2611, "speed_1_predator_1": 2224, "speed_1_predator_3": 1995, "speed_2_predator_1": 2236, "speed_2_prey_1": 2048, "speed_1_prey_4": 2194, "speed_2_prey_6": 114, "speed_2_predator_4": 68, "speed_2_predator_5": 83, "speed_2_prey_7": 197}, "agent_episode_returns_mean": {"speed_1_prey_2": 1.2, "speed_1_prey_1": 1.3, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.4, "speed_1_prey_7": 0.0, "speed_2_prey_1": 0.8, "speed_1_prey_4": 0.4, "speed_1_prey_5": 0.4, "speed_1_predator_0": 0.0, "speed_2_predator_2": 0.0, "speed_2_prey_5": 0.0, "speed_1_prey_3": 2.8, "speed_1_prey_6": 0.0, "speed_2_prey_3": 3.6, "speed_1_predator_2": 0.0, "speed_2_prey_0": 3.3, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 2.0, "speed_2_predator_0": 0.4, "speed_1_predator_3": 0.0, "speed_2_prey_4": 1.6, "speed_2_predator_3": 1.6, "speed_2_prey_2": 2.5, "speed_2_prey_6": 0.0, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 40.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.153120130964707e-05, "add_states_from_episodes_to_batch": 7.13487075896965e-06, "add_observations_from_episodes_to_batch": 9.754919702691423e-05, "add_time_dim_to_batch_and_zero_pad": 1.295050793328757e-05, "agent_to_module_mapping": 1.0265124077376063e-05, "numpy_to_tensor": 7.946521318740401e-05}}, "connector_pipeline_timer": 0.000313835034883537}, "num_agent_steps_sampled": {"speed_1_prey_9": 0, "speed_1_prey_1": 503, "speed_1_prey_0": 879, "speed_1_predator_1": 560, "speed_1_predator_3": 494, "speed_2_predator_1": 418, "speed_2_prey_1": 523, "speed_1_prey_4": 495, "speed_2_prey_2": 652, "speed_1_prey_5": 397, "speed_1_prey_2": 725, "speed_1_predator_0": 534, "speed_2_predator_2": 520, "speed_1_prey_7": 0, "speed_2_prey_5": 569, "speed_1_prey_3": 538, "speed_1_prey_6": 13, "speed_2_prey_3": 584, "speed_1_predator_2": 456, "speed_1_predator_4": 34, "speed_1_prey_8": 0, "speed_2_predator_0": 621, "speed_2_prey_4": 670, "speed_2_predator_3": 799, "speed_2_prey_0": 561, "speed_2_prey_6": 30, "speed_2_predator_5": 0, "speed_2_prey_7": 86, "speed_2_predator_4": 0}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 66.03, "speed_1_prey_0": 73.69, "speed_1_predator_1": 47.18, "speed_1_predator_3": 43.63, "speed_1_prey_4": 52.59, "speed_2_prey_2": 57.69, "speed_1_prey_5": 35.04, "speed_1_prey_2": 66.93, "speed_2_predator_2": 57.81, "speed_2_predator_1": 57.3, "speed_1_prey_7": 41.0, "speed_2_prey_1": 49.57, "speed_2_prey_5": 53.31, "speed_2_prey_3": 68.22, "speed_1_predator_2": 48.1, "speed_1_predator_0": 49.75, "speed_1_predator_4": 34.0, "speed_1_prey_3": 62.64, "speed_1_prey_6": 43.2, "speed_1_prey_8": 22.0, "speed_2_predator_0": 56.0, "speed_2_prey_4": 53.63, "speed_2_predator_3": 56.76, "speed_2_prey_0": 74.62, "speed_2_prey_6": 23.4, "speed_2_predator_5": 83.0, "speed_2_predator_4": 34.0, "speed_2_prey_7": 196.0}, "num_module_steps_sampled": {"speed_2_prey": 3675, "speed_1_prey": 3550, "speed_2_predator": 2358, "speed_1_predator": 2078}, "module_episode_returns_mean": {"speed_2_predator": 0.8, "speed_2_prey": 7.2, "speed_1_prey": 3.2, "speed_1_predator": 0.0}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.214463719198448e-06, "tensor_to_numpy": 0.00014422473028917135, "listify_data_for_vector_env": 5.67955272756064e-05, "un_batch_to_individual_items": 0.00015804577298113287, "get_actions": 0.0005530630165898765, "remove_single_ts_time_rank_from_batch": 1.9351060851476017e-06, "normalize_and_clip_actions": 0.00022949887495958985}}, "connector_pipeline_timer": 0.001225589438109108}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 10, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 130.0, "num_episodes_lifetime": 38, "num_module_steps_sampled_lifetime": {"speed_2_predator": 9622, "speed_2_prey": 14704, "speed_1_prey": 14321, "speed_1_predator": 8486}, "env_step_timer": 0.002581839885117751, "episode_return_min": 0.0, "episode_length": 79.6125140633986, "rlmodule_inference_timer": 0.0032638751165079416, "episode_return_mean": 23.9, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": 4102, "episode_len_max": 231, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 64.9769439185037, "env_to_module_sum_episodes_length_in": 64.9769439185037, "sample": 0.9457614217259367, "episode_len_mean": 101.03, "episode_len_min": 53, "episode_duration_sec_mean": 0.6719683745300381, "time_between_sampling": 22.26090879988875, "num_env_steps_sampled_lifetime_throughput": 45.709284383865175}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.1781922043828672e-08, "policy_loss": 0.06471585482358932, "entropy": 2.114064931869507, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.22500000894069672, "weights_seq_no": 4.0, "total_loss": 0.06658432632684708, "gradients_default_optimizer_global_norm": 0.060035161674022675, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.1781922043828672e-08, "num_module_steps_trained_lifetime": 454144, "mean_kl_loss": 0.004152114503085613, "vf_explained_var": 0.9778841733932495, "num_module_steps_trained": 113664, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16685144956683345, "add_states_from_episodes_to_batch": 8.24934458227156e-06, "general_advantage_estimation": 0.1539801917199239, "add_columns_from_episodes_to_train_batch": 0.09666694082413838, "add_one_ts_to_episodes_and_truncate": 0.03742218005074361, "add_observations_from_episodes_to_batch": 0.0015737746144443747, "add_time_dim_to_batch_and_zero_pad": 2.5266608736135353e-05, "agent_to_module_mapping": 0.006359950208171687, "numpy_to_tensor": 0.007662633797844859}}, "connector_pipeline_timer": 0.47084078566085596}, "learner_connector_sum_episodes_length_out": 1024.0011840599998, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 1816576, "learner_connector_sum_episodes_length_in": 1024.0011840599998, "num_module_steps_trained": 454656, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 3638454, "num_env_steps_trained": 911088, "num_env_steps_trained_lifetime_throughput": 40589.91341357377}, "speed_2_predator": {"num_module_steps_trained_lifetime": 454144, "mean_kl_loss": 0.016263553872704506, "vf_explained_var": 3.820657730102539e-05, "num_module_steps_trained": 113664, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.4538422226905823, "policy_loss": 0.0969775840640068, "entropy": 3.1173388957977295, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 4.0, "total_loss": 0.18559704720973969, "gradients_default_optimizer_global_norm": 0.0968693196773529, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.08130086213350296}, "speed_2_prey": {"vf_explained_var": -1.621246337890625e-05, "policy_loss": 0.030254459008574486, "entropy": 3.1033413410186768, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 4.0, "total_loss": 0.7680476903915405, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.2441641092300415, "diff_num_grad_updates_vs_sampler_policy": 1.0080645084381104, "vf_loss": 0.725806474685669, "num_module_steps_trained": 113664, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 454144, "mean_kl_loss": 0.01775810495018959, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 11.195777893066406}, "speed_1_prey": {"policy_loss": 0.013397864066064358, "entropy": 2.1129841804504395, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 4.0, "total_loss": 0.3373878300189972, "gradients_default_optimizer_global_norm": 0.3380802273750305, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.31746038794517517, "num_module_steps_trained_lifetime": 454144, "vf_explained_var": -0.00012612342834472656, "num_module_steps_trained": 113664, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.014510126784443855, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.0936970710754395}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4102, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 45.709284383865175, "done": false, "training_iteration": 4, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-17-35", "timestamp": 1745893055, "time_this_iter_s": 23.095169067382812, "time_total_s": 91.15284657478333, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0825620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.15284657478333, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.49032258064516, "ram_util_percent": 41.441935483870985, "gpu_util_percent0": 0.3561290322580646, "vram_util_percent0": 0.16041571457837586}, "timing/iter_minutes": 0.38570274114608766, "timing/avg_minutes_per_iter": 0.4107390274604162, "timing/total_hours_elapsed": 0.027382601830694412}
{"timers": {"training_iteration": 23.090437839871804, "restore_env_runners": 1.2420756944620136e-05, "training_step": 23.09029704097526, "env_runner_sampling_timer": 1.1092589944943883, "learner_update_timer": 21.971008152389643, "synch_weights": 0.007535327772365572, "synch_env_connectors": 0.0023127416901291627}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 3266, "speed_1_prey_5": 2261, "speed_1_prey_2": 3103, "speed_1_predator_0": 2708, "speed_2_predator_2": 2901, "speed_1_prey_7": 42, "speed_2_prey_5": 2565, "speed_1_prey_3": 2877, "speed_1_prey_6": 128, "speed_2_prey_3": 2982, "speed_1_predator_2": 2499, "speed_2_prey_0": 3646, "speed_1_predator_4": 102, "speed_1_prey_8": 23, "speed_2_predator_0": 2929, "speed_2_prey_4": 2737, "speed_2_predator_3": 3157, "speed_1_prey_9": 2, "speed_1_prey_1": 2897, "speed_1_prey_0": 3177, "speed_1_predator_1": 2684, "speed_1_predator_3": 2519, "speed_2_predator_1": 2773, "speed_2_prey_1": 2542, "speed_1_prey_4": 2839, "speed_2_prey_6": 123, "speed_2_predator_4": 118, "speed_2_predator_5": 83, "speed_2_prey_7": 197}, "agent_episode_returns_mean": {"speed_1_prey_2": 0.0, "speed_1_prey_1": 1.7, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.4, "speed_1_prey_7": 0.0, "speed_2_prey_1": 2.4, "speed_1_prey_4": 0.4, "speed_1_prey_5": 0.1, "speed_1_predator_0": 0.4, "speed_2_predator_2": 0.4, "speed_2_prey_5": 0.8, "speed_1_prey_3": 2.9, "speed_1_prey_6": 0.0, "speed_2_prey_3": 1.3, "speed_1_predator_2": 0.0, "speed_2_prey_0": 3.7, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 2.0, "speed_2_predator_0": 0.8, "speed_1_predator_3": 0.4, "speed_2_prey_4": 1.6, "speed_2_predator_3": 2.4, "speed_2_prey_2": 3.3, "speed_2_prey_6": 0.0, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 40.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.11739566074318e-05, "add_states_from_episodes_to_batch": 7.124804444190034e-06, "add_observations_from_episodes_to_batch": 9.710350969639873e-05, "add_time_dim_to_batch_and_zero_pad": 1.2898131838991256e-05, "agent_to_module_mapping": 1.020793459805e-05, "numpy_to_tensor": 7.930124105981967e-05}}, "connector_pipeline_timer": 0.00031251297698029097}, "num_agent_steps_sampled": {"speed_1_prey_9": 0, "speed_1_prey_1": 461, "speed_1_prey_0": 566, "speed_1_predator_1": 460, "speed_1_predator_3": 524, "speed_2_predator_1": 537, "speed_2_prey_1": 494, "speed_1_prey_4": 645, "speed_2_prey_2": 662, "speed_1_prey_5": 450, "speed_1_prey_2": 473, "speed_1_predator_0": 541, "speed_2_predator_2": 516, "speed_1_prey_7": 0, "speed_2_prey_5": 535, "speed_1_prey_3": 394, "speed_1_prey_6": 39, "speed_2_prey_3": 523, "speed_1_predator_2": 467, "speed_1_predator_4": 34, "speed_1_prey_8": 0, "speed_2_predator_0": 649, "speed_2_prey_4": 371, "speed_2_predator_3": 587, "speed_2_prey_0": 760, "speed_2_prey_6": 9, "speed_2_predator_5": 0, "speed_2_prey_7": 0, "speed_2_predator_4": 50}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 55.93, "speed_1_prey_0": 73.47, "speed_1_predator_1": 50.05, "speed_1_predator_3": 47.68, "speed_1_prey_4": 60.85, "speed_2_prey_2": 62.27, "speed_1_prey_5": 36.6, "speed_1_prey_2": 63.67, "speed_2_predator_2": 50.84, "speed_2_predator_1": 51.95, "speed_1_prey_7": 41.0, "speed_2_prey_1": 49.62, "speed_2_prey_5": 57.53, "speed_2_prey_3": 63.82, "speed_1_predator_2": 48.08, "speed_1_predator_0": 51.87, "speed_1_predator_4": 33.857142857142854, "speed_1_prey_3": 58.04, "speed_1_prey_6": 43.285714285714285, "speed_1_prey_8": 22.0, "speed_2_predator_0": 60.1, "speed_2_prey_4": 57.12, "speed_2_predator_3": 65.41, "speed_2_prey_0": 78.78, "speed_2_prey_6": 28.5, "speed_2_predator_5": 83.0, "speed_2_predator_4": 36.285714285714285, "speed_2_prey_7": 196.0}, "num_module_steps_sampled": {"speed_2_prey": 3354, "speed_1_prey": 3028, "speed_2_predator": 2339, "speed_1_predator": 2026}, "module_episode_returns_mean": {"speed_2_predator": 1.6, "speed_2_prey": 7.8, "speed_1_prey": 3.0, "speed_1_predator": 0.4}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.1594825790807e-06, "tensor_to_numpy": 0.00014184062262163327, "listify_data_for_vector_env": 5.6139261414366295e-05, "un_batch_to_individual_items": 0.00015617344114615204, "get_actions": 0.0005474254986977369, "remove_single_ts_time_rank_from_batch": 1.9234000712714817e-06, "normalize_and_clip_actions": 0.0002256535292901469}}, "connector_pipeline_timer": 0.001210475258365041}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 10, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 130.0, "num_episodes_lifetime": 48, "num_module_steps_sampled_lifetime": {"speed_2_predator": 11961, "speed_2_prey": 18058, "speed_1_prey": 17349, "speed_1_predator": 10512}, "env_step_timer": 0.0025622724395630075, "episode_return_min": 0.0, "episode_length": 79.68234669379089, "rlmodule_inference_timer": 0.003225673327672737, "episode_return_mean": 25.9, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": 5128, "episode_len_max": 231, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 65.87734589666074, "env_to_module_sum_episodes_length_in": 65.87734589666074, "sample": 0.9456742844203917, "episode_len_mean": 103.69, "episode_len_min": 53, "episode_duration_sec_mean": 0.6785429774699742, "time_between_sampling": 22.259639931398173, "num_env_steps_sampled_lifetime_throughput": 50.464845902991705}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 0.6758414506912231, "policy_loss": 0.032588452100753784, "entropy": 2.097628116607666, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.22500000894069672, "weights_seq_no": 5.0, "total_loss": 0.11612985283136368, "gradients_default_optimizer_global_norm": 0.09264873713254929, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.07936513423919678, "num_module_steps_trained_lifetime": 557952, "mean_kl_loss": 0.01856110617518425, "vf_explained_var": -7.271766662597656e-05, "num_module_steps_trained": 103808, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16683666528473634, "add_states_from_episodes_to_batch": 8.248929949938596e-06, "general_advantage_estimation": 0.1539340805134923, "add_columns_from_episodes_to_train_batch": 0.0966622516778653, "add_one_ts_to_episodes_and_truncate": 0.03741330699274363, "add_observations_from_episodes_to_batch": 0.001573599465448917, "add_time_dim_to_batch_and_zero_pad": 2.5265590869276002e-05, "agent_to_module_mapping": 0.0063594527240457945, "numpy_to_tensor": 0.007662179295222421}}, "connector_pipeline_timer": 0.47076514233338046}, "learner_connector_sum_episodes_length_out": 1024.0019602991997, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 2231808, "learner_connector_sum_episodes_length_in": 1024.0019602991997, "num_module_steps_trained": 415232, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 4470540, "num_env_steps_trained": 832086, "num_env_steps_trained_lifetime_throughput": 40926.852501240755}, "speed_2_predator": {"num_module_steps_trained_lifetime": 557952, "mean_kl_loss": 0.019176414236426353, "vf_explained_var": -3.814697265625e-06, "num_module_steps_trained": 103808, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 3.7101991176605225, "policy_loss": -0.11071319878101349, "entropy": 3.1112818717956543, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 5.0, "total_loss": 0.44909727573394775, "gradients_default_optimizer_global_norm": 0.12670262157917023, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.5511810779571533}, "speed_2_prey": {"vf_explained_var": 8.940696716308594e-07, "policy_loss": -0.15569056570529938, "entropy": 3.0749382972717285, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 5.0, "total_loss": 1.0376225709915161, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.3038880527019501, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.1811023950576782, "num_module_steps_trained": 103808, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 557952, "mean_kl_loss": 0.018090136349201202, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 12.786214828491211}, "speed_1_prey": {"policy_loss": -0.0038877022452652454, "entropy": 2.071758508682251, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 5.0, "total_loss": 0.6348574757575989, "gradients_default_optimizer_global_norm": 0.2032085806131363, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.6299212574958801, "num_module_steps_trained_lifetime": 557952, "vf_explained_var": 3.343820571899414e-05, "num_module_steps_trained": 103808, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.01960870809853077, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.8147621154785156}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5128, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 50.464845902991705, "done": false, "training_iteration": 5, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-17-55", "timestamp": 1745893075, "time_this_iter_s": 20.283182382583618, "time_total_s": 111.43602895736694, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0825e40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.43602895736694, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 9.564285714285715, "ram_util_percent": 40.87500000000001, "gpu_util_percent0": 0.36500000000000005, "vram_util_percent0": 0.15971398329727587}, "timing/iter_minutes": 0.33885023593902586, "timing/avg_minutes_per_iter": 0.3963612691561381, "timing/total_hours_elapsed": 0.033030105763011505}
{"timers": {"training_iteration": 23.075708457443085, "restore_env_runners": 1.242883937677602e-05, "training_step": 23.07556602755551, "env_runner_sampling_timer": 1.1097265531294414, "learner_update_timer": 21.955813881845746, "synch_weights": 0.007524084314642256, "synch_env_connectors": 0.0023116626732289113}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 3800, "speed_1_prey_5": 2666, "speed_1_prey_2": 3616, "speed_1_predator_0": 3171, "speed_2_predator_2": 3552, "speed_1_prey_7": 42, "speed_2_prey_5": 2945, "speed_1_prey_3": 3452, "speed_1_prey_6": 155, "speed_2_prey_3": 3648, "speed_1_predator_2": 2912, "speed_2_prey_0": 4341, "speed_1_predator_4": 136, "speed_1_prey_8": 23, "speed_2_predator_0": 3438, "speed_2_prey_4": 3389, "speed_2_predator_3": 3574, "speed_1_prey_9": 2, "speed_1_prey_1": 3352, "speed_1_prey_0": 3916, "speed_1_predator_1": 3093, "speed_1_predator_3": 2938, "speed_2_predator_1": 3403, "speed_2_prey_1": 2990, "speed_1_prey_4": 3325, "speed_2_prey_6": 131, "speed_2_predator_4": 118, "speed_2_predator_5": 83, "speed_2_prey_7": 197}, "agent_episode_returns_mean": {"speed_1_prey_2": 0.0, "speed_1_prey_1": 1.3, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.1, "speed_1_prey_7": 0.0, "speed_2_prey_1": 2.0, "speed_1_prey_4": 1.6, "speed_1_prey_5": 0.8, "speed_1_predator_0": 0.8, "speed_2_predator_2": 0.4, "speed_2_prey_5": 0.8, "speed_1_prey_3": 2.3, "speed_1_prey_6": 0.0, "speed_2_prey_3": 1.7, "speed_1_predator_2": 0.0, "speed_2_prey_0": 4.0, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 3.2, "speed_2_predator_0": 0.8, "speed_1_predator_3": 0.4, "speed_2_prey_4": 1.0, "speed_2_predator_3": 2.0, "speed_2_prey_2": 4.1, "speed_2_prey_6": 0.0, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 40.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.111850767709098e-05, "add_states_from_episodes_to_batch": 7.141937194981514e-06, "add_observations_from_episodes_to_batch": 9.707375739644085e-05, "add_time_dim_to_batch_and_zero_pad": 1.2944019683712539e-05, "agent_to_module_mapping": 1.0202899977715722e-05, "numpy_to_tensor": 7.97076817816253e-05}}, "connector_pipeline_timer": 0.0003128780235885526}, "num_agent_steps_sampled": {"speed_1_prey_9": 0, "speed_1_prey_1": 455, "speed_1_prey_0": 739, "speed_1_predator_1": 409, "speed_1_predator_3": 419, "speed_2_predator_1": 630, "speed_2_prey_1": 448, "speed_1_prey_4": 486, "speed_2_prey_2": 534, "speed_1_prey_5": 405, "speed_1_prey_2": 513, "speed_1_predator_0": 463, "speed_2_predator_2": 651, "speed_1_prey_7": 0, "speed_2_prey_5": 380, "speed_1_prey_3": 575, "speed_1_prey_6": 27, "speed_2_prey_3": 666, "speed_1_predator_2": 413, "speed_1_predator_4": 34, "speed_1_prey_8": 0, "speed_2_predator_0": 509, "speed_2_prey_4": 652, "speed_2_predator_3": 417, "speed_2_prey_0": 695, "speed_2_prey_6": 8, "speed_2_predator_5": 0, "speed_2_prey_7": 0, "speed_2_predator_4": 0}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 47.39, "speed_1_prey_0": 77.87, "speed_1_predator_1": 52.98, "speed_1_predator_3": 50.51, "speed_1_prey_4": 65.7, "speed_2_prey_2": 63.06, "speed_1_prey_5": 38.12, "speed_1_prey_2": 63.74, "speed_2_predator_2": 60.92, "speed_2_predator_1": 51.34, "speed_1_prey_7": 41.0, "speed_2_prey_1": 51.37, "speed_2_prey_5": 59.67, "speed_2_prey_3": 59.04, "speed_1_predator_2": 45.52, "speed_1_predator_0": 51.86, "speed_1_predator_4": 33.81818181818182, "speed_1_prey_3": 53.12, "speed_1_prey_6": 41.36363636363637, "speed_1_prey_8": 22.0, "speed_2_predator_0": 61.92, "speed_2_prey_4": 65.39, "speed_2_predator_3": 69.62, "speed_2_prey_0": 73.4, "speed_2_prey_6": 27.23076923076923, "speed_2_predator_5": 83.0, "speed_2_predator_4": 37.2, "speed_2_prey_7": 196.0}, "num_module_steps_sampled": {"speed_2_prey": 3383, "speed_1_prey": 3200, "speed_2_predator": 2207, "speed_1_predator": 1738}, "module_episode_returns_mean": {"speed_2_predator": 2.0, "speed_2_prey": 8.1, "speed_1_prey": 2.5, "speed_1_predator": 0.4}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.138291139937481e-06, "tensor_to_numpy": 0.00014002633758303639, "listify_data_for_vector_env": 5.5622185137094935e-05, "un_batch_to_individual_items": 0.00015483183810663227, "get_actions": 0.0005446099281053052, "remove_single_ts_time_rank_from_batch": 1.92364630339132e-06, "normalize_and_clip_actions": 0.00022236168189706116}}, "connector_pipeline_timer": 0.0012003312293626875}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 10, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 130.0, "num_episodes_lifetime": 58, "num_module_steps_sampled_lifetime": {"speed_2_predator": 14168, "speed_2_prey": 21441, "speed_1_prey": 20549, "speed_1_predator": 12250}, "env_step_timer": 0.0025497286979698397, "episode_return_min": 0.0, "episode_length": 79.7694699864611, "rlmodule_inference_timer": 0.0031999648747414976, "episode_return_mean": 28.6, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": 6154, "episode_len_max": 231, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 67.17750702625031, "env_to_module_sum_episodes_length_in": 67.17750702625031, "sample": 0.9456096049606292, "episode_len_mean": 107.24, "episode_len_min": 58, "episode_duration_sec_mean": 0.7234405926099725, "time_between_sampling": 22.257337221396792, "num_env_steps_sampled_lifetime_throughput": 47.33876288931637}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 6.469065727543466e-09, "policy_loss": 0.053361017256975174, "entropy": 2.087658405303955, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.22500000894069672, "weights_seq_no": 6.0, "total_loss": 0.05571187660098076, "gradients_default_optimizer_global_norm": 0.05451618507504463, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 6.469065727543466e-09, "num_module_steps_trained_lifetime": 662528, "mean_kl_loss": 0.010448235087096691, "vf_explained_var": 0.9908406138420105, "num_module_steps_trained": 104576, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1668105387009245, "add_states_from_episodes_to_batch": 8.248332775818464e-06, "general_advantage_estimation": 0.15388033524611736, "add_columns_from_episodes_to_train_batch": 0.0966558109166353, "add_one_ts_to_episodes_and_truncate": 0.037402300142998585, "add_observations_from_episodes_to_batch": 0.001573398773471915, "add_time_dim_to_batch_and_zero_pad": 2.526406959888998e-05, "agent_to_module_mapping": 0.006358808469381603, "numpy_to_tensor": 0.007661812577372617}}, "connector_pipeline_timer": 0.47066653814498843}, "learner_connector_sum_episodes_length_out": 1024.0029208952096, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 2650112, "learner_connector_sum_episodes_length_in": 1024.0029208952096, "num_module_steps_trained": 418304, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 5308782, "num_env_steps_trained": 838242, "num_env_steps_trained_lifetime_throughput": 38675.82140848864}, "speed_2_predator": {"num_module_steps_trained_lifetime": 662528, "mean_kl_loss": 0.017218736931681633, "vf_explained_var": 0.9887765049934387, "num_module_steps_trained": 104576, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1.0716191489734683e-08, "policy_loss": -0.09389656782150269, "entropy": 3.0768449306488037, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 6.0, "total_loss": -0.08614812791347504, "gradients_default_optimizer_global_norm": 0.15916262567043304, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.0716191489734683e-08}, "speed_2_prey": {"vf_explained_var": 8.463859558105469e-06, "policy_loss": -0.14532622694969177, "entropy": 3.074289083480835, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 6.0, "total_loss": 1.1475995779037476, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.20896801352500916, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.2799999713897705, "num_module_steps_trained": 104576, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 662528, "mean_kl_loss": 0.019149314612150192, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 18.811803817749023}, "speed_1_prey": {"policy_loss": -0.027139758691191673, "entropy": 2.0645577907562256, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 6.0, "total_loss": 0.7218093872070312, "gradients_default_optimizer_global_norm": 0.3026488423347473, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.7377049326896667, "num_module_steps_trained_lifetime": 662528, "vf_explained_var": 3.254413604736328e-05, "num_module_steps_trained": 104576, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.024987226352095604, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 13.754638671875}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6154, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 47.33876288931637, "done": false, "training_iteration": 6, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-18-17", "timestamp": 1745893097, "time_this_iter_s": 21.625281810760498, "time_total_s": 133.06131076812744, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0826d40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 133.06131076812744, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 9.616666666666665, "ram_util_percent": 40.70000000000001, "gpu_util_percent0": 0.3736666666666667, "vram_util_percent0": 0.1596129837702871}, "timing/iter_minutes": 0.36122647921244305, "timing/avg_minutes_per_iter": 0.3905054708321889, "timing/total_hours_elapsed": 0.039050547083218895}
{"timers": {"training_iteration": 23.091805003338653, "restore_env_runners": 1.2452450983237388e-05, "training_step": 23.091660495899955, "env_runner_sampling_timer": 1.109214335738148, "learner_update_timer": 21.97241807049729, "synch_weights": 0.007518987241494883, "synch_env_connectors": 0.0023097483564959755}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 4509, "speed_1_prey_5": 3457, "speed_1_prey_2": 4085, "speed_1_predator_0": 3963, "speed_2_predator_2": 4119, "speed_1_prey_7": 42, "speed_2_prey_5": 3494, "speed_1_prey_3": 3980, "speed_1_prey_6": 155, "speed_2_prey_3": 4213, "speed_1_predator_2": 3440, "speed_2_prey_0": 5122, "speed_1_predator_4": 136, "speed_1_prey_8": 23, "speed_2_predator_0": 3991, "speed_2_prey_4": 3967, "speed_2_predator_3": 4067, "speed_1_prey_9": 2, "speed_1_prey_1": 3910, "speed_1_prey_0": 4532, "speed_1_predator_1": 3580, "speed_1_predator_3": 3414, "speed_2_predator_1": 3981, "speed_2_prey_1": 3716, "speed_1_prey_4": 3933, "speed_2_prey_6": 176, "speed_2_predator_4": 118, "speed_2_predator_5": 83, "speed_2_prey_7": 197}, "agent_episode_returns_mean": {"speed_1_prey_2": 0.8, "speed_1_prey_1": 0.4, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.0, "speed_1_prey_7": 0.0, "speed_2_prey_1": 1.2, "speed_1_prey_4": 1.6, "speed_1_prey_5": 1.3, "speed_1_predator_0": 0.8, "speed_2_predator_2": 0.4, "speed_2_prey_5": 1.0, "speed_1_prey_3": 1.6, "speed_1_prey_6": 0.0, "speed_2_prey_3": 2.0, "speed_1_predator_2": 0.0, "speed_2_prey_0": 4.4, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 3.2, "speed_2_predator_0": 0.4, "speed_1_predator_3": 0.4, "speed_2_prey_4": 1.2, "speed_2_predator_3": 0.8, "speed_2_prey_2": 2.0, "speed_2_prey_6": 0.0, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 40.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.105128698548016e-05, "add_states_from_episodes_to_batch": 7.145079946953828e-06, "add_observations_from_episodes_to_batch": 9.702305323263185e-05, "add_time_dim_to_batch_and_zero_pad": 1.2953318244792194e-05, "agent_to_module_mapping": 1.0201591134894216e-05, "numpy_to_tensor": 7.987672514784415e-05}}, "connector_pipeline_timer": 0.0003128279922696156}, "num_agent_steps_sampled": {"speed_1_prey_9": 0, "speed_1_prey_1": 558, "speed_1_prey_0": 616, "speed_1_predator_1": 487, "speed_1_predator_3": 476, "speed_2_predator_1": 578, "speed_2_prey_1": 726, "speed_1_prey_4": 608, "speed_2_prey_2": 709, "speed_1_prey_5": 791, "speed_1_prey_2": 469, "speed_1_predator_0": 792, "speed_2_predator_2": 567, "speed_1_prey_7": 0, "speed_2_prey_5": 549, "speed_1_prey_3": 528, "speed_1_prey_6": 0, "speed_2_prey_3": 565, "speed_1_predator_2": 528, "speed_1_predator_4": 0, "speed_1_prey_8": 0, "speed_2_predator_0": 553, "speed_2_prey_4": 578, "speed_2_predator_3": 493, "speed_2_prey_0": 781, "speed_2_prey_6": 45, "speed_2_predator_5": 0, "speed_2_prey_7": 0, "speed_2_predator_4": 0}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 51.71, "speed_1_prey_0": 72.09, "speed_1_predator_1": 51.61, "speed_1_predator_3": 48.07, "speed_1_prey_4": 60.19, "speed_2_prey_2": 57.26, "speed_1_prey_5": 46.92, "speed_1_prey_2": 50.14, "speed_2_predator_2": 61.74, "speed_2_predator_1": 59.65, "speed_1_prey_7": 41.0, "speed_2_prey_1": 52.87, "speed_2_prey_5": 50.84, "speed_2_prey_3": 57.9, "speed_1_predator_2": 48.66, "speed_1_predator_0": 54.77, "speed_1_predator_4": 33.800000000000004, "speed_1_prey_3": 48.67, "speed_1_prey_6": 40.46666666666667, "speed_1_prey_8": 22.0, "speed_2_predator_0": 58.5, "speed_2_prey_4": 53.28, "speed_2_predator_3": 54.74, "speed_2_prey_0": 75.96, "speed_2_prey_6": 26.666666666666668, "speed_2_predator_5": 83.0, "speed_2_predator_4": 37.69230769230769, "speed_2_prey_7": 196.0}, "num_module_steps_sampled": {"speed_2_prey": 3953, "speed_1_prey": 3570, "speed_2_predator": 2191, "speed_1_predator": 2283}, "module_episode_returns_mean": {"speed_2_predator": 0.8, "speed_2_prey": 5.2, "speed_1_prey": 2.5, "speed_1_predator": 0.4}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.119308011968578e-06, "tensor_to_numpy": 0.00013816471471897194, "listify_data_for_vector_env": 5.5271548451075747e-05, "un_batch_to_individual_items": 0.00015389332351033297, "get_actions": 0.0005410231184542486, "remove_single_ts_time_rank_from_batch": 1.9242433652883484e-06, "normalize_and_clip_actions": 0.00021955827775782487}}, "connector_pipeline_timer": 0.001190402534539515}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 10, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 60.0, "num_episodes_lifetime": 68, "num_module_steps_sampled_lifetime": {"speed_2_predator": 16359, "speed_2_prey": 25394, "speed_1_prey": 24119, "speed_1_predator": 14533}, "env_step_timer": 0.002545187882066763, "episode_return_min": 0.0, "episode_length": 79.86627721802786, "rlmodule_inference_timer": 0.003173619049399267, "episode_return_mean": 23.5, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": 7180, "episode_len_max": 195, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 68.01505462599157, "env_to_module_sum_episodes_length_in": 68.01505462599157, "sample": 0.9455596124020902, "episode_len_mean": 103.98, "episode_len_min": 53, "episode_duration_sec_mean": 0.7320272185899648, "time_between_sampling": 22.254526837638004, "num_env_steps_sampled_lifetime_throughput": 41.46781135924715}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 6.127542018890381, "policy_loss": -0.026739152148365974, "entropy": 2.067361831665039, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.3375000059604645, "weights_seq_no": 7.0, "total_loss": 0.4728090763092041, "gradients_default_optimizer_global_norm": 0.1561984419822693, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.49180328845977783, "num_module_steps_trained_lifetime": 784512, "mean_kl_loss": 0.03442191332578659, "vf_explained_var": 4.470348358154297e-06, "num_module_steps_trained": 121984, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16678464436386045, "add_states_from_episodes_to_batch": 8.247680152178428e-06, "general_advantage_estimation": 0.15381678286703854, "add_columns_from_episodes_to_train_batch": 0.09664932718146209, "add_one_ts_to_episodes_and_truncate": 0.03738941581664919, "add_observations_from_episodes_to_batch": 0.0015731847871879165, "add_time_dim_to_batch_and_zero_pad": 2.52623277948155e-05, "agent_to_module_mapping": 0.006358134754838289, "numpy_to_tensor": 0.0076611627320502555}}, "connector_pipeline_timer": 0.4705561017119309}, "learner_connector_sum_episodes_length_out": 1024.0040620832694, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 3138048, "learner_connector_sum_episodes_length_in": 1024.0040620832694, "num_module_steps_trained": 487936, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 6286560, "num_env_steps_trained": 977778, "num_env_steps_trained_lifetime_throughput": 39518.882329523054}, "speed_2_predator": {"num_module_steps_trained_lifetime": 784512, "mean_kl_loss": 0.014993448741734028, "vf_explained_var": 0.9897849559783936, "num_module_steps_trained": 121984, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1.3529844800075352e-08, "policy_loss": -0.23536112904548645, "entropy": 3.078984498977661, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 7.0, "total_loss": -0.22861407697200775, "gradients_default_optimizer_global_norm": 0.2215508371591568, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.3529844800075352e-08}, "speed_2_prey": {"vf_explained_var": 3.874301910400391e-06, "policy_loss": -0.22553592920303345, "entropy": 3.0508720874786377, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 7.0, "total_loss": 1.157897710800171, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.20102523267269135, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.3709677457809448, "num_module_steps_trained": 121984, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 784512, "mean_kl_loss": 0.018468070775270462, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 11.801716804504395}, "speed_1_prey": {"policy_loss": -0.08047289401292801, "entropy": 2.0303080081939697, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 7.0, "total_loss": 0.8156810998916626, "gradients_default_optimizer_global_norm": 0.5380188822746277, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.8825098276138306, "num_module_steps_trained_lifetime": 784512, "vf_explained_var": -0.002734065055847168, "num_module_steps_trained": 121984, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.020213603973388672, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 7.015967845916748}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 7180, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 41.46781135924715, "done": false, "training_iteration": 7, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-18-42", "timestamp": 1745893122, "time_this_iter_s": 24.69319772720337, "time_total_s": 157.7545084953308, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0976f20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 157.7545084953308, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 9.141176470588235, "ram_util_percent": 40.79705882352941, "gpu_util_percent0": 0.3573529411764706, "vram_util_percent0": 0.16339071046102854}, "timing/iter_minutes": 0.4123700618743896, "timing/avg_minutes_per_iter": 0.3936289838382176, "timing/total_hours_elapsed": 0.04592338144779205}
{"timers": {"training_iteration": 23.123732175655267, "restore_env_runners": 1.2463866472786676e-05, "training_step": 23.123586458430957, "env_runner_sampling_timer": 1.108605665960769, "learner_update_timer": 22.004956812122316, "synch_weights": 0.007511820859078202, "synch_env_connectors": 0.002309434712930663}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 5135, "speed_1_prey_5": 3964, "speed_1_prey_2": 4521, "speed_1_predator_0": 4478, "speed_2_predator_2": 4520, "speed_1_prey_7": 52, "speed_2_prey_5": 4052, "speed_1_prey_3": 4622, "speed_1_prey_6": 219, "speed_2_prey_3": 4877, "speed_1_predator_2": 3918, "speed_2_prey_0": 5957, "speed_1_predator_4": 195, "speed_1_prey_8": 23, "speed_2_predator_0": 4476, "speed_2_prey_4": 4648, "speed_2_predator_3": 4520, "speed_1_prey_9": 2, "speed_1_prey_1": 4515, "speed_1_prey_0": 5229, "speed_1_predator_1": 3992, "speed_1_predator_3": 3905, "speed_2_predator_1": 4412, "speed_2_prey_1": 4467, "speed_1_prey_4": 4637, "speed_2_prey_6": 351, "speed_2_predator_4": 152, "speed_2_predator_5": 83, "speed_2_prey_7": 197}, "agent_episode_returns_mean": {"speed_1_prey_2": 1.6, "speed_1_prey_1": 0.0, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.0, "speed_1_prey_7": 0.0, "speed_2_prey_1": 0.8, "speed_1_prey_4": 3.4, "speed_1_prey_5": 0.8, "speed_1_predator_0": 1.2, "speed_2_predator_2": 0.1, "speed_2_prey_5": 2.4, "speed_1_prey_3": 2.5, "speed_1_prey_6": 0.0, "speed_2_prey_3": 4.1, "speed_1_predator_2": 0.0, "speed_2_prey_0": 3.5, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 4.6, "speed_2_predator_0": 0.4, "speed_1_predator_3": 0.4, "speed_2_prey_4": 3.6, "speed_2_predator_3": 0.0, "speed_2_prey_2": 2.1, "speed_2_prey_6": 0.0, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 40.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.089309117731898e-05, "add_states_from_episodes_to_batch": 7.149903397047519e-06, "add_observations_from_episodes_to_batch": 9.693501567841516e-05, "add_time_dim_to_batch_and_zero_pad": 1.2935116175725955e-05, "agent_to_module_mapping": 1.0188260354010003e-05, "numpy_to_tensor": 7.986047556350126e-05}}, "connector_pipeline_timer": 0.00031240079084112425}, "num_agent_steps_sampled": {"speed_1_prey_9": 0, "speed_1_prey_1": 605, "speed_1_prey_0": 697, "speed_1_predator_1": 412, "speed_1_predator_3": 491, "speed_2_predator_1": 431, "speed_2_prey_1": 751, "speed_1_prey_4": 704, "speed_2_prey_2": 626, "speed_1_prey_5": 507, "speed_1_prey_2": 436, "speed_1_predator_0": 515, "speed_2_predator_2": 401, "speed_1_prey_7": 10, "speed_2_prey_5": 558, "speed_1_prey_3": 642, "speed_1_prey_6": 64, "speed_2_prey_3": 664, "speed_1_predator_2": 478, "speed_1_predator_4": 59, "speed_1_prey_8": 0, "speed_2_predator_0": 485, "speed_2_prey_4": 681, "speed_2_predator_3": 453, "speed_2_prey_0": 835, "speed_2_prey_6": 175, "speed_2_predator_5": 0, "speed_2_prey_7": 0, "speed_2_predator_4": 34}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 53.83, "speed_1_prey_0": 71.9, "speed_1_predator_1": 44.58, "speed_1_predator_3": 49.03, "speed_1_prey_4": 57.59, "speed_2_prey_2": 71.11, "speed_1_prey_5": 64.14, "speed_1_prey_2": 49.61, "speed_2_predator_2": 50.71, "speed_2_predator_1": 58.09, "speed_1_prey_7": 37.44444444444444, "speed_2_prey_1": 66.6, "speed_2_prey_5": 49.82, "speed_2_prey_3": 60.12, "speed_1_predator_2": 51.78, "speed_1_predator_0": 63.76, "speed_1_predator_4": 33.78947368421052, "speed_1_prey_3": 64.99, "speed_1_prey_6": 40.7, "speed_1_prey_8": 22.0, "speed_2_predator_0": 53.17, "speed_2_prey_4": 63.32, "speed_2_predator_3": 50.96, "speed_2_prey_0": 83.57, "speed_2_prey_6": 27.16, "speed_2_predator_5": 83.0, "speed_2_predator_4": 37.76470588235294, "speed_2_prey_7": 196.0}, "num_module_steps_sampled": {"speed_2_prey": 4290, "speed_1_prey": 3665, "speed_2_predator": 1804, "speed_1_predator": 1955}, "module_episode_returns_mean": {"speed_2_predator": 0.0, "speed_2_prey": 8.1, "speed_1_prey": 2.1, "speed_1_predator": 1.2}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.086278725708585e-06, "tensor_to_numpy": 0.0001362358552430895, "listify_data_for_vector_env": 5.4932266443415124e-05, "un_batch_to_individual_items": 0.00015288578063997487, "get_actions": 0.0005370159675702009, "remove_single_ts_time_rank_from_batch": 1.919354890551729e-06, "normalize_and_clip_actions": 0.00021681001634254573}}, "connector_pipeline_timer": 0.0011799128917002854}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 10, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 100.0, "num_episodes_lifetime": 78, "num_module_steps_sampled_lifetime": {"speed_2_predator": 18163, "speed_2_prey": 29684, "speed_1_prey": 27784, "speed_1_predator": 16488}, "env_step_timer": 0.0025411738852532347, "episode_return_min": 0.0, "episode_length": 79.99507858774643, "rlmodule_inference_timer": 0.003145494469709157, "episode_return_mean": 31.5, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": 8207, "episode_len_max": 234, "num_env_steps_sampled": 1027, "env_to_module_sum_episodes_length_out": 68.8555698297813, "env_to_module_sum_episodes_length_in": 68.8555698297813, "sample": 0.9455148071550495, "episode_len_mean": 108.09, "episode_len_min": 53, "episode_duration_sec_mean": 0.7668578163999882, "time_between_sampling": 22.252450391956838, "num_env_steps_sampled_lifetime_throughput": 38.98777594842062}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.081787347793579, "policy_loss": -0.13312740623950958, "entropy": 2.056137800216675, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.3375000059604645, "weights_seq_no": 8.0, "total_loss": 0.12099349498748779, "gradients_default_optimizer_global_norm": 0.11083156615495682, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.24793387949466705, "num_module_steps_trained_lifetime": 916352, "mean_kl_loss": 0.018331876024603844, "vf_explained_var": -4.398822784423828e-05, "num_module_steps_trained": 131840, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16675815186786755, "add_states_from_episodes_to_batch": 8.247068247722079e-06, "general_advantage_estimation": 0.15374369200571666, "add_columns_from_episodes_to_train_batch": 0.09664243276300068, "add_one_ts_to_episodes_and_truncate": 0.03737464591491249, "add_observations_from_episodes_to_batch": 0.0015729498804522134, "add_time_dim_to_batch_and_zero_pad": 2.5260318519897793e-05, "agent_to_module_mapping": 0.006357376629938903, "numpy_to_tensor": 0.007660310309876566}}, "connector_pipeline_timer": 0.47043291203942}, "learner_connector_sum_episodes_length_out": 1024.0054801554786, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 3665408, "learner_connector_sum_episodes_length_in": 1024.0054801554786, "num_module_steps_trained": 527360, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 7344370, "num_env_steps_trained": 1057810, "num_env_steps_trained_lifetime_throughput": 40157.30025227025}, "speed_2_predator": {"num_module_steps_trained_lifetime": 916352, "mean_kl_loss": 0.01210869662463665, "vf_explained_var": 2.5331974029541016e-05, "num_module_steps_trained": 131840, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.9511654376983643, "policy_loss": -0.3622973561286926, "entropy": 3.05780029296875, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 8.0, "total_loss": 0.04965557903051376, "gradients_default_optimizer_global_norm": 0.07412128895521164, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.4065040647983551}, "speed_2_prey": {"vf_explained_var": -6.9141387939453125e-06, "policy_loss": -0.25256145000457764, "entropy": 3.005394458770752, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 8.0, "total_loss": 1.8273494243621826, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.24448055028915405, "diff_num_grad_updates_vs_sampler_policy": 1.0079364776611328, "vf_loss": 2.0634920597076416, "num_module_steps_trained": 131840, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 916352, "mean_kl_loss": 0.024324242025613785, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 23.464622497558594}, "speed_1_prey": {"policy_loss": -0.2025298923254013, "entropy": 2.0179543495178223, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737, "weights_seq_no": 8.0, "total_loss": 1.916641116142273, "gradients_default_optimizer_global_norm": 0.7507944703102112, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.0967941284179688, "num_module_steps_trained_lifetime": 916352, "vf_explained_var": 0.0005379915237426758, "num_module_steps_trained": 131840, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.02210056409239769, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 21.07655143737793}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8207, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 38.98777594842062, "done": false, "training_iteration": 8, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-19-08", "timestamp": 1745893148, "time_this_iter_s": 26.29183268547058, "time_total_s": 184.0463411808014, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0826ac0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 184.0463411808014, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 9.152777777777779, "ram_util_percent": 40.92777777777779, "gpu_util_percent0": 0.3616666666666667, "vram_util_percent0": 0.16988727858293076}, "timing/iter_minutes": 0.4390216628710429, "timing/avg_minutes_per_iter": 0.39930306871732074, "timing/total_hours_elapsed": 0.05324040916230943}
{"timers": {"training_iteration": 23.157190499198716, "restore_env_runners": 1.2418537810606381e-05, "training_step": 23.15704350355665, "env_runner_sampling_timer": 1.107664717051161, "learner_update_timer": 22.039353286801095, "synch_weights": 0.007504946870488781, "synch_env_connectors": 0.002306997455800433}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 5950, "speed_1_prey_5": 4354, "speed_1_prey_2": 5026, "speed_1_predator_0": 4953, "speed_2_predator_2": 5162, "speed_1_prey_7": 56, "speed_2_prey_5": 4475, "speed_1_prey_3": 5319, "speed_1_prey_6": 278, "speed_2_prey_3": 5779, "speed_1_predator_2": 4319, "speed_2_prey_0": 6768, "speed_1_predator_4": 220, "speed_1_prey_8": 23, "speed_2_predator_0": 5035, "speed_2_prey_4": 5196, "speed_2_predator_3": 5061, "speed_1_prey_9": 2, "speed_1_prey_1": 5157, "speed_1_prey_0": 5929, "speed_1_predator_1": 4478, "speed_1_predator_3": 4416, "speed_2_predator_1": 4952, "speed_2_prey_1": 5177, "speed_1_prey_4": 5277, "speed_2_prey_6": 453, "speed_2_predator_4": 152, "speed_2_predator_5": 83, "speed_2_prey_7": 197}, "agent_episode_returns_mean": {"speed_1_prey_2": 1.6, "speed_1_prey_1": 1.6, "speed_1_predator_1": 0.4, "speed_2_predator_1": 0.0, "speed_1_prey_7": 0.0, "speed_2_prey_1": 0.6, "speed_1_prey_4": 3.0, "speed_1_prey_5": 0.4, "speed_1_predator_0": 0.8, "speed_2_predator_2": 0.0, "speed_2_prey_5": 3.2, "speed_1_prey_3": 2.0, "speed_1_prey_6": 0.0, "speed_2_prey_3": 3.2, "speed_1_predator_2": 0.0, "speed_2_prey_0": 2.4, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 3.1, "speed_2_predator_0": 0.4, "speed_1_predator_3": 0.1, "speed_2_prey_4": 3.6, "speed_2_predator_3": 0.0, "speed_2_prey_2": 2.8, "speed_2_prey_6": 0.4, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 40.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.076084017263884e-05, "add_states_from_episodes_to_batch": 7.148703097928715e-06, "add_observations_from_episodes_to_batch": 9.677816206892663e-05, "add_time_dim_to_batch_and_zero_pad": 1.2911248187142708e-05, "agent_to_module_mapping": 1.0175690346457549e-05, "numpy_to_tensor": 7.985010376506542e-05}}, "connector_pipeline_timer": 0.0003119261131818576}, "num_agent_steps_sampled": {"speed_1_prey_9": 0, "speed_1_prey_1": 642, "speed_1_prey_0": 700, "speed_1_predator_1": 486, "speed_1_predator_3": 511, "speed_2_predator_1": 540, "speed_2_prey_1": 710, "speed_1_prey_4": 640, "speed_2_prey_2": 815, "speed_1_prey_5": 390, "speed_1_prey_2": 505, "speed_1_predator_0": 475, "speed_2_predator_2": 642, "speed_1_prey_7": 4, "speed_2_prey_5": 423, "speed_1_prey_3": 697, "speed_1_prey_6": 59, "speed_2_prey_3": 902, "speed_1_predator_2": 401, "speed_1_predator_4": 25, "speed_1_prey_8": 0, "speed_2_predator_0": 559, "speed_2_prey_4": 548, "speed_2_predator_3": 541, "speed_2_prey_0": 811, "speed_2_prey_6": 102, "speed_2_predator_5": 0, "speed_2_prey_7": 0, "speed_2_predator_4": 0}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 57.15, "speed_1_prey_0": 67.47, "speed_1_predator_1": 44.12, "speed_1_predator_3": 48.45, "speed_1_prey_4": 68.15, "speed_2_prey_2": 70.57, "speed_1_prey_5": 60.77, "speed_1_prey_2": 47.59, "speed_2_predator_2": 49.15, "speed_2_predator_1": 50.92, "speed_1_prey_7": 32.5, "speed_2_prey_1": 71.44, "speed_2_prey_5": 52.18, "speed_2_prey_3": 72.04, "speed_1_predator_2": 47.14, "speed_1_predator_0": 60.87, "speed_1_predator_4": 35.875, "speed_1_prey_3": 62.53, "speed_1_prey_6": 40.88, "speed_1_prey_8": 22.0, "speed_2_predator_0": 53.2, "speed_2_prey_4": 58.12, "speed_2_predator_3": 49.72, "speed_2_prey_0": 79.11, "speed_2_prey_6": 35.04, "speed_2_predator_5": 83.0, "speed_2_predator_4": 37.80952380952381, "speed_2_prey_7": 196.0}, "num_module_steps_sampled": {"speed_2_prey": 4311, "speed_1_prey": 3637, "speed_2_predator": 2282, "speed_1_predator": 1898}, "module_episode_returns_mean": {"speed_2_predator": 0.0, "speed_2_prey": 8.0, "speed_1_prey": 2.9, "speed_1_predator": 1.3}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.05426551223787e-06, "tensor_to_numpy": 0.00013438611684624217, "listify_data_for_vector_env": 5.4607977293903465e-05, "un_batch_to_individual_items": 0.00015187759091677883, "get_actions": 0.0005333965865345154, "remove_single_ts_time_rank_from_batch": 1.9156525158585936e-06, "normalize_and_clip_actions": 0.00021417754400513772}}, "connector_pipeline_timer": 0.0011700309870984532}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 8, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 100.0, "num_episodes_lifetime": 86, "num_module_steps_sampled_lifetime": {"speed_2_predator": 20445, "speed_2_prey": 33995, "speed_1_prey": 31421, "speed_1_predator": 18386}, "env_step_timer": 0.0025370816862670354, "episode_return_min": 0.0, "episode_length": 80.12515377412255, "rlmodule_inference_timer": 0.0031204635751165546, "episode_return_mean": 29.6, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": 9234, "episode_len_max": 234, "num_env_steps_sampled": 1027, "env_to_module_sum_episodes_length_out": 69.74789872428772, "env_to_module_sum_episodes_length_in": 69.74789872428772, "sample": 0.9454784308405956, "episode_len_mean": 102.92, "episode_len_min": 53, "episode_duration_sec_mean": 0.7366129334600237, "time_between_sampling": 22.25171191853806, "num_env_steps_sampled_lifetime_throughput": 38.71459424943433}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 3.8071124031091585e-09, "policy_loss": -0.28449276089668274, "entropy": 2.0392515659332275, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.5062500238418579, "weights_seq_no": 9.0, "total_loss": -0.27633845806121826, "gradients_default_optimizer_global_norm": 0.27276962995529175, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 3.8071124031091585e-09, "num_module_steps_trained_lifetime": 1048704, "mean_kl_loss": 0.024160880595445633, "vf_explained_var": 0.9977225661277771, "num_module_steps_trained": 132352, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1667311886004581, "add_states_from_episodes_to_batch": 8.246276913329137e-06, "general_advantage_estimation": 0.15366216177543454, "add_columns_from_episodes_to_train_batch": 0.09663512431489034, "add_one_ts_to_episodes_and_truncate": 0.03735788424192888, "add_observations_from_episodes_to_batch": 0.0015726808407725103, "add_time_dim_to_batch_and_zero_pad": 2.52581140977098e-05, "agent_to_module_mapping": 0.006356534259462019, "numpy_to_tensor": 0.007659178414773152}}, "connector_pipeline_timer": 0.4702979974647882}, "learner_connector_sum_episodes_length_out": 1024.0071694600351, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 4194816, "learner_connector_sum_episodes_length_in": 1024.0071694600351, "num_module_steps_trained": 529408, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 8406288, "num_env_steps_trained": 1061918, "num_env_steps_trained_lifetime_throughput": 40030.97355064798}, "speed_2_predator": {"num_module_steps_trained_lifetime": 1048704, "mean_kl_loss": 0.017486395314335823, "vf_explained_var": 0.9973198771476746, "num_module_steps_trained": 132352, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 3.527108161094361e-09, "policy_loss": -0.20792928338050842, "entropy": 3.032463312149048, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.45000001788139343, "weights_seq_no": 9.0, "total_loss": -0.2000603973865509, "gradients_default_optimizer_global_norm": 0.1532309204339981, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 3.527108161094361e-09}, "speed_2_prey": {"vf_explained_var": -3.2186508178710938e-06, "policy_loss": -0.2847840487957001, "entropy": 3.010712146759033, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 9.0, "total_loss": 2.474949598312378, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.426622599363327, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.7419354915618896, "num_module_steps_trained": 132352, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 1048704, "mean_kl_loss": 0.017578566446900368, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 28.660400390625}, "speed_1_prey": {"policy_loss": -0.15837277472019196, "entropy": 2.0006327629089355, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737, "weights_seq_no": 9.0, "total_loss": 1.717605710029602, "gradients_default_optimizer_global_norm": 0.7322285771369934, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.8548502922058105, "num_module_steps_trained_lifetime": 1048704, "vf_explained_var": 6.467103958129883e-05, "num_module_steps_trained": 132352, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.013911711983382702, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 13.09178352355957}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 9234, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 38.71459424943433, "done": false, "training_iteration": 9, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-19-35", "timestamp": 1745893175, "time_this_iter_s": 26.476957321166992, "time_total_s": 210.52329850196838, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0827740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 210.52329850196838, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 9.197297297297297, "ram_util_percent": 40.79459459459459, "gpu_util_percent0": 0.38243243243243247, "vram_util_percent0": 0.17024914509037617}, "timing/iter_minutes": 0.44212422768274945, "timing/avg_minutes_per_iter": 0.40406097526903506, "timing/total_hours_elapsed": 0.060609146290355256}
{"timers": {"training_iteration": 23.23078103410673, "restore_env_runners": 1.2375982433250328e-05, "training_step": 23.23063283231108, "env_runner_sampling_timer": 1.1087623197006495, "learner_update_timer": 22.111826873923082, "synch_weights": 0.0075115093017839914, "synch_env_connectors": 0.0023051525812417843}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 6770, "speed_1_prey_5": 4800, "speed_1_prey_2": 5758, "speed_1_predator_0": 5335, "speed_2_predator_2": 5644, "speed_1_prey_7": 95, "speed_2_prey_5": 5205, "speed_1_prey_3": 6082, "speed_1_prey_6": 492, "speed_2_prey_3": 6636, "speed_1_predator_2": 4749, "speed_2_prey_0": 7485, "speed_1_predator_4": 220, "speed_1_prey_8": 41, "speed_2_predator_0": 5722, "speed_2_prey_4": 5918, "speed_2_predator_3": 5604, "speed_1_prey_9": 17, "speed_1_prey_1": 5914, "speed_1_prey_0": 6822, "speed_1_predator_1": 4951, "speed_1_predator_3": 4902, "speed_2_predator_1": 5549, "speed_2_prey_1": 5794, "speed_1_prey_4": 5874, "speed_2_prey_6": 654, "speed_2_predator_4": 152, "speed_2_predator_5": 83, "speed_2_prey_7": 293, "speed_1_prey_11": 2, "speed_2_prey_8": 18, "speed_1_prey_10": 4}, "agent_episode_returns_mean": {"speed_1_prey_2": 1.5, "speed_1_prey_1": 2.8, "speed_1_predator_1": 0.4, "speed_2_predator_1": 0.4, "speed_1_prey_7": 0.0, "speed_2_prey_1": 3.2, "speed_1_prey_4": 2.8, "speed_1_prey_5": 0.4, "speed_1_predator_0": 0.2, "speed_2_predator_2": 0.0, "speed_2_prey_5": 2.9, "speed_1_prey_3": 2.6, "speed_1_prey_6": 0.0, "speed_2_prey_3": 4.1, "speed_1_predator_2": 0.0, "speed_2_prey_0": 4.3, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 4.8, "speed_2_predator_0": 0.4, "speed_1_predator_3": 0.0, "speed_2_prey_4": 4.6, "speed_2_predator_3": 0.0, "speed_2_prey_2": 5.1, "speed_2_prey_6": 0.8, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 28.0, "speed_2_prey_8": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.068730194686468e-05, "add_states_from_episodes_to_batch": 7.14523326135718e-06, "add_observations_from_episodes_to_batch": 9.680272537382947e-05, "add_time_dim_to_batch_and_zero_pad": 1.2887094846526245e-05, "agent_to_module_mapping": 1.0177973939010782e-05, "numpy_to_tensor": 7.978212856756387e-05}}, "connector_pipeline_timer": 0.00031162843748094756}, "num_agent_steps_sampled": {"speed_1_prey_9": 15, "speed_1_prey_1": 757, "speed_1_prey_0": 893, "speed_1_predator_1": 473, "speed_1_predator_3": 486, "speed_2_predator_1": 597, "speed_2_prey_1": 617, "speed_1_prey_4": 597, "speed_2_prey_2": 820, "speed_1_prey_5": 446, "speed_1_prey_2": 732, "speed_1_predator_0": 382, "speed_2_predator_2": 482, "speed_1_prey_7": 39, "speed_2_prey_5": 730, "speed_1_prey_3": 763, "speed_1_prey_6": 214, "speed_2_prey_3": 857, "speed_1_predator_2": 430, "speed_1_predator_4": 0, "speed_1_prey_8": 18, "speed_2_predator_0": 687, "speed_2_prey_4": 722, "speed_2_predator_3": 543, "speed_2_prey_0": 717, "speed_2_prey_6": 201, "speed_2_predator_5": 0, "speed_2_prey_7": 96, "speed_2_predator_4": 0, "speed_2_prey_8": 18, "speed_1_prey_10": 4, "speed_1_prey_11": 2}, "agent_steps": {"speed_1_prey_9": 1.0, "speed_1_prey_1": 61.58, "speed_1_prey_0": 74.39, "speed_1_predator_1": 46.01, "speed_1_predator_3": 53.27, "speed_1_prey_4": 64.51, "speed_2_prey_2": 77.75, "speed_1_prey_5": 46.38, "speed_1_prey_2": 53.76, "speed_2_predator_2": 54.22, "speed_2_predator_1": 55.63, "speed_1_prey_7": 29.533333333333335, "speed_2_prey_1": 74.47, "speed_2_prey_5": 59.64, "speed_2_prey_3": 82.29, "speed_1_predator_2": 44.45, "speed_1_predator_0": 47.61, "speed_1_predator_4": 37.76, "speed_1_prey_3": 68.12, "speed_1_prey_6": 39.4, "speed_1_prey_8": 22.0, "speed_2_predator_0": 55.03, "speed_2_prey_4": 63.91, "speed_2_predator_3": 50.41, "speed_2_prey_0": 84.19, "speed_2_prey_6": 44.25, "speed_2_predator_5": 83.0, "speed_2_predator_4": 37.84, "speed_2_prey_7": 146.5, "speed_2_prey_8": 17.0}, "num_module_steps_sampled": {"speed_2_prey": 4778, "speed_1_prey": 4480, "speed_2_predator": 2309, "speed_1_predator": 1771}, "module_episode_returns_mean": {"speed_2_predator": 0.4, "speed_2_prey": 12.3, "speed_1_prey": 5.8, "speed_1_predator": 0.6}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.033414427825139e-06, "tensor_to_numpy": 0.00013256709865678334, "listify_data_for_vector_env": 5.446181040124037e-05, "un_batch_to_individual_items": 0.0001512918024910301, "get_actions": 0.0005296206782254381, "remove_single_ts_time_rank_from_batch": 1.910639045110016e-06, "normalize_and_clip_actions": 0.00021211660336416902}}, "connector_pipeline_timer": 0.001161228305542531}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 10, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 160.0, "num_episodes_lifetime": 96, "num_module_steps_sampled_lifetime": {"speed_2_predator": 22754, "speed_2_prey": 38773, "speed_1_prey": 35901, "speed_1_predator": 20157}, "env_step_timer": 0.0025413051077963268, "episode_return_min": 0.0, "episode_length": 80.27295310411094, "rlmodule_inference_timer": 0.003095807358990429, "episode_return_mean": 40.9, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": 10260, "episode_len_max": 245, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 70.49393978466765, "env_to_module_sum_episodes_length_in": 70.49393978466765, "sample": 0.945468638553601, "episode_len_mean": 102.95, "episode_len_min": 53, "episode_duration_sec_mean": 0.7399561928400317, "time_between_sampling": 22.25231550310888, "num_env_steps_sampled_lifetime_throughput": 33.55734345750491}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 6.831676557794708e-09, "policy_loss": -0.20530857145786285, "entropy": 2.005979537963867, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.5062500238418579, "weights_seq_no": 10.0, "total_loss": -0.1952226161956787, "gradients_default_optimizer_global_norm": 0.30904021859169006, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 6.831676557794708e-09, "num_module_steps_trained_lifetime": 1195392, "mean_kl_loss": 0.019922861829400063, "vf_explained_var": 0.998284637928009, "num_module_steps_trained": 146688, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16669527725981004, "add_states_from_episodes_to_batch": 8.245311798767633e-06, "general_advantage_estimation": 0.15357397381565752, "add_columns_from_episodes_to_train_batch": 0.09662846380486595, "add_one_ts_to_episodes_and_truncate": 0.037339613639513464, "add_observations_from_episodes_to_batch": 0.0015724140432983597, "add_time_dim_to_batch_and_zero_pad": 2.5255098932129644e-05, "agent_to_module_mapping": 0.006355714590631692, "numpy_to_tensor": 0.007658047911940818}}, "connector_pipeline_timer": 0.47014662906464505}, "learner_connector_sum_episodes_length_out": 1024.0090244304852, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 4781568, "learner_connector_sum_episodes_length_in": 1024.0090244304852, "num_module_steps_trained": 586752, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 9582084, "num_env_steps_trained": 1175796, "num_env_steps_trained_lifetime_throughput": 38456.73785661027}, "speed_2_predator": {"num_module_steps_trained_lifetime": 1195392, "mean_kl_loss": 0.021762458607554436, "vf_explained_var": -9.298324584960938e-06, "num_module_steps_trained": 146688, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 3.4998843669891357, "policy_loss": -0.1803780198097229, "entropy": 3.041452646255493, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 10.0, "total_loss": 0.4694150686264038, "gradients_default_optimizer_global_norm": 0.39953938126564026, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.6399999856948853}, "speed_2_prey": {"vf_explained_var": 3.814697265625e-06, "policy_loss": -0.21339751780033112, "entropy": 2.9862606525421143, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 10.0, "total_loss": 1.4416874647140503, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.45461755990982056, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.6393442153930664, "num_module_steps_trained": 146688, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 1195392, "mean_kl_loss": 0.015546254813671112, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 36.06367492675781}, "speed_1_prey": {"policy_loss": -0.13676054775714874, "entropy": 1.9695165157318115, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737, "weights_seq_no": 10.0, "total_loss": 1.8212792873382568, "gradients_default_optimizer_global_norm": 0.7226726412773132, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.9317954778671265, "num_module_steps_trained_lifetime": 1195392, "vf_explained_var": -0.0037828683853149414, "num_module_steps_trained": 146688, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.017280282452702522, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 28.981393814086914}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10260, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 33.55734345750491, "done": false, "training_iteration": 10, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-20-05", "timestamp": 1745893205, "time_this_iter_s": 30.52553391456604, "time_total_s": 241.04883241653442, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0859a80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 241.04883241653442, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 8.747619047619045, "ram_util_percent": 41.08333333333333, "gpu_util_percent0": 0.3273809523809524, "vram_util_percent0": 0.190284271989206}, "timing/iter_minutes": 0.5095971584320068, "timing/avg_minutes_per_iter": 0.41461459358533226, "timing/total_hours_elapsed": 0.06910243226422204}
{"timers": {"training_iteration": 23.31653070888566, "restore_env_runners": 1.2360202608401912e-05, "training_step": 23.316381202267966, "env_runner_sampling_timer": 1.109365124463645, "learner_update_timer": 22.19697295670385, "synch_weights": 0.007506280038764536, "synch_env_connectors": 0.0023094861054318884}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 7519, "speed_1_prey_5": 5299, "speed_1_prey_2": 6400, "speed_1_predator_0": 5734, "speed_2_predator_2": 6085, "speed_1_prey_7": 253, "speed_2_prey_5": 5776, "speed_1_prey_3": 6924, "speed_1_prey_6": 690, "speed_2_prey_3": 7256, "speed_1_predator_2": 5189, "speed_2_prey_0": 8287, "speed_1_predator_4": 220, "speed_1_prey_8": 161, "speed_2_predator_0": 6276, "speed_2_prey_4": 6789, "speed_2_predator_3": 6175, "speed_1_prey_9": 116, "speed_1_prey_1": 6621, "speed_1_prey_0": 7613, "speed_1_predator_1": 5319, "speed_1_predator_3": 5265, "speed_2_predator_1": 5924, "speed_2_prey_1": 6505, "speed_1_prey_4": 6459, "speed_2_prey_6": 699, "speed_2_predator_4": 152, "speed_2_predator_5": 83, "speed_2_prey_7": 310, "speed_1_prey_11": 67, "speed_2_prey_8": 24, "speed_1_prey_10": 111, "speed_1_prey_12": 79, "speed_1_prey_14": 38, "speed_1_prey_13": 74, "speed_1_prey_15": 35}, "agent_episode_returns_mean": {"speed_1_prey_2": 3.2, "speed_1_prey_1": 4.4, "speed_1_predator_1": 0.4, "speed_2_predator_1": 0.4, "speed_1_prey_7": 0.47619047619047616, "speed_2_prey_1": 3.2, "speed_1_prey_4": 2.5, "speed_1_prey_5": 1.2, "speed_1_predator_0": 0.0, "speed_2_predator_2": 0.0, "speed_2_prey_5": 4.6, "speed_1_prey_3": 3.9, "speed_1_prey_6": 3.6, "speed_2_prey_3": 4.0, "speed_1_predator_2": 0.0, "speed_2_prey_0": 5.2, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 4.0, "speed_2_predator_0": 0.4, "speed_1_predator_3": 0.0, "speed_2_prey_4": 5.8, "speed_2_predator_3": 0.4, "speed_2_prey_2": 6.1, "speed_2_prey_6": 0.8, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 21.333333333333332, "speed_2_prey_8": 0.0, "speed_1_prey_10": 10.0, "speed_1_prey_12": 0.0, "speed_1_prey_14": 0.0, "speed_1_prey_13": 20.0, "speed_1_prey_11": 0.0, "speed_1_prey_15": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.0924743969856574e-05, "add_states_from_episodes_to_batch": 7.156362109306365e-06, "add_observations_from_episodes_to_batch": 9.71370535152027e-05, "add_time_dim_to_batch_and_zero_pad": 1.2959844403820353e-05, "agent_to_module_mapping": 1.0230502152897807e-05, "numpy_to_tensor": 8.021541226738885e-05}}, "connector_pipeline_timer": 0.000312775751280378}, "num_agent_steps_sampled": {"speed_1_prey_9": 99, "speed_1_prey_1": 707, "speed_1_prey_0": 791, "speed_1_predator_1": 368, "speed_1_predator_3": 363, "speed_2_predator_1": 375, "speed_2_prey_1": 711, "speed_1_prey_4": 585, "speed_2_prey_2": 749, "speed_1_prey_5": 499, "speed_1_prey_2": 642, "speed_1_predator_0": 399, "speed_2_predator_2": 441, "speed_1_prey_7": 158, "speed_2_prey_5": 571, "speed_1_prey_3": 842, "speed_1_prey_6": 198, "speed_2_prey_3": 620, "speed_1_predator_2": 440, "speed_1_predator_4": 0, "speed_1_prey_8": 120, "speed_2_predator_0": 554, "speed_2_prey_4": 871, "speed_2_predator_3": 571, "speed_2_prey_0": 802, "speed_2_prey_6": 45, "speed_2_predator_5": 0, "speed_2_prey_7": 17, "speed_2_predator_4": 0, "speed_2_prey_8": 6, "speed_1_prey_10": 107, "speed_1_prey_11": 65, "speed_1_prey_12": 79, "speed_1_prey_14": 38, "speed_1_prey_13": 74, "speed_1_prey_15": 35}, "agent_steps": {"speed_1_prey_9": 9.461538461538462, "speed_1_prey_1": 73.32, "speed_1_prey_0": 78.24, "speed_1_predator_1": 50.31, "speed_1_predator_3": 50.39, "speed_1_prey_4": 65.51, "speed_2_prey_2": 79.11, "speed_1_prey_5": 48.37, "speed_1_prey_2": 70.0, "speed_2_predator_2": 52.4, "speed_2_predator_1": 53.23, "speed_1_prey_7": 32.857142857142854, "speed_2_prey_1": 70.2, "speed_2_prey_5": 63.82, "speed_2_prey_3": 83.83, "speed_1_predator_2": 48.49, "speed_1_predator_0": 40.61, "speed_1_predator_4": 39.77333333333333, "speed_1_prey_3": 72.85, "speed_1_prey_6": 49.54, "speed_1_prey_8": 26.928571428571434, "speed_2_predator_0": 64.9, "speed_2_prey_4": 77.41, "speed_2_predator_3": 53.24, "speed_2_prey_0": 77.41, "speed_2_prey_6": 45.17, "speed_2_predator_5": 83.0, "speed_2_predator_4": 38.48, "speed_2_prey_7": 117.40000000000002, "speed_2_prey_8": 13.0, "speed_1_prey_10": 54.5, "speed_1_prey_13": 73.0, "speed_1_prey_11": 67.0, "speed_1_prey_12": 78.0, "speed_1_prey_15": 34.0, "speed_1_prey_14": 37.0}, "num_module_steps_sampled": {"speed_2_prey": 4392, "speed_1_prey": 5039, "speed_2_predator": 1941, "speed_1_predator": 1570}, "module_episode_returns_mean": {"speed_2_predator": 0.8, "speed_2_prey": 14.0, "speed_1_prey": 11.6, "speed_1_predator": 0.4}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.030143409330934e-06, "tensor_to_numpy": 0.00013115255538103808, "listify_data_for_vector_env": 5.4365877531443295e-05, "un_batch_to_individual_items": 0.00015125644327655368, "get_actions": 0.0005276777540208093, "remove_single_ts_time_rank_from_batch": 1.9156145952532243e-06, "normalize_and_clip_actions": 0.00021049585053640554}}, "connector_pipeline_timer": 0.0011559932781818386}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 9, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 190.0, "num_episodes_lifetime": 105, "num_module_steps_sampled_lifetime": {"speed_2_predator": 24695, "speed_2_prey": 43165, "speed_1_prey": 40940, "speed_1_predator": 21727}, "env_step_timer": 0.0025505224434621346, "episode_return_min": 0.0, "episode_length": 80.44270822329692, "rlmodule_inference_timer": 0.00308164032042294, "episode_return_mean": 55.7, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": 11287, "episode_len_max": 257, "num_env_steps_sampled": 1027, "env_to_module_sum_episodes_length_out": 71.17336344700065, "env_to_module_sum_episodes_length_in": 71.17336344700065, "sample": 0.9455251234182823, "episode_len_mean": 105.38, "episode_len_min": 53, "episode_duration_sec_mean": 0.7918905831900065, "time_between_sampling": 22.255795061884047, "num_env_steps_sampled_lifetime_throughput": 32.17083489236999}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 3.421435579298304e-08, "policy_loss": -0.27186304330825806, "entropy": 1.9902758598327637, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 11.0, "total_loss": -0.26064884662628174, "gradients_default_optimizer_global_norm": 0.2557985186576843, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 3.421435579298304e-08, "num_module_steps_trained_lifetime": 1349888, "mean_kl_loss": 0.022151343524456024, "vf_explained_var": 0.999163806438446, "num_module_steps_trained": 154496, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1666607419465149, "add_states_from_episodes_to_batch": 8.244197858820912e-06, "general_advantage_estimation": 0.15347987681429848, "add_columns_from_episodes_to_train_batch": 0.09662243698501058, "add_one_ts_to_episodes_and_truncate": 0.03732024653032216, "add_observations_from_episodes_to_batch": 0.001572144249389623, "add_time_dim_to_batch_and_zero_pad": 2.5252205858416727e-05, "agent_to_module_mapping": 0.006354854976552031, "numpy_to_tensor": 0.007656797924823628}}, "connector_pipeline_timer": 0.46999009289915833}, "learner_connector_sum_episodes_length_out": 1024.0111415845802, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 5399552, "learner_connector_sum_episodes_length_in": 1024.0111415845802, "num_module_steps_trained": 617984, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 10821673, "num_env_steps_trained": 1239589, "num_env_steps_trained_lifetime_throughput": 38830.21625726423}, "speed_2_predator": {"num_module_steps_trained_lifetime": 1349888, "mean_kl_loss": 0.011693257838487625, "vf_explained_var": 0.9992417693138123, "num_module_steps_trained": 154496, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1.3090095674073154e-09, "policy_loss": -0.23277166485786438, "entropy": 3.035693407058716, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 11.0, "total_loss": -0.2248787134885788, "gradients_default_optimizer_global_norm": 0.17030782997608185, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.3090095674073154e-09}, "speed_2_prey": {"vf_explained_var": -2.9802322387695312e-06, "policy_loss": 0.02167227678000927, "entropy": 2.9881553649902344, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 11.0, "total_loss": 1.3986347913742065, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.45165807008743286, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.3600000143051147, "num_module_steps_trained": 154496, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 1349888, "mean_kl_loss": 0.016753068193793297, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 15.729950904846191}, "speed_1_prey": {"policy_loss": -0.37490713596343994, "entropy": 1.8935697078704834, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737, "weights_seq_no": 11.0, "total_loss": 2.0306003093719482, "gradients_default_optimizer_global_norm": 0.5721490383148193, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.377117395401001, "num_module_steps_trained_lifetime": 1349888, "vf_explained_var": -0.0011087656021118164, "num_module_steps_trained": 154496, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.01869294047355652, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 28.606245040893555}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 11287, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 32.17083489236999, "done": false, "training_iteration": 11, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-20-37", "timestamp": 1745893237, "time_this_iter_s": 31.814377307891846, "time_total_s": 272.86320972442627, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0975940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 272.86320972442627, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 9.036363636363635, "ram_util_percent": 41.29090909090908, "gpu_util_percent0": 0.3140909090909091, "vram_util_percent0": 0.20225459282616107}, "timing/iter_minutes": 0.5320485830307007, "timing/avg_minutes_per_iter": 0.42529041080763846, "timing/total_hours_elapsed": 0.07796990864806705}
{"timers": {"training_iteration": 23.374772192326805, "restore_env_runners": 1.2361690582755815e-05, "training_step": 23.374620512305285, "env_runner_sampling_timer": 1.1093173019990106, "learner_update_timer": 22.25525952678681, "synch_weights": 0.007494692078375779, "synch_env_connectors": 0.0023098831143792044}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 8057, "speed_1_prey_5": 5815, "speed_1_prey_2": 7051, "speed_1_predator_0": 6209, "speed_2_predator_2": 6653, "speed_1_prey_7": 337, "speed_2_prey_5": 6328, "speed_1_prey_3": 7839, "speed_1_prey_6": 916, "speed_2_prey_3": 7849, "speed_1_predator_2": 5558, "speed_2_prey_0": 8957, "speed_1_predator_4": 220, "speed_1_prey_8": 188, "speed_2_predator_0": 6747, "speed_2_prey_4": 7551, "speed_2_predator_3": 6726, "speed_1_prey_9": 135, "speed_1_prey_1": 7429, "speed_1_prey_0": 8535, "speed_1_predator_1": 5804, "speed_1_predator_3": 5749, "speed_2_predator_1": 6445, "speed_2_prey_1": 7059, "speed_1_prey_4": 7121, "speed_2_prey_6": 895, "speed_2_predator_4": 176, "speed_2_predator_5": 83, "speed_2_prey_7": 453, "speed_1_prey_11": 80, "speed_2_prey_8": 121, "speed_1_prey_10": 126, "speed_1_prey_12": 79, "speed_1_prey_14": 38, "speed_1_prey_13": 74, "speed_1_prey_15": 35, "speed_2_prey_11": 7, "speed_2_prey_10": 12, "speed_2_prey_9": 12}, "agent_episode_returns_mean": {"speed_1_prey_2": 3.0, "speed_1_prey_1": 4.2, "speed_1_predator_1": 0.1, "speed_2_predator_1": 0.5, "speed_1_prey_7": 0.8, "speed_2_prey_1": 2.9, "speed_1_prey_4": 2.4, "speed_1_prey_5": 2.9, "speed_1_predator_0": 0.0, "speed_2_predator_2": 0.0, "speed_2_prey_5": 4.9, "speed_1_prey_3": 5.2, "speed_1_prey_6": 7.6, "speed_2_prey_3": 5.7, "speed_1_predator_2": 0.0, "speed_2_prey_0": 4.8, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.0, "speed_1_prey_8": 0.0, "speed_1_prey_0": 4.0, "speed_2_predator_0": 0.0, "speed_1_predator_3": 0.0, "speed_2_prey_4": 6.2, "speed_2_predator_3": 0.8, "speed_2_prey_2": 5.2, "speed_2_prey_6": 1.1, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 17.272727272727277, "speed_2_prey_8": 0.0, "speed_1_prey_10": 8.0, "speed_1_prey_12": 0.0, "speed_1_prey_14": 0.0, "speed_1_prey_13": 20.0, "speed_1_prey_11": 0.0, "speed_1_prey_15": 0.0, "speed_2_prey_11": 0.0, "speed_2_prey_10": 0.0, "speed_2_prey_9": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.096064620331835e-05, "add_states_from_episodes_to_batch": 7.151976477482056e-06, "add_observations_from_episodes_to_batch": 9.724692984146807e-05, "add_time_dim_to_batch_and_zero_pad": 1.2959204481099251e-05, "agent_to_module_mapping": 1.0248773668820665e-05, "numpy_to_tensor": 8.03185502224058e-05}}, "connector_pipeline_timer": 0.0003129170905642136}, "num_agent_steps_sampled": {"speed_1_prey_9": 19, "speed_1_prey_1": 808, "speed_1_prey_0": 922, "speed_1_predator_1": 485, "speed_1_predator_3": 484, "speed_2_predator_1": 521, "speed_2_prey_1": 554, "speed_1_prey_4": 662, "speed_2_prey_2": 538, "speed_1_prey_5": 516, "speed_1_prey_2": 651, "speed_1_predator_0": 475, "speed_2_predator_2": 568, "speed_1_prey_7": 84, "speed_2_prey_5": 552, "speed_1_prey_3": 915, "speed_1_prey_6": 226, "speed_2_prey_3": 593, "speed_1_predator_2": 369, "speed_1_predator_4": 0, "speed_1_prey_8": 27, "speed_2_predator_0": 471, "speed_2_prey_4": 762, "speed_2_predator_3": 551, "speed_2_prey_0": 670, "speed_2_prey_6": 196, "speed_2_predator_5": 0, "speed_2_prey_7": 143, "speed_2_predator_4": 24, "speed_2_prey_8": 97, "speed_1_prey_10": 15, "speed_1_prey_11": 13, "speed_1_prey_12": 0, "speed_1_prey_14": 0, "speed_1_prey_13": 0, "speed_1_prey_15": 0, "speed_2_prey_11": 7, "speed_2_prey_10": 12, "speed_2_prey_9": 12}, "agent_steps": {"speed_1_prey_9": 14.941176470588237, "speed_1_prey_1": 79.53, "speed_1_prey_0": 94.63, "speed_1_predator_1": 51.52, "speed_1_predator_3": 49.03, "speed_1_prey_4": 65.73, "speed_2_prey_2": 78.69, "speed_1_prey_5": 54.57, "speed_1_prey_2": 69.88, "speed_2_predator_2": 58.09, "speed_2_predator_1": 51.33, "speed_1_prey_7": 32.32, "speed_2_prey_1": 72.9, "speed_2_prey_5": 67.86, "speed_2_prey_3": 78.31, "speed_1_predator_2": 46.17, "speed_1_predator_0": 47.83, "speed_1_predator_4": 41.78666666666667, "speed_1_prey_3": 90.91, "speed_1_prey_6": 59.8, "speed_1_prey_8": 29.31578947368421, "speed_2_predator_0": 62.77, "speed_2_prey_4": 89.37, "speed_2_predator_3": 61.23, "speed_2_prey_0": 82.24, "speed_2_prey_6": 48.39, "speed_2_predator_5": 83.0, "speed_2_predator_4": 38.48, "speed_2_prey_7": 99.86363636363636, "speed_2_prey_8": 22.28571428571429, "speed_1_prey_10": 46.4, "speed_1_prey_13": 73.0, "speed_1_prey_11": 48.666666666666664, "speed_1_prey_12": 78.0, "speed_1_prey_15": 34.0, "speed_1_prey_14": 37.0, "speed_2_prey_11": 6.0, "speed_2_prey_10": 11.0, "speed_2_prey_9": 11.0}, "num_module_steps_sampled": {"speed_2_prey": 4136, "speed_1_prey": 4858, "speed_2_predator": 2135, "speed_1_predator": 1813}, "module_episode_returns_mean": {"speed_2_predator": 0.9, "speed_2_prey": 13.8, "speed_1_prey": 12.5, "speed_1_predator": 0.1}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.011737278841774e-06, "tensor_to_numpy": 0.00012952976836451687, "listify_data_for_vector_env": 5.4199286059158986e-05, "un_batch_to_individual_items": 0.00015077853774499958, "get_actions": 0.0005244598639660421, "remove_single_ts_time_rank_from_batch": 1.9134763499314013e-06, "normalize_and_clip_actions": 0.00020859714296605762}}, "connector_pipeline_timer": 0.0011482471698361658}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 9, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 190.0, "num_episodes_lifetime": 114, "num_module_steps_sampled_lifetime": {"speed_2_predator": 26830, "speed_2_prey": 47301, "speed_1_prey": 45798, "speed_1_predator": 23540}, "env_step_timer": 0.002554529219812341, "episode_return_min": 0.0, "episode_length": 80.64890549808071, "rlmodule_inference_timer": 0.0030607850404361487, "episode_return_mean": 60.1, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": 12312, "episode_len_max": 285, "num_env_steps_sampled": 1025, "env_to_module_sum_episodes_length_out": 71.6690612286156, "env_to_module_sum_episodes_length_in": 71.6690612286156, "sample": 0.9455974082340739, "episode_len_mean": 114.06, "episode_len_min": 53, "episode_duration_sec_mean": 0.8731195906999801, "time_between_sampling": 22.26245413044368, "num_env_steps_sampled_lifetime_throughput": 35.09636762231034}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.170735236006749e-08, "policy_loss": -0.09489228576421738, "entropy": 2.014648914337158, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 12.0, "total_loss": -0.08209124207496643, "gradients_default_optimizer_global_norm": 0.6797070503234863, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.170735236006749e-08, "num_module_steps_trained_lifetime": 1498368, "mean_kl_loss": 0.016857318580150604, "vf_explained_var": 0.9988892078399658, "num_module_steps_trained": 148480, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16662629132515963, "add_states_from_episodes_to_batch": 8.24291756649861e-06, "general_advantage_estimation": 0.15337749904718503, "add_columns_from_episodes_to_train_batch": 0.09661676180377181, "add_one_ts_to_episodes_and_truncate": 0.0372991620380507, "add_observations_from_episodes_to_batch": 0.0015718518571547243, "add_time_dim_to_batch_and_zero_pad": 2.5248937736255494e-05, "agent_to_module_mapping": 0.006353984848194931, "numpy_to_tensor": 0.007655324330457579}}, "connector_pipeline_timer": 0.4698237265818748}, "learner_connector_sum_episodes_length_out": 1024.0133154931502, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 5993472, "learner_connector_sum_episodes_length_in": 1024.0133154931502, "num_module_steps_trained": 593920, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 12010673, "num_env_steps_trained": 1189000, "num_env_steps_trained_lifetime_throughput": 40711.75310333419}, "speed_2_predator": {"num_module_steps_trained_lifetime": 1498368, "mean_kl_loss": 0.010995196178555489, "vf_explained_var": -5.9604644775390625e-06, "num_module_steps_trained": 148480, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1.9466211795806885, "policy_loss": -0.15855790674686432, "entropy": 3.0044236183166504, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 12.0, "total_loss": 0.0832388624548912, "gradients_default_optimizer_global_norm": 0.11419568955898285, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.234375}, "speed_2_prey": {"vf_explained_var": 2.86102294921875e-06, "policy_loss": -0.011658836156129837, "entropy": 2.97991681098938, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 12.0, "total_loss": 1.0432130098342896, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.3043617308139801, "diff_num_grad_updates_vs_sampler_policy": 1.0080000162124634, "vf_loss": 1.0399999618530273, "num_module_steps_trained": 148480, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 1498368, "mean_kl_loss": 0.014688218012452126, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 10.513344764709473}, "speed_1_prey": {"policy_loss": -0.1673334240913391, "entropy": 1.9368467330932617, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737, "weights_seq_no": 12.0, "total_loss": 2.400083303451538, "gradients_default_optimizer_global_norm": 1.1122677326202393, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.5397047996520996, "num_module_steps_trained_lifetime": 1498368, "vf_explained_var": -0.0006761550903320312, "num_module_steps_trained": 148480, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.018246343359351158, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 19.053010940551758}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 12312, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 35.09636762231034, "done": false, "training_iteration": 12, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-21-06", "timestamp": 1745893266, "time_this_iter_s": 29.149088144302368, "time_total_s": 302.01229786872864, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c08c7920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 302.01229786872864, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 8.84390243902439, "ram_util_percent": 41.392682926829266, "gpu_util_percent0": 0.3685365853658537, "vram_util_percent0": 0.20469574749484673}, "timing/iter_minutes": 0.4867470661799113, "timing/avg_minutes_per_iter": 0.4304117987553278, "timing/total_hours_elapsed": 0.08608235975106557}
{"timers": {"training_iteration": 23.472702459653537, "restore_env_runners": 1.2345873678315916e-05, "training_step": 23.47254895912223, "env_runner_sampling_timer": 1.1093868931290194, "learner_update_timer": 22.353110630848942, "synch_weights": 0.007490769147591069, "synch_env_connectors": 0.002305757623232914}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 8627, "speed_1_prey_5": 6570, "speed_1_prey_2": 7840, "speed_1_predator_0": 6612, "speed_2_predator_2": 7230, "speed_1_prey_7": 525, "speed_2_prey_5": 6967, "speed_1_prey_3": 8625, "speed_1_prey_6": 1152, "speed_2_prey_3": 8447, "speed_1_predator_2": 6008, "speed_2_prey_0": 9665, "speed_1_predator_4": 220, "speed_1_prey_8": 297, "speed_2_predator_0": 7269, "speed_2_prey_4": 8170, "speed_2_predator_3": 7320, "speed_1_prey_9": 181, "speed_1_prey_1": 8281, "speed_1_prey_0": 9410, "speed_1_predator_1": 6336, "speed_1_predator_3": 6290, "speed_2_predator_1": 6982, "speed_2_prey_1": 7608, "speed_1_prey_4": 7922, "speed_2_prey_6": 939, "speed_2_predator_4": 239, "speed_2_predator_5": 83, "speed_2_prey_7": 469, "speed_1_prey_11": 96, "speed_2_prey_8": 129, "speed_1_prey_10": 153, "speed_1_prey_12": 85, "speed_1_prey_14": 38, "speed_1_prey_13": 74, "speed_1_prey_15": 35, "speed_2_prey_11": 7, "speed_2_prey_10": 12, "speed_2_prey_9": 12}, "agent_episode_returns_mean": {"speed_1_prey_2": 4.3, "speed_1_prey_1": 4.4, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.4, "speed_1_prey_7": 1.2, "speed_2_prey_1": 2.3, "speed_1_prey_4": 5.2, "speed_1_prey_5": 6.9, "speed_1_predator_0": 0.0, "speed_2_predator_2": 0.4, "speed_2_prey_5": 2.4, "speed_1_prey_3": 7.7, "speed_1_prey_6": 6.8, "speed_2_prey_3": 4.2, "speed_1_predator_2": 0.0, "speed_2_prey_0": 3.0, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.43478260869565216, "speed_1_prey_8": 0.0, "speed_1_prey_0": 6.5, "speed_2_predator_0": 0.0, "speed_1_predator_3": 0.0, "speed_2_prey_4": 5.4, "speed_2_predator_3": 0.4, "speed_2_prey_2": 5.4, "speed_2_prey_6": 1.2, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 9.6, "speed_2_prey_8": 0.0, "speed_1_prey_10": 6.0, "speed_1_prey_12": 0.0, "speed_1_prey_14": 0.0, "speed_1_prey_13": 20.0, "speed_1_prey_11": 0.0, "speed_1_prey_15": 0.0, "speed_2_prey_11": 0.0, "speed_2_prey_10": 0.0, "speed_2_prey_9": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.100020313025304e-05, "add_states_from_episodes_to_batch": 7.14799048416099e-06, "add_observations_from_episodes_to_batch": 9.742865066709287e-05, "add_time_dim_to_batch_and_zero_pad": 1.2953068104073929e-05, "agent_to_module_mapping": 1.0268155395528404e-05, "numpy_to_tensor": 8.042029381076561e-05}}, "connector_pipeline_timer": 0.0003131457798182974}, "num_agent_steps_sampled": {"speed_1_prey_9": 46, "speed_1_prey_1": 852, "speed_1_prey_0": 875, "speed_1_predator_1": 532, "speed_1_predator_3": 541, "speed_2_predator_1": 537, "speed_2_prey_1": 549, "speed_1_prey_4": 801, "speed_2_prey_2": 570, "speed_1_prey_5": 755, "speed_1_prey_2": 789, "speed_1_predator_0": 403, "speed_2_predator_2": 577, "speed_1_prey_7": 188, "speed_2_prey_5": 639, "speed_1_prey_3": 786, "speed_1_prey_6": 236, "speed_2_prey_3": 598, "speed_1_predator_2": 450, "speed_1_predator_4": 0, "speed_1_prey_8": 109, "speed_2_predator_0": 522, "speed_2_prey_4": 619, "speed_2_predator_3": 594, "speed_2_prey_0": 708, "speed_2_prey_6": 44, "speed_2_predator_5": 0, "speed_2_prey_7": 16, "speed_2_predator_4": 63, "speed_2_prey_8": 8, "speed_1_prey_10": 27, "speed_1_prey_11": 16, "speed_1_prey_12": 6, "speed_1_prey_14": 0, "speed_1_prey_13": 0, "speed_1_prey_15": 0, "speed_2_prey_11": 0, "speed_2_prey_10": 0, "speed_2_prey_9": 0}, "agent_steps": {"speed_1_prey_9": 18.652173913043477, "speed_1_prey_1": 89.37, "speed_1_prey_0": 97.6, "speed_1_predator_1": 52.52, "speed_1_predator_3": 48.54, "speed_1_prey_4": 82.06, "speed_2_prey_2": 70.99, "speed_1_prey_5": 63.79, "speed_1_prey_2": 75.16, "speed_2_predator_2": 57.21, "speed_2_predator_1": 53.1, "speed_1_prey_7": 36.82, "speed_2_prey_1": 66.8, "speed_2_prey_5": 68.84, "speed_2_prey_3": 65.71, "speed_1_predator_2": 43.52, "speed_1_predator_0": 46.56, "speed_1_predator_4": 43.8, "speed_1_prey_3": 102.16, "speed_1_prey_6": 60.64, "speed_1_prey_8": 30.24, "speed_2_predator_0": 62.17, "speed_2_prey_4": 80.4, "speed_2_predator_3": 63.56, "speed_2_prey_0": 79.68, "speed_2_prey_6": 48.17, "speed_2_predator_5": 83.0, "speed_2_predator_4": 37.84, "speed_2_prey_7": 67.12, "speed_2_prey_8": 23.333333333333332, "speed_1_prey_10": 38.0, "speed_1_prey_13": 73.0, "speed_1_prey_11": 40.00000000000001, "speed_1_prey_12": 59.75, "speed_1_prey_15": 34.0, "speed_1_prey_14": 37.0, "speed_2_prey_11": 6.0, "speed_2_prey_10": 11.0, "speed_2_prey_9": 11.0}, "num_module_steps_sampled": {"speed_2_prey": 3751, "speed_1_prey": 5486, "speed_2_predator": 2293, "speed_1_predator": 1926}, "module_episode_returns_mean": {"speed_2_predator": 0.8, "speed_2_prey": 11.4, "speed_1_prey": 17.0, "speed_1_predator": 0.0}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 8.002522424008553e-06, "tensor_to_numpy": 0.0001279948648357616, "listify_data_for_vector_env": 5.4121579802194855e-05, "un_batch_to_individual_items": 0.0001504457237480369, "get_actions": 0.0005213638345372941, "remove_single_ts_time_rank_from_batch": 1.9120859444749103e-06, "normalize_and_clip_actions": 0.00020696992611040577}}, "connector_pipeline_timer": 0.0011412518362286937}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 11, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 190.0, "num_episodes_lifetime": 125, "num_module_steps_sampled_lifetime": {"speed_2_predator": 29123, "speed_2_prey": 51052, "speed_1_prey": 51284, "speed_1_predator": 25466}, "env_step_timer": 0.0025614966354212823, "episode_return_min": 10.0, "episode_length": 80.86076051292436, "rlmodule_inference_timer": 0.0030407249402817004, "episode_return_mean": 66.2, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": 13339, "episode_len_max": 285, "num_env_steps_sampled": 1027, "env_to_module_sum_episodes_length_out": 71.78331474458395, "env_to_module_sum_episodes_length_in": 71.78331474458395, "sample": 0.9457125930396935, "episode_len_mean": 114.32, "episode_len_min": 53, "episode_duration_sec_mean": 0.8821100897300039, "time_between_sampling": 22.27113152515478, "num_env_steps_sampled_lifetime_throughput": 30.903497578241105}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1.585861930664123e-08, "policy_loss": -0.17111711204051971, "entropy": 1.9751793146133423, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 13.0, "total_loss": -0.15742777287960052, "gradients_default_optimizer_global_norm": 0.32406488060951233, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.585861930664123e-08, "num_module_steps_trained_lifetime": 1666560, "mean_kl_loss": 0.018027087673544884, "vf_explained_var": 0.9992716312408447, "num_module_steps_trained": 168192, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16659342469583682, "add_states_from_episodes_to_batch": 8.241607360245425e-06, "general_advantage_estimation": 0.15327561573053242, "add_columns_from_episodes_to_train_batch": 0.09661237958185931, "add_one_ts_to_episodes_and_truncate": 0.03727662493727161, "add_observations_from_episodes_to_batch": 0.0015715779461395827, "add_time_dim_to_batch_and_zero_pad": 2.524583405593821e-05, "agent_to_module_mapping": 0.0063531591501073586, "numpy_to_tensor": 0.007653918501686345}}, "connector_pipeline_timer": 0.4696594031810471}, "learner_connector_sum_episodes_length_out": 1024.0157448093903, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 6666240, "learner_connector_sum_episodes_length_in": 1024.0157448093903, "num_module_steps_trained": 672768, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 13360151, "num_env_steps_trained": 1349478, "num_env_steps_trained_lifetime_throughput": 40607.251379478505}, "speed_2_predator": {"num_module_steps_trained_lifetime": 1666560, "mean_kl_loss": 0.009982545860111713, "vf_explained_var": 2.0384788513183594e-05, "num_module_steps_trained": 168192, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.4739255905151367, "policy_loss": -0.186316579580307, "entropy": 3.0276970863342285, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 13.0, "total_loss": 0.14300225675106049, "gradients_default_optimizer_global_norm": 0.08613503724336624, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.32258063554763794}, "speed_2_prey": {"vf_explained_var": -2.9802322387695312e-06, "policy_loss": -0.06387439370155334, "entropy": 2.9663591384887695, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 13.0, "total_loss": 1.0148370265960693, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.2274823635816574, "diff_num_grad_updates_vs_sampler_policy": 1.0081967115402222, "vf_loss": 1.065573811531067, "num_module_steps_trained": 168192, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 1666560, "mean_kl_loss": 0.012975461781024933, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 9.931558609008789}, "speed_1_prey": {"policy_loss": -0.24338211119174957, "entropy": 1.8581641912460327, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.5187500715255737, "weights_seq_no": 13.0, "total_loss": 1.8478556871414185, "gradients_default_optimizer_global_norm": 0.5725206732749939, "diff_num_grad_updates_vs_sampler_policy": 1.0079364776611328, "vf_loss": 2.063502550125122, "num_module_steps_trained_lifetime": 1666560, "vf_explained_var": -0.00022995471954345703, "num_module_steps_trained": 168192, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.018261993303894997, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 24.787315368652344}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 13339, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 30.903497578241105, "done": false, "training_iteration": 13, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-21-40", "timestamp": 1745893300, "time_this_iter_s": 33.17651128768921, "time_total_s": 335.18880915641785, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c0858400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 335.18880915641785, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 8.76, "ram_util_percent": 41.211111111111116, "gpu_util_percent0": 0.3724444444444444, "vram_util_percent0": 0.21153087625974779}, "timing/iter_minutes": 0.5538839936256409, "timing/avg_minutes_per_iter": 0.4399096598991981, "timing/total_hours_elapsed": 0.09531375964482626}
{"timers": {"training_iteration": 23.546609483847007, "restore_env_runners": 1.2341204944931075e-05, "training_step": 23.546454002071005, "env_runner_sampling_timer": 1.1107631758077294, "learner_update_timer": 22.425646597760455, "synch_weights": 0.00748126062611343, "synch_env_connectors": 0.002306564966999726}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 9243, "speed_1_prey_5": 7060, "speed_1_prey_2": 8629, "speed_1_predator_0": 6820, "speed_2_predator_2": 7452, "speed_1_prey_7": 632, "speed_2_prey_5": 7322, "speed_1_prey_3": 9460, "speed_1_prey_6": 1427, "speed_2_prey_3": 9052, "speed_1_predator_2": 6419, "speed_2_prey_0": 10490, "speed_1_predator_4": 220, "speed_1_prey_8": 385, "speed_2_predator_0": 7669, "speed_2_prey_4": 8649, "speed_2_predator_3": 7581, "speed_1_prey_9": 235, "speed_1_prey_1": 8932, "speed_1_prey_0": 10421, "speed_1_predator_1": 6552, "speed_1_predator_3": 6423, "speed_2_predator_1": 7371, "speed_2_prey_1": 8172, "speed_1_prey_4": 8536, "speed_2_prey_6": 1172, "speed_2_predator_4": 485, "speed_2_predator_5": 83, "speed_2_prey_7": 636, "speed_1_prey_11": 137, "speed_2_prey_8": 208, "speed_1_prey_10": 200, "speed_1_prey_12": 126, "speed_1_prey_14": 60, "speed_1_prey_13": 96, "speed_1_prey_15": 35, "speed_2_prey_11": 7, "speed_2_prey_10": 69, "speed_2_prey_9": 80}, "agent_episode_returns_mean": {"speed_1_prey_2": 4.0, "speed_1_prey_1": 4.4, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.4, "speed_1_prey_7": 1.5, "speed_2_prey_1": 2.3, "speed_1_prey_4": 5.2, "speed_1_prey_5": 6.5, "speed_1_predator_0": 0.0, "speed_2_predator_2": 0.8, "speed_2_prey_5": 2.1, "speed_1_prey_3": 7.4, "speed_1_prey_6": 5.2, "speed_2_prey_3": 4.2, "speed_1_predator_2": 0.0, "speed_2_prey_0": 3.2, "speed_1_predator_4": 0.0, "speed_1_prey_9": 0.8, "speed_1_prey_8": 0.0, "speed_1_prey_0": 7.3, "speed_2_predator_0": 0.0, "speed_1_predator_3": 0.0, "speed_2_prey_4": 5.3, "speed_2_predator_3": 0.4, "speed_2_prey_2": 4.8, "speed_2_prey_6": 1.2, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 7.200000000000001, "speed_2_prey_8": 0.0, "speed_1_prey_10": 5.333333333333333, "speed_1_prey_12": 0.0, "speed_1_prey_14": 0.0, "speed_1_prey_13": 20.0, "speed_1_prey_11": 0.0, "speed_1_prey_15": 0.0, "speed_2_prey_11": 0.0, "speed_2_prey_10": 0.0, "speed_2_prey_9": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.115396567374571e-05, "add_states_from_episodes_to_batch": 7.168533548389764e-06, "add_observations_from_episodes_to_batch": 9.783382347129787e-05, "add_time_dim_to_batch_and_zero_pad": 1.304982299994684e-05, "agent_to_module_mapping": 1.0303765184977471e-05, "numpy_to_tensor": 8.090460909031143e-05}}, "connector_pipeline_timer": 0.0003144087769978954}, "num_agent_steps_sampled": {"speed_1_prey_9": 54, "speed_1_prey_1": 651, "speed_1_prey_0": 1011, "speed_1_predator_1": 216, "speed_1_predator_3": 133, "speed_2_predator_1": 389, "speed_2_prey_1": 564, "speed_1_prey_4": 614, "speed_2_prey_2": 616, "speed_1_prey_5": 490, "speed_1_prey_2": 789, "speed_1_predator_0": 208, "speed_2_predator_2": 222, "speed_1_prey_7": 107, "speed_2_prey_5": 355, "speed_1_prey_3": 835, "speed_1_prey_6": 275, "speed_2_prey_3": 605, "speed_1_predator_2": 411, "speed_1_predator_4": 0, "speed_1_prey_8": 88, "speed_2_predator_0": 400, "speed_2_prey_4": 479, "speed_2_predator_3": 261, "speed_2_prey_0": 825, "speed_2_prey_6": 233, "speed_2_predator_5": 0, "speed_2_prey_7": 167, "speed_2_predator_4": 246, "speed_2_prey_8": 79, "speed_1_prey_10": 47, "speed_1_prey_11": 41, "speed_1_prey_12": 41, "speed_1_prey_14": 22, "speed_1_prey_13": 22, "speed_1_prey_15": 0, "speed_2_prey_11": 0, "speed_2_prey_10": 57, "speed_2_prey_9": 68}, "agent_steps": {"speed_1_prey_9": 24.0, "speed_1_prey_1": 89.1, "speed_1_prey_0": 101.72, "speed_1_predator_1": 52.43, "speed_1_predator_3": 49.35, "speed_1_prey_4": 81.62, "speed_2_prey_2": 68.96, "speed_1_prey_5": 63.0, "speed_1_prey_2": 78.37, "speed_2_predator_2": 60.1, "speed_2_predator_1": 54.02, "speed_1_prey_7": 37.13, "speed_2_prey_1": 64.38, "speed_2_prey_5": 70.73, "speed_2_prey_3": 69.29, "speed_1_predator_2": 41.83, "speed_1_predator_0": 47.88, "speed_1_predator_4": 43.8, "speed_1_prey_3": 100.86, "speed_1_prey_6": 51.6, "speed_1_prey_8": 30.16, "speed_2_predator_0": 61.68, "speed_2_prey_4": 78.86, "speed_2_predator_3": 65.04, "speed_2_prey_0": 80.46, "speed_2_prey_6": 48.38, "speed_2_predator_5": 83.0, "speed_2_predator_4": 37.52, "speed_2_prey_7": 56.13333333333333, "speed_2_prey_8": 23.764705882352942, "speed_1_prey_10": 35.2, "speed_1_prey_13": 73.0, "speed_1_prey_11": 37.11111111111111, "speed_1_prey_12": 53.666666666666664, "speed_1_prey_15": 34.0, "speed_1_prey_14": 37.0, "speed_2_prey_11": 6.0, "speed_2_prey_10": 11.0, "speed_2_prey_9": 11.0}, "num_module_steps_sampled": {"speed_2_prey": 4048, "speed_1_prey": 5087, "speed_2_predator": 1518, "speed_1_predator": 968}, "module_episode_returns_mean": {"speed_2_predator": 1.2, "speed_2_prey": 11.0, "speed_1_prey": 17.3, "speed_1_predator": 0.0}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 7.997639462678537e-06, "tensor_to_numpy": 0.0001268320197634002, "listify_data_for_vector_env": 5.400834271823388e-05, "un_batch_to_individual_items": 0.00015019361356583737, "get_actions": 0.0005198991507960652, "remove_single_ts_time_rank_from_batch": 1.9198668060565535e-06, "normalize_and_clip_actions": 0.00020536449922258838}}, "connector_pipeline_timer": 0.0011366364153368486}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 2, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 190.0, "num_episodes_lifetime": 127, "num_module_steps_sampled_lifetime": {"speed_2_predator": 30641, "speed_2_prey": 55100, "speed_1_prey": 56371, "speed_1_predator": 26434}, "env_step_timer": 0.002567093902309749, "episode_return_min": 10.0, "episode_length": 81.06743705186561, "rlmodule_inference_timer": 0.0030255290501476836, "episode_return_mean": 66.0, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": 14365, "episode_len_max": 285, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 73.91211946541429, "env_to_module_sum_episodes_length_in": 73.91211946541429, "sample": 0.9458776962778942, "episode_len_mean": 116.74, "episode_len_min": 53, "episode_duration_sec_mean": 0.9032718686300132, "time_between_sampling": 22.28328347127555, "num_env_steps_sampled_lifetime_throughput": 33.17369651992511}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.692875623703003, "policy_loss": -0.09432099014520645, "entropy": 1.974094033241272, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 14.0, "total_loss": 0.2366422861814499, "gradients_default_optimizer_global_norm": 0.17780055105686188, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3174603283405304, "num_module_steps_trained_lifetime": 1820928, "mean_kl_loss": 0.017781704664230347, "vf_explained_var": 3.159046173095703e-06, "num_module_steps_trained": 154368, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16656174546866795, "add_states_from_episodes_to_batch": 8.24027756635863e-06, "general_advantage_estimation": 0.15316192043290816, "add_columns_from_episodes_to_train_batch": 0.0966075256963047, "add_one_ts_to_episodes_and_truncate": 0.037252012744004304, "add_observations_from_episodes_to_batch": 0.0015712305547590272, "add_time_dim_to_batch_and_zero_pad": 2.524286505545078e-05, "agent_to_module_mapping": 0.00635226979479671, "numpy_to_tensor": 0.007652214243357505}}, "connector_pipeline_timer": 0.46948146434597765}, "learner_connector_sum_episodes_length_out": 1024.0183242077565, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 7283712, "learner_connector_sum_episodes_length_in": 1024.0183242077565, "num_module_steps_trained": 617472, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 14597507, "num_env_steps_trained": 1237356, "num_env_steps_trained_lifetime_throughput": 40007.4241675851}, "speed_2_predator": {"num_module_steps_trained_lifetime": 1820928, "mean_kl_loss": 0.01043733861297369, "vf_explained_var": -6.67572021484375e-06, "num_module_steps_trained": 154368, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 6.557312965393066, "policy_loss": -0.24279406666755676, "entropy": 3.003082513809204, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 14.0, "total_loss": 0.954727292060852, "gradients_default_optimizer_global_norm": 0.11445347219705582, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.1904761791229248}, "speed_2_prey": {"vf_explained_var": -0.00038611888885498047, "policy_loss": 0.021960102021694183, "entropy": 2.952871561050415, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 14.0, "total_loss": 1.9287315607070923, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.43334028124809265, "diff_num_grad_updates_vs_sampler_policy": 1.0078740119934082, "vf_loss": 1.8902692794799805, "num_module_steps_trained": 154368, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 1820928, "mean_kl_loss": 0.016298558562994003, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 18.907995223999023}, "speed_1_prey": {"policy_loss": -0.2925684154033661, "entropy": 1.8807263374328613, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.278125047683716, "weights_seq_no": 14.0, "total_loss": 4.2545928955078125, "gradients_default_optimizer_global_norm": 0.9784822463989258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 4.516526699066162, "num_module_steps_trained_lifetime": 1820928, "vf_explained_var": 0.0016170740127563477, "num_module_steps_trained": 154368, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.020171212032437325, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 47.159332275390625}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 14365, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 33.17369651992511, "done": false, "training_iteration": 14, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-22-11", "timestamp": 1745893331, "time_this_iter_s": 31.277766227722168, "time_total_s": 366.46657538414, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd7b0001b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 366.46657538414, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 8.999999999999998, "ram_util_percent": 41.36046511627907, "gpu_util_percent0": 0.34139534883720923, "vram_util_percent0": 0.21579888132756198}, "timing/iter_minutes": 0.5222172339757284, "timing/avg_minutes_per_iter": 0.44578877233323594, "timing/total_hours_elapsed": 0.10401738021108839}
{"timers": {"training_iteration": 23.69863763737854, "restore_env_runners": 1.2337322895601757e-05, "training_step": 23.69848039190029, "env_runner_sampling_timer": 1.113420386619651, "learner_update_timer": 22.57500264560285, "synch_weights": 0.007481389619853079, "synch_env_connectors": 0.002304944707327736}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 9899, "speed_1_prey_5": 7826, "speed_1_prey_2": 9570, "speed_1_predator_0": 7113, "speed_2_predator_2": 7838, "speed_1_prey_7": 900, "speed_2_prey_5": 7918, "speed_1_prey_3": 10146, "speed_1_prey_6": 1788, "speed_2_prey_3": 9679, "speed_1_predator_2": 6844, "speed_2_prey_0": 11299, "speed_1_predator_4": 254, "speed_1_prey_8": 527, "speed_2_predator_0": 8248, "speed_2_prey_4": 9422, "speed_2_predator_3": 7989, "speed_1_prey_9": 354, "speed_1_prey_1": 9902, "speed_1_prey_0": 11381, "speed_1_predator_1": 6846, "speed_1_predator_3": 6736, "speed_2_predator_1": 7748, "speed_2_prey_1": 9147, "speed_1_prey_4": 9446, "speed_2_prey_6": 1424, "speed_2_predator_4": 589, "speed_2_predator_5": 83, "speed_2_prey_7": 749, "speed_1_prey_11": 214, "speed_2_prey_8": 255, "speed_1_prey_10": 299, "speed_1_prey_12": 205, "speed_1_prey_14": 116, "speed_1_prey_13": 153, "speed_1_prey_15": 47, "speed_2_prey_11": 9, "speed_2_prey_10": 116, "speed_2_prey_9": 127}, "agent_episode_returns_mean": {"speed_1_prey_2": 7.2, "speed_1_prey_1": 6.1, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.5, "speed_1_prey_7": 2.0, "speed_2_prey_1": 3.2, "speed_1_prey_4": 6.9, "speed_1_prey_5": 6.0, "speed_1_predator_0": 0.0, "speed_2_predator_2": 0.8, "speed_2_prey_5": 2.8, "speed_1_prey_3": 6.7, "speed_1_prey_6": 4.8, "speed_2_prey_3": 3.9, "speed_1_predator_2": 0.8, "speed_2_prey_0": 5.8, "speed_1_predator_4": 0.0, "speed_1_prey_9": 1.6, "speed_1_prey_8": 0.0, "speed_1_prey_0": 10.8, "speed_2_predator_0": 0.4, "speed_1_predator_3": 0.0, "speed_2_prey_4": 3.9, "speed_2_predator_3": 0.4, "speed_2_prey_2": 6.5, "speed_2_prey_6": 1.4, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 5.6, "speed_2_prey_8": 0.0, "speed_1_prey_10": 5.238095238095237, "speed_1_prey_12": 1.1111111111111112, "speed_1_prey_14": 0.0, "speed_1_prey_13": 16.666666666666668, "speed_1_prey_11": 0.0, "speed_1_prey_15": 0.0, "speed_2_prey_11": 0.0, "speed_2_prey_10": 0.0, "speed_2_prey_9": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.131205568297409e-05, "add_states_from_episodes_to_batch": 7.1667513832262375e-06, "add_observations_from_episodes_to_batch": 9.817385341428788e-05, "add_time_dim_to_batch_and_zero_pad": 1.3109237380795958e-05, "agent_to_module_mapping": 1.034561772044503e-05, "numpy_to_tensor": 8.118768030612362e-05}}, "connector_pipeline_timer": 0.0003152231483970987}, "num_agent_steps_sampled": {"speed_1_prey_9": 119, "speed_1_prey_1": 970, "speed_1_prey_0": 960, "speed_1_predator_1": 294, "speed_1_predator_3": 313, "speed_2_predator_1": 377, "speed_2_prey_1": 975, "speed_1_prey_4": 910, "speed_2_prey_2": 656, "speed_1_prey_5": 766, "speed_1_prey_2": 941, "speed_1_predator_0": 293, "speed_2_predator_2": 386, "speed_1_prey_7": 268, "speed_2_prey_5": 596, "speed_1_prey_3": 686, "speed_1_prey_6": 361, "speed_2_prey_3": 627, "speed_1_predator_2": 425, "speed_1_predator_4": 34, "speed_1_prey_8": 142, "speed_2_predator_0": 579, "speed_2_prey_4": 773, "speed_2_predator_3": 408, "speed_2_prey_0": 809, "speed_2_prey_6": 252, "speed_2_predator_5": 0, "speed_2_prey_7": 113, "speed_2_predator_4": 104, "speed_2_prey_8": 47, "speed_1_prey_10": 99, "speed_1_prey_11": 77, "speed_1_prey_12": 79, "speed_1_prey_14": 56, "speed_1_prey_13": 57, "speed_1_prey_15": 12, "speed_2_prey_11": 2, "speed_2_prey_10": 47, "speed_2_prey_9": 47}, "agent_steps": {"speed_1_prey_9": 33.01333333333333, "speed_1_prey_1": 98.87, "speed_1_prey_0": 112.11, "speed_1_predator_1": 48.0, "speed_1_predator_3": 48.34, "speed_1_prey_4": 92.97, "speed_2_prey_2": 77.12, "speed_1_prey_5": 71.81, "speed_1_prey_2": 93.74, "speed_2_predator_2": 55.0, "speed_2_predator_1": 59.41, "speed_1_prey_7": 37.04, "speed_2_prey_1": 77.92, "speed_2_prey_5": 77.68, "speed_2_prey_3": 73.15, "speed_1_predator_2": 55.03, "speed_1_predator_0": 45.17, "speed_1_predator_4": 43.80000000000001, "speed_1_prey_3": 101.1, "speed_1_prey_6": 54.18666666666667, "speed_1_prey_8": 29.98, "speed_2_predator_0": 61.51, "speed_2_prey_4": 81.59, "speed_2_predator_3": 60.1, "speed_2_prey_0": 94.62, "speed_2_prey_6": 54.62, "speed_2_predator_5": 83.0, "speed_2_predator_4": 43.16, "speed_2_prey_7": 57.44, "speed_2_prey_8": 27.166666666666668, "speed_1_prey_10": 36.333333333333336, "speed_1_prey_13": 71.16666666666667, "speed_1_prey_11": 38.692307692307686, "speed_1_prey_12": 54.0, "speed_1_prey_15": 34.0, "speed_1_prey_14": 41.166666666666664, "speed_2_prey_11": 5.0, "speed_2_prey_10": 29.4, "speed_2_prey_9": 31.6}, "num_module_steps_sampled": {"speed_2_prey": 4944, "speed_1_prey": 6503, "speed_2_predator": 1854, "speed_1_predator": 1359}, "module_episode_returns_mean": {"speed_2_predator": 2.0, "speed_2_prey": 15.0, "speed_1_prey": 23.8, "speed_1_predator": 0.4}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 7.989837242940256e-06, "tensor_to_numpy": 0.00012552767558887017, "listify_data_for_vector_env": 5.398791755577775e-05, "un_batch_to_individual_items": 0.00015317588889626136, "get_actions": 0.0005175740890031683, "remove_single_ts_time_rank_from_batch": 1.9223358139428485e-06, "normalize_and_clip_actions": 0.00020406064750976897}}, "connector_pipeline_timer": 0.001134451639820205}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 9, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 210.0, "num_episodes_lifetime": 136, "num_module_steps_sampled_lifetime": {"speed_2_predator": 32495, "speed_2_prey": 60044, "speed_1_prey": 62874, "speed_1_predator": 27793}, "env_step_timer": 0.00257811431272013, "episode_return_min": 10.0, "episode_length": 81.32085865796421, "rlmodule_inference_timer": 0.003007522588586433, "episode_return_mean": 78.1, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": 15390, "episode_len_max": 285, "num_env_steps_sampled": 1025, "env_to_module_sum_episodes_length_out": 75.5748738618766, "env_to_module_sum_episodes_length_in": 75.5748738618766, "sample": 0.9461184555566274, "episode_len_mean": 126.18, "episode_len_min": 65, "episode_duration_sec_mean": 1.0037019716000213, "time_between_sampling": 22.297819699735946, "num_env_steps_sampled_lifetime_throughput": 26.405423344209094}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1.174496054649353, "policy_loss": -0.02945009432733059, "entropy": 2.004500389099121, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 15.0, "total_loss": 0.14255455136299133, "gradients_default_optimizer_global_norm": 0.10363217443227768, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.16260161995887756, "num_module_steps_trained_lifetime": 2019456, "mean_kl_loss": 0.0123825678601861, "vf_explained_var": 8.821487426757812e-06, "num_module_steps_trained": 198528, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1665318352349729, "add_states_from_episodes_to_batch": 8.238798407625257e-06, "general_advantage_estimation": 0.15304505656196335, "add_columns_from_episodes_to_train_batch": 0.09660413264350298, "add_one_ts_to_episodes_and_truncate": 0.03722608714960862, "add_observations_from_episodes_to_batch": 0.0015708735435114687, "add_time_dim_to_batch_and_zero_pad": 2.5239647051595267e-05, "agent_to_module_mapping": 0.0063514290063772525, "numpy_to_tensor": 0.007650346425745083}}, "connector_pipeline_timer": 0.46930213966329154}, "learner_connector_sum_episodes_length_out": 1024.020950443674, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 8077824, "learner_connector_sum_episodes_length_in": 1024.020950443674, "num_module_steps_trained": 794112, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 16187282, "num_env_steps_trained": 1589775, "num_env_steps_trained_lifetime_throughput": 40954.83095443628}, "speed_2_predator": {"num_module_steps_trained_lifetime": 2019456, "mean_kl_loss": 0.013878528960049152, "vf_explained_var": 2.9802322387695312e-06, "num_module_steps_trained": 198528, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 3.9332518577575684, "policy_loss": -0.19838972389698029, "entropy": 3.0012569427490234, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 15.0, "total_loss": 0.5309783220291138, "gradients_default_optimizer_global_norm": 0.09680173546075821, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.7200000286102295}, "speed_2_prey": {"vf_explained_var": 0.0020546317100524902, "policy_loss": -0.08945044875144958, "entropy": 2.9457316398620605, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 15.0, "total_loss": 2.024871826171875, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.3910721242427826, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.0972213745117188, "num_module_steps_trained": 198528, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 2019456, "mean_kl_loss": 0.016889648512005806, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 14.385200500488281}, "speed_1_prey": {"policy_loss": -0.3114222288131714, "entropy": 1.856853723526001, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.278125047683716, "weights_seq_no": 15.0, "total_loss": 3.487396240234375, "gradients_default_optimizer_global_norm": 1.0429736375808716, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 3.7607336044311523, "num_module_steps_trained_lifetime": 2019456, "vf_explained_var": 0.0016303658485412598, "num_module_steps_trained": 198528, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.016717536374926567, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 45.69593811035156}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 15390, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 26.405423344209094, "done": false, "training_iteration": 15, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-22-50", "timestamp": 1745893370, "time_this_iter_s": 38.75802564620972, "time_total_s": 405.22460103034973, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd7ad148180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 405.22460103034973, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 8.62962962962963, "ram_util_percent": 42.01481481481481, "gpu_util_percent0": 0.36685185185185176, "vram_util_percent0": 0.2314528337163086}, "timing/iter_minutes": 0.6469458500544231, "timing/avg_minutes_per_iter": 0.4591992441813151, "timing/total_hours_elapsed": 0.11479981104532877}
{"timers": {"training_iteration": 23.795152062734754, "restore_env_runners": 1.2353859664970322e-05, "training_step": 23.794991880801287, "env_runner_sampling_timer": 1.114175424553454, "learner_update_timer": 22.670755667396822, "synch_weights": 0.007478143653653767, "synch_env_connectors": 0.00230597820025352}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 10602, "speed_1_prey_5": 8426, "speed_1_prey_2": 10278, "speed_1_predator_0": 7409, "speed_2_predator_2": 8351, "speed_1_prey_7": 1253, "speed_2_prey_5": 8614, "speed_1_prey_3": 10882, "speed_1_prey_6": 2201, "speed_2_prey_3": 10428, "speed_1_predator_2": 7170, "speed_2_prey_0": 12128, "speed_1_predator_4": 348, "speed_1_prey_8": 783, "speed_2_predator_0": 8829, "speed_2_prey_4": 10177, "speed_2_predator_3": 8311, "speed_1_prey_9": 482, "speed_1_prey_1": 10578, "speed_1_prey_0": 12112, "speed_1_predator_1": 7227, "speed_1_predator_3": 7040, "speed_2_predator_1": 8165, "speed_2_prey_1": 9964, "speed_1_prey_4": 10215, "speed_2_prey_6": 1729, "speed_2_predator_4": 691, "speed_2_predator_5": 177, "speed_2_prey_7": 966, "speed_1_prey_11": 263, "speed_2_prey_8": 386, "speed_1_prey_10": 358, "speed_1_prey_12": 248, "speed_1_prey_14": 152, "speed_1_prey_13": 189, "speed_1_prey_15": 83, "speed_2_prey_11": 9, "speed_2_prey_10": 117, "speed_2_prey_9": 170}, "agent_episode_returns_mean": {"speed_1_prey_2": 9.1, "speed_1_prey_1": 8.1, "speed_1_predator_1": 0.0, "speed_2_predator_1": 0.5, "speed_1_prey_7": 2.2, "speed_2_prey_1": 3.6, "speed_1_prey_4": 7.3, "speed_1_prey_5": 5.7, "speed_1_predator_0": 0.4, "speed_2_predator_2": 0.8, "speed_2_prey_5": 2.4, "speed_1_prey_3": 7.1, "speed_1_prey_6": 5.066666666666666, "speed_2_prey_3": 4.1, "speed_1_predator_2": 0.8, "speed_2_prey_0": 8.4, "speed_1_predator_4": 0.0, "speed_1_prey_9": 2.3, "speed_1_prey_8": 0.4, "speed_1_prey_0": 11.4, "speed_2_predator_0": 0.4, "speed_1_predator_3": 0.0, "speed_2_prey_4": 3.7, "speed_2_predator_3": 1.2, "speed_2_prey_2": 6.0, "speed_2_prey_6": 1.2, "speed_2_predator_4": 0.0, "speed_2_predator_5": 0.0, "speed_2_prey_7": 5.6, "speed_2_prey_8": 0.0, "speed_1_prey_10": 4.4, "speed_1_prey_12": 1.5384615384615385, "speed_1_prey_14": 0.0, "speed_1_prey_13": 13.333333333333336, "speed_1_prey_11": 0.0, "speed_1_prey_15": 0.0, "speed_2_prey_11": 0.0, "speed_2_prey_10": 0.0, "speed_2_prey_9": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.13442335295614e-05, "add_states_from_episodes_to_batch": 7.159370566482599e-06, "add_observations_from_episodes_to_batch": 9.842746631245563e-05, "add_time_dim_to_batch_and_zero_pad": 1.310349050032672e-05, "agent_to_module_mapping": 1.0366341099440922e-05, "numpy_to_tensor": 8.12141681082603e-05}}, "connector_pipeline_timer": 0.000315422793609929}, "num_agent_steps_sampled": {"speed_1_prey_9": 128, "speed_1_prey_1": 676, "speed_1_prey_0": 731, "speed_1_predator_1": 381, "speed_1_predator_3": 304, "speed_2_predator_1": 417, "speed_2_prey_1": 817, "speed_1_prey_4": 769, "speed_2_prey_2": 703, "speed_1_prey_5": 600, "speed_1_prey_2": 708, "speed_1_predator_0": 296, "speed_2_predator_2": 513, "speed_1_prey_7": 353, "speed_2_prey_5": 696, "speed_1_prey_3": 736, "speed_1_prey_6": 413, "speed_2_prey_3": 749, "speed_1_predator_2": 326, "speed_1_predator_4": 94, "speed_1_prey_8": 256, "speed_2_predator_0": 581, "speed_2_prey_4": 755, "speed_2_predator_3": 322, "speed_2_prey_0": 829, "speed_2_prey_6": 305, "speed_2_predator_5": 94, "speed_2_prey_7": 217, "speed_2_predator_4": 102, "speed_2_prey_8": 131, "speed_1_prey_10": 59, "speed_1_prey_11": 49, "speed_1_prey_12": 43, "speed_1_prey_14": 36, "speed_1_prey_13": 36, "speed_1_prey_15": 36, "speed_2_prey_11": 0, "speed_2_prey_10": 1, "speed_2_prey_9": 43}, "agent_steps": {"speed_1_prey_9": 36.85, "speed_1_prey_1": 106.44, "speed_1_prey_0": 119.62, "speed_1_predator_1": 47.1, "speed_1_predator_3": 46.75, "speed_1_prey_4": 99.09, "speed_2_prey_2": 82.29, "speed_1_prey_5": 77.33, "speed_1_prey_2": 106.43, "speed_2_predator_2": 55.25, "speed_2_predator_1": 57.85, "speed_1_prey_7": 42.44, "speed_2_prey_1": 88.14, "speed_2_prey_5": 74.1, "speed_2_prey_3": 81.3, "speed_1_predator_2": 57.81, "speed_1_predator_0": 45.5, "speed_1_predator_4": 45.54666666666667, "speed_1_prey_3": 106.79, "speed_1_prey_6": 60.02666666666667, "speed_1_prey_8": 37.30666666666667, "speed_2_predator_0": 64.33, "speed_2_prey_4": 80.78, "speed_2_predator_3": 67.82, "speed_2_prey_0": 99.32, "speed_2_prey_6": 53.56, "speed_2_predator_5": 83.0, "speed_2_predator_4": 48.80000000000001, "speed_2_prey_7": 65.84, "speed_2_prey_8": 30.52, "speed_1_prey_10": 37.00000000000001, "speed_1_prey_13": 68.11111111111111, "speed_1_prey_11": 41.611111111111114, "speed_1_prey_12": 55.61538461538463, "speed_1_prey_15": 35.857142857142854, "speed_1_prey_14": 44.0, "speed_2_prey_11": 4.571428571428571, "speed_2_prey_10": 37.285714285714285, "speed_2_prey_9": 36.875}, "num_module_steps_sampled": {"speed_2_prey": 5246, "speed_1_prey": 5629, "speed_2_predator": 2029, "speed_1_predator": 1401}, "module_episode_returns_mean": {"speed_2_predator": 2.8, "speed_2_prey": 16.5, "speed_1_prey": 31.2, "speed_1_predator": 0.4}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 7.97593496145559e-06, "tensor_to_numpy": 0.00012416297288378624, "listify_data_for_vector_env": 5.3914835805367203e-05, "un_batch_to_individual_items": 0.00015362613473978077, "get_actions": 0.0005147601369614624, "remove_single_ts_time_rank_from_batch": 1.9247364228372944e-06, "normalize_and_clip_actions": 0.0002026322729915535}}, "connector_pipeline_timer": 0.001128927731471609}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 4, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 250.0, "num_episodes_lifetime": 140, "num_module_steps_sampled_lifetime": {"speed_2_predator": 34524, "speed_2_prey": 65290, "speed_1_prey": 68503, "speed_1_predator": 29194}, "env_step_timer": 0.002587027857386817, "episode_return_min": 10.0, "episode_length": 81.59247445511811, "rlmodule_inference_timer": 0.002986328641380927, "episode_return_mean": 88.3, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": 16416, "episode_len_max": 296, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 77.56722857476579, "env_to_module_sum_episodes_length_in": 77.56722857476579, "sample": 0.9463994949762358, "episode_len_mean": 134.0, "episode_len_min": 65, "episode_duration_sec_mean": 1.077278298650026, "time_between_sampling": 22.31769554472771, "num_env_steps_sampled_lifetime_throughput": 30.703815045903937}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.2584011554718018, "policy_loss": -0.058469049632549286, "entropy": 1.9993007183074951, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 16.0, "total_loss": 0.3485223948955536, "gradients_default_optimizer_global_norm": 0.17335397005081177, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.3937007784843445, "num_module_steps_trained_lifetime": 2190976, "mean_kl_loss": 0.017502063885331154, "vf_explained_var": -6.794929504394531e-06, "num_module_steps_trained": 171520, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16650288015330486, "add_states_from_episodes_to_batch": 8.23716420432374e-06, "general_advantage_estimation": 0.15292146505749418, "add_columns_from_episodes_to_train_batch": 0.09660212934848769, "add_one_ts_to_episodes_and_truncate": 0.03719872564612642, "add_observations_from_episodes_to_batch": 0.0015704784752333418, "add_time_dim_to_batch_and_zero_pad": 2.5235963821316843e-05, "agent_to_module_mapping": 0.006350600397646688, "numpy_to_tensor": 0.0076485531517605935}}, "connector_pipeline_timer": 0.4691170344753246}, "learner_connector_sum_episodes_length_out": 1024.0237223224528, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 8763904, "learner_connector_sum_episodes_length_in": 1024.0237223224528, "num_module_steps_trained": 686080, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 17562122, "num_env_steps_trained": 1374840, "num_env_steps_trained_lifetime_throughput": 41143.10418924453}, "speed_2_predator": {"num_module_steps_trained_lifetime": 2190976, "mean_kl_loss": 0.013450639322400093, "vf_explained_var": -2.0265579223632812e-06, "num_module_steps_trained": 171520, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 18.906291961669922, "policy_loss": -0.18415263295173645, "entropy": 3.003066062927246, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 16.0, "total_loss": 0.612328052520752, "gradients_default_optimizer_global_norm": 0.1203869879245758, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.787401556968689}, "speed_2_prey": {"vf_explained_var": -0.0016120672225952148, "policy_loss": 0.0556403324007988, "entropy": 2.932875156402588, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 16.0, "total_loss": 2.200117826461792, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.4154835343360901, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.1270997524261475, "num_module_steps_trained": 171520, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 2190976, "mean_kl_loss": 0.0171631071716547, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 14.916967391967773}, "speed_1_prey": {"policy_loss": -0.10988178849220276, "entropy": 1.8497992753982544, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.278125047683716, "weights_seq_no": 16.0, "total_loss": 2.1682932376861572, "gradients_default_optimizer_global_norm": 0.8325672149658203, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.240048408508301, "num_module_steps_trained_lifetime": 2190976, "vf_explained_var": -0.0005158185958862305, "num_module_steps_trained": 171520, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.01673588529229164, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 33.09686279296875}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 16416, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 30.703815045903937, "done": false, "training_iteration": 16, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-23-23", "timestamp": 1745893403, "time_this_iter_s": 33.35902976989746, "time_total_s": 438.5836308002472, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd8c08c74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 438.5836308002472, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 8.728260869565219, "ram_util_percent": 41.97391304347828, "gpu_util_percent0": 0.36999999999999994, "vram_util_percent0": 0.23083444843284262}, "timing/iter_minutes": 0.5569350997606913, "timing/avg_minutes_per_iter": 0.4653077351550261, "timing/total_hours_elapsed": 0.12408206270800697}
{"timers": {"training_iteration": 23.929633586747407, "restore_env_runners": 1.2332171068967282e-05, "training_step": 23.929470963013273, "env_runner_sampling_timer": 1.1154439986079172, "learner_update_timer": 22.803956339212853, "synch_weights": 0.007475324197114697, "synch_env_connectors": 0.0023058290482512816}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 11309, "speed_1_prey_5": 9178, "speed_1_prey_2": 10850, "speed_1_predator_0": 7856, "speed_2_predator_2": 8875, "speed_1_prey_7": 1466, "speed_2_prey_5": 9471, "speed_1_prey_3": 11472, "speed_1_prey_6": 2444, "speed_2_prey_3": 11044, "speed_1_predator_2": 7648, "speed_2_prey_0": 12901, "speed_1_predator_4": 382, "speed_1_prey_8": 952, "speed_2_predator_0": 9471, "speed_2_prey_4": 10990, "speed_2_predator_3": 8861, "speed_1_prey_9": 700, "speed_1_prey_1": 11250, "speed_1_prey_0": 12891, "speed_1_predator_1": 7562, "speed_1_predator_3": 7390, "speed_2_predator_1": 8647, "speed_2_prey_1": 10763, "speed_1_prey_4": 10931, "speed_2_prey_6": 2045, "speed_2_predator_4": 709, "speed_2_predator_5": 204, "speed_2_prey_7": 1180, "speed_1_prey_11": 346, "speed_2_prey_8": 598, "speed_1_prey_10": 547, "speed_1_prey_12": 322, "speed_1_prey_14": 189, "speed_1_prey_13": 277, "speed_1_prey_15": 83, "speed_2_prey_11": 94, "speed_2_prey_10": 271, "speed_2_prey_9": 339, "speed_2_prey_14": 29, "speed_2_prey_13": 59, "speed_2_prey_16": 16, "speed_2_prey_12": 76, "speed_2_prey_15": 22}, "agent_episode_returns_mean": {"speed_1_prey_2": 10.4, "speed_1_prey_1": 8.9, "speed_1_predator_1": 0.4, "speed_2_predator_1": 0.4, "speed_1_prey_7": 2.4, "speed_2_prey_1": 6.8, "speed_1_prey_4": 7.5, "speed_1_prey_5": 4.9, "speed_1_predator_0": 0.4, "speed_2_predator_2": 0.4, "speed_2_prey_5": 6.8, "speed_1_prey_3": 7.9, "speed_1_prey_6": 4.8, "speed_2_prey_3": 4.9, "speed_1_predator_2": 0.8, "speed_2_prey_0": 13.2, "speed_1_predator_4": 0.0, "speed_1_prey_9": 2.4, "speed_1_prey_8": 0.8, "speed_1_prey_0": 11.2, "speed_2_predator_0": 1.6, "speed_1_predator_3": 0.0, "speed_2_prey_4": 3.3, "speed_2_predator_3": 0.8, "speed_2_prey_2": 7.8, "speed_2_prey_6": 2.4, "speed_2_predator_4": 0.4, "speed_2_predator_5": 0.0, "speed_2_prey_7": 4.8, "speed_2_prey_8": 0.8, "speed_1_prey_10": 3.6, "speed_1_prey_12": 1.6666666666666667, "speed_1_prey_14": 0.0, "speed_1_prey_13": 11.666666666666666, "speed_1_prey_11": 0.0, "speed_1_prey_15": 0.0, "speed_2_prey_11": 0.0, "speed_2_prey_10": 0.0, "speed_2_prey_9": 0.0, "speed_2_prey_14": 0.0, "speed_2_prey_13": 0.0, "speed_2_prey_15": 0.0, "speed_2_prey_12": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.136418522539077e-05, "add_states_from_episodes_to_batch": 7.14115056625877e-06, "add_observations_from_episodes_to_batch": 9.864747140950662e-05, "add_time_dim_to_batch_and_zero_pad": 1.306650378560696e-05, "agent_to_module_mapping": 1.0386037646751912e-05, "numpy_to_tensor": 8.110047251575132e-05}}, "connector_pipeline_timer": 0.00031532590654772283}, "num_agent_steps_sampled": {"speed_1_prey_9": 218, "speed_1_prey_1": 672, "speed_1_prey_0": 779, "speed_1_predator_1": 335, "speed_1_predator_3": 350, "speed_2_predator_1": 482, "speed_2_prey_1": 799, "speed_1_prey_4": 716, "speed_2_prey_2": 707, "speed_1_prey_5": 752, "speed_1_prey_2": 572, "speed_1_predator_0": 447, "speed_2_predator_2": 524, "speed_1_prey_7": 213, "speed_2_prey_5": 857, "speed_1_prey_3": 590, "speed_1_prey_6": 243, "speed_2_prey_3": 616, "speed_1_predator_2": 478, "speed_1_predator_4": 34, "speed_1_prey_8": 169, "speed_2_predator_0": 642, "speed_2_prey_4": 813, "speed_2_predator_3": 550, "speed_2_prey_0": 773, "speed_2_prey_6": 316, "speed_2_predator_5": 27, "speed_2_prey_7": 214, "speed_2_predator_4": 18, "speed_2_prey_8": 212, "speed_1_prey_10": 189, "speed_1_prey_11": 83, "speed_1_prey_12": 74, "speed_1_prey_14": 37, "speed_1_prey_13": 88, "speed_1_prey_15": 0, "speed_2_prey_11": 85, "speed_2_prey_10": 154, "speed_2_prey_9": 169, "speed_2_prey_14": 29, "speed_2_prey_13": 59, "speed_2_prey_16": 16, "speed_2_prey_15": 22, "speed_2_prey_12": 76}, "agent_steps": {"speed_1_prey_9": 47.48, "speed_1_prey_1": 112.2, "speed_1_prey_0": 126.26, "speed_1_predator_1": 49.91, "speed_1_predator_3": 46.68, "speed_1_prey_4": 110.13, "speed_2_prey_2": 95.23, "speed_1_prey_5": 92.02, "speed_1_prey_2": 110.83, "speed_2_predator_2": 58.99, "speed_2_predator_1": 58.49, "speed_1_prey_7": 47.53, "speed_2_prey_1": 108.22, "speed_2_prey_5": 87.9, "speed_2_prey_3": 96.84, "speed_1_predator_2": 62.19, "speed_1_predator_0": 48.63, "speed_1_predator_4": 46.64, "speed_1_prey_3": 106.88, "speed_1_prey_6": 64.96, "speed_1_prey_8": 44.92, "speed_2_predator_0": 78.38, "speed_2_prey_4": 90.96, "speed_2_predator_3": 54.09, "speed_2_prey_0": 111.49, "speed_2_prey_6": 60.78666666666667, "speed_2_predator_5": 79.875, "speed_2_predator_4": 61.8, "speed_2_prey_7": 72.0, "speed_2_prey_8": 38.93333333333333, "speed_1_prey_10": 39.800000000000004, "speed_1_prey_13": 66.58333333333333, "speed_1_prey_11": 42.208333333333336, "speed_1_prey_12": 54.0, "speed_1_prey_15": 36.888888888888886, "speed_1_prey_14": 45.416666666666664, "speed_2_prey_11": 8.5, "speed_2_prey_10": 40.54545454545455, "speed_2_prey_9": 41.38461538461539, "speed_2_prey_15": 3.0, "speed_2_prey_12": 42.0, "speed_2_prey_13": 41.0, "speed_2_prey_14": 8.0}, "num_module_steps_sampled": {"speed_2_prey": 5917, "speed_1_prey": 5395, "speed_2_predator": 2243, "speed_1_predator": 1644}, "module_episode_returns_mean": {"speed_2_predator": 3.6, "speed_2_prey": 29.4, "speed_1_prey": 36.8, "speed_1_predator": 0.8}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 7.952336027199616e-06, "tensor_to_numpy": 0.00012269348945094145, "listify_data_for_vector_env": 5.3880845378654035e-05, "un_batch_to_individual_items": 0.00015357244050668827, "get_actions": 0.0005111917868370516, "remove_single_ts_time_rank_from_batch": 1.9198005851786335e-06, "normalize_and_clip_actions": 0.00020138877117997883}}, "connector_pipeline_timer": 0.0011221490394607112}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 8, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 460.0, "num_episodes_lifetime": 148, "num_module_steps_sampled_lifetime": {"speed_2_predator": 36767, "speed_2_prey": 71207, "speed_1_prey": 73898, "speed_1_predator": 30838}, "env_step_timer": 0.002596858973723885, "episode_return_min": 10.0, "episode_length": 81.9134269267648, "rlmodule_inference_timer": 0.002964992096122846, "episode_return_mean": 106.8, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": 17442, "episode_len_max": 478, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 78.6315032919824, "env_to_module_sum_episodes_length_in": 78.6315032919824, "sample": 0.9467143576403377, "episode_len_mean": 146.88, "episode_len_min": 67, "episode_duration_sec_mean": 1.1752743900100222, "time_between_sampling": 22.340544239834177, "num_env_steps_sampled_lifetime_throughput": 27.502405801227127}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 1.5650571584701538, "policy_loss": 0.03758950158953667, "entropy": 1.9962009191513062, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 17.0, "total_loss": 0.2888830006122589, "gradients_default_optimizer_global_norm": 0.15989950299263, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.2380952388048172, "num_module_steps_trained_lifetime": 2371840, "mean_kl_loss": 0.017380475997924805, "vf_explained_var": -2.7418136596679688e-06, "num_module_steps_trained": 180864, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16648643744664668, "add_states_from_episodes_to_batch": 8.235370505251797e-06, "general_advantage_estimation": 0.1527916740475582, "add_columns_from_episodes_to_train_batch": 0.09660204821650838, "add_one_ts_to_episodes_and_truncate": 0.037170219466998895, "add_observations_from_episodes_to_batch": 0.001570070535566439, "add_time_dim_to_batch_and_zero_pad": 2.5231888390955994e-05, "agent_to_module_mapping": 0.006349929831590108, "numpy_to_tensor": 0.007646968127913217}}, "connector_pipeline_timer": 0.46893936199545067}, "learner_connector_sum_episodes_length_out": 1024.0266366686114, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 9487360, "learner_connector_sum_episodes_length_in": 1024.0266366686114, "num_module_steps_trained": 723456, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 19011860, "num_env_steps_trained": 1449738, "num_env_steps_trained_lifetime_throughput": 38860.86536012541}, "speed_2_predator": {"num_module_steps_trained_lifetime": 2371840, "mean_kl_loss": 0.01326449029147625, "vf_explained_var": 7.152557373046875e-07, "num_module_steps_trained": 180864, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 15.187525749206543, "policy_loss": -0.2595532238483429, "entropy": 3.0096259117126465, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 17.0, "total_loss": 0.9590777158737183, "gradients_default_optimizer_global_norm": 0.12773582339286804, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.2096774578094482}, "speed_2_prey": {"vf_explained_var": -7.987022399902344e-06, "policy_loss": -0.09262831509113312, "entropy": 2.8949122428894043, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 17.0, "total_loss": 2.345794916152954, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.3649969696998596, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.4193592071533203, "num_module_steps_trained": 180864, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 2371840, "mean_kl_loss": 0.018828701227903366, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 29.601402282714844}, "speed_1_prey": {"policy_loss": -0.23034003376960754, "entropy": 1.8329066038131714, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.278125047683716, "weights_seq_no": 17.0, "total_loss": 2.0129382610321045, "gradients_default_optimizer_global_norm": 1.4526827335357666, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.2047464847564697, "num_module_steps_trained_lifetime": 2371840, "vf_explained_var": 0.0010567307472229004, "num_module_steps_trained": 180864, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.016913898289203644, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 34.632266998291016}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 17442, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 27.502405801227127, "done": false, "training_iteration": 17, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-24-00", "timestamp": 1745893440, "time_this_iter_s": 37.25203609466553, "time_total_s": 475.8356668949127, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd7ad14a660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 475.8356668949127, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 8.68235294117647, "ram_util_percent": 42.21764705882353, "gpu_util_percent0": 0.3654901960784313, "vram_util_percent0": 0.2289257992726483}, "timing/iter_minutes": 0.6217625498771667, "timing/avg_minutes_per_iter": 0.47451095955044614, "timing/total_hours_elapsed": 0.1344447718726264}
{"timers": {"training_iteration": 24.04927613852993, "restore_env_runners": 1.2311029355434392e-05, "training_step": 24.049111866863143, "env_runner_sampling_timer": 1.117480393121839, "learner_update_timer": 22.921555723600726, "synch_weights": 0.007470284445145509, "synch_env_connectors": 0.0023048443177674854}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 12123, "speed_1_prey_5": 9743, "speed_1_prey_2": 11591, "speed_1_predator_0": 8476, "speed_2_predator_2": 9186, "speed_1_prey_7": 1521, "speed_2_prey_5": 10037, "speed_1_prey_3": 12094, "speed_1_prey_6": 2732, "speed_2_prey_3": 11646, "speed_1_predator_2": 8061, "speed_2_prey_0": 13730, "speed_1_predator_4": 439, "speed_1_prey_8": 1026, "speed_2_predator_0": 10013, "speed_2_prey_4": 11713, "speed_2_predator_3": 9341, "speed_1_prey_9": 712, "speed_1_prey_1": 11995, "speed_1_prey_0": 13785, "speed_1_predator_1": 7843, "speed_1_predator_3": 7776, "speed_2_predator_1": 9138, "speed_2_prey_1": 11614, "speed_1_prey_4": 11580, "speed_2_prey_6": 2404, "speed_2_predator_4": 816, "speed_2_predator_5": 333, "speed_2_prey_7": 1366, "speed_1_prey_11": 382, "speed_2_prey_8": 724, "speed_1_prey_10": 555, "speed_1_prey_12": 322, "speed_1_prey_14": 189, "speed_1_prey_13": 406, "speed_1_prey_15": 83, "speed_2_prey_11": 205, "speed_2_prey_10": 400, "speed_2_prey_9": 434, "speed_2_prey_14": 141, "speed_2_prey_13": 137, "speed_2_prey_16": 65, "speed_2_prey_12": 205, "speed_2_prey_15": 151}, "agent_episode_returns_mean": {"speed_1_prey_2": 9.5, "speed_1_prey_1": 10.0, "speed_1_predator_1": 0.4, "speed_2_predator_1": 0.5, "speed_1_prey_7": 2.4, "speed_2_prey_1": 9.6, "speed_1_prey_4": 7.2, "speed_1_prey_5": 5.0, "speed_1_predator_0": 1.2, "speed_2_predator_2": 0.1, "speed_2_prey_5": 9.3, "speed_1_prey_3": 6.6, "speed_1_prey_6": 4.8, "speed_2_prey_3": 5.9, "speed_1_predator_2": 1.2, "speed_2_prey_0": 12.8, "speed_1_predator_4": 0.0, "speed_1_prey_9": 1.9, "speed_1_prey_8": 0.8, "speed_1_prey_0": 8.2, "speed_2_predator_0": 1.3, "speed_1_predator_3": 0.4, "speed_2_prey_4": 5.2, "speed_2_predator_3": 0.8, "speed_2_prey_2": 8.4, "speed_2_prey_6": 2.9, "speed_2_predator_4": 0.8, "speed_2_predator_5": 0.0, "speed_2_prey_7": 3.2, "speed_2_prey_8": 1.6, "speed_1_prey_10": 3.2, "speed_1_prey_12": 1.739130434782609, "speed_1_prey_14": 0.0, "speed_1_prey_13": 10.666666666666664, "speed_1_prey_11": 0.0, "speed_1_prey_15": 0.0, "speed_2_prey_11": 0.0, "speed_2_prey_10": 0.0, "speed_2_prey_9": 0.0, "speed_2_prey_14": 0.0, "speed_2_prey_13": 0.0, "speed_2_prey_15": 0.0, "speed_2_prey_12": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.149369281987775e-05, "add_states_from_episodes_to_batch": 7.138347944735767e-06, "add_observations_from_episodes_to_batch": 9.908810299290065e-05, "add_time_dim_to_batch_and_zero_pad": 1.3062931219282774e-05, "agent_to_module_mapping": 1.0423973123609702e-05, "numpy_to_tensor": 8.118993257941533e-05}}, "connector_pipeline_timer": 0.0003159325826125663}, "num_agent_steps_sampled": {"speed_1_prey_9": 12, "speed_1_prey_1": 745, "speed_1_prey_0": 894, "speed_1_predator_1": 281, "speed_1_predator_3": 386, "speed_2_predator_1": 491, "speed_2_prey_1": 851, "speed_1_prey_4": 649, "speed_2_prey_2": 814, "speed_1_prey_5": 565, "speed_1_prey_2": 741, "speed_1_predator_0": 620, "speed_2_predator_2": 311, "speed_1_prey_7": 55, "speed_2_prey_5": 566, "speed_1_prey_3": 622, "speed_1_prey_6": 288, "speed_2_prey_3": 602, "speed_1_predator_2": 413, "speed_1_predator_4": 57, "speed_1_prey_8": 74, "speed_2_predator_0": 542, "speed_2_prey_4": 723, "speed_2_predator_3": 480, "speed_2_prey_0": 829, "speed_2_prey_6": 359, "speed_2_predator_5": 129, "speed_2_prey_7": 186, "speed_2_predator_4": 107, "speed_2_prey_8": 126, "speed_1_prey_10": 8, "speed_1_prey_11": 36, "speed_1_prey_12": 0, "speed_1_prey_14": 0, "speed_1_prey_13": 129, "speed_1_prey_15": 0, "speed_2_prey_11": 111, "speed_2_prey_10": 129, "speed_2_prey_9": 95, "speed_2_prey_14": 112, "speed_2_prey_13": 78, "speed_2_prey_16": 49, "speed_2_prey_15": 129, "speed_2_prey_12": 129}, "agent_steps": {"speed_1_prey_9": 49.83, "speed_1_prey_1": 108.25, "speed_1_prey_0": 124.21, "speed_1_predator_1": 49.19, "speed_1_predator_3": 47.37, "speed_1_prey_4": 108.45, "speed_2_prey_2": 92.39, "speed_1_prey_5": 94.66, "speed_1_prey_2": 108.78, "speed_2_predator_2": 53.87, "speed_2_predator_1": 60.29, "speed_1_prey_7": 45.56, "speed_2_prey_1": 114.98, "speed_2_prey_5": 100.04, "speed_2_prey_3": 100.14, "speed_1_predator_2": 63.61, "speed_1_predator_0": 57.57, "speed_1_predator_4": 47.96, "speed_1_prey_3": 97.1, "speed_1_prey_6": 67.97, "speed_1_prey_8": 47.06, "speed_2_predator_0": 77.11, "speed_2_prey_4": 99.99, "speed_2_predator_3": 52.88, "speed_2_prey_0": 111.64, "speed_2_prey_6": 63.46, "speed_2_predator_5": 77.44444444444444, "speed_2_predator_4": 74.47999999999999, "speed_2_prey_7": 73.77, "speed_2_prey_8": 42.86, "speed_1_prey_10": 42.65333333333333, "speed_1_prey_13": 65.66666666666667, "speed_1_prey_11": 42.73333333333333, "speed_1_prey_12": 53.08695652173912, "speed_1_prey_15": 37.54545454545455, "speed_1_prey_14": 46.26666666666666, "speed_2_prey_11": 10.615384615384615, "speed_2_prey_10": 42.06666666666667, "speed_2_prey_9": 43.388888888888886, "speed_2_prey_15": 3.0, "speed_2_prey_12": 42.0, "speed_2_prey_13": 41.0, "speed_2_prey_14": 8.0}, "num_module_steps_sampled": {"speed_2_prey": 5888, "speed_1_prey": 4818, "speed_2_predator": 2060, "speed_1_predator": 1757}, "module_episode_returns_mean": {"speed_2_predator": 3.1, "speed_2_prey": 31.8, "speed_1_prey": 33.0, "speed_1_predator": 1.6}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 7.939032910872385e-06, "tensor_to_numpy": 0.00012152093829068854, "listify_data_for_vector_env": 5.390834153478125e-05, "un_batch_to_individual_items": 0.00015360278223640946, "get_actions": 0.0005092317602739142, "remove_single_ts_time_rank_from_batch": 1.9207369336296154e-06, "normalize_and_clip_actions": 0.0002004783861931386}}, "connector_pipeline_timer": 0.0011179210286322097}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 7, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 460.0, "num_episodes_lifetime": 155, "num_module_steps_sampled_lifetime": {"speed_2_predator": 38827, "speed_2_prey": 77095, "speed_1_prey": 78716, "speed_1_predator": 32595}, "env_step_timer": 0.0026111442676179687, "episode_return_min": 20.0, "episode_length": 82.23395788385741, "rlmodule_inference_timer": 0.0029514844204328074, "episode_return_mean": 112.0, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": 18469, "episode_len_max": 478, "num_env_steps_sampled": 1027, "env_to_module_sum_episodes_length_out": 79.94890794828405, "env_to_module_sum_episodes_length_in": 79.94890794828405, "sample": 0.9471024693525195, "episode_len_mean": 142.13, "episode_len_min": 65, "episode_duration_sec_mean": 1.1433907737600613, "time_between_sampling": 22.367752646855784, "num_env_steps_sampled_lifetime_throughput": 28.555996094459143}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 5.777593612670898, "policy_loss": -0.09545088559389114, "entropy": 2.018707036972046, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 18.0, "total_loss": 0.9672720432281494, "gradients_default_optimizer_global_norm": 0.22077816724777222, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.048387050628662, "num_module_steps_trained_lifetime": 2551424, "mean_kl_loss": 0.018878445029258728, "vf_explained_var": -5.960464477539062e-07, "num_module_steps_trained": 179584, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.1664721677639063, "add_states_from_episodes_to_batch": 8.233395463738817e-06, "general_advantage_estimation": 0.15266338794461523, "add_columns_from_episodes_to_train_batch": 0.09660343478253382, "add_one_ts_to_episodes_and_truncate": 0.0371403436056893, "add_observations_from_episodes_to_batch": 0.00156963421674534, "add_time_dim_to_batch_and_zero_pad": 2.5227891372813127e-05, "agent_to_module_mapping": 0.006349333874414916, "numpy_to_tensor": 0.007645712059227633}}, "connector_pipeline_timer": 0.4687658367965266}, "learner_connector_sum_episodes_length_out": 1024.0297903556148, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 10205696, "learner_connector_sum_episodes_length_in": 1024.0297903556148, "num_module_steps_trained": 718336, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 20452741, "num_env_steps_trained": 1440881, "num_env_steps_trained_lifetime_throughput": 40064.11121537908}, "speed_2_predator": {"num_module_steps_trained_lifetime": 2551424, "mean_kl_loss": 0.0118060652166605, "vf_explained_var": -1.3113021850585938e-06, "num_module_steps_trained": 179584, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 25.09856605529785, "policy_loss": -0.16255921125411987, "entropy": 3.004990816116333, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 18.0, "total_loss": 0.805409848690033, "gradients_default_optimizer_global_norm": 0.11902123689651489, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.9599999785423279}, "speed_2_prey": {"vf_explained_var": 0.00013595819473266602, "policy_loss": -0.0748848244547844, "entropy": 2.908778667449951, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 18.0, "total_loss": 2.0064809322357178, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.7249976396560669, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.063493013381958, "num_module_steps_trained": 179584, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 2551424, "mean_kl_loss": 0.0176521185785532, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 17.94754409790039}, "speed_1_prey": {"policy_loss": -0.20251242816448212, "entropy": 1.8152869939804077, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.278125047683716, "weights_seq_no": 18.0, "total_loss": 2.11452054977417, "gradients_default_optimizer_global_norm": 0.7167035937309265, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.2842659950256348, "num_module_steps_trained_lifetime": 2551424, "vf_explained_var": 0.0011853575706481934, "num_module_steps_trained": 179584, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.01438338402658701, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 41.98762130737305}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 18469, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 28.555996094459143, "done": false, "training_iteration": 18, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-24-37", "timestamp": 1745893477, "time_this_iter_s": 36.31025242805481, "time_total_s": 512.1459193229675, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd7ad17d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 512.1459193229675, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 8.84, "ram_util_percent": 42.434, "gpu_util_percent0": 0.35480000000000006, "vram_util_percent0": 0.22784562774792377}, "timing/iter_minutes": 0.6061997294425965, "timing/avg_minutes_per_iter": 0.4818270023222323, "timing/total_hours_elapsed": 0.14454810069666968}
{"timers": {"training_iteration": 24.13971218195463, "restore_env_runners": 1.2316269059674477e-05, "training_step": 24.13954531172451, "env_runner_sampling_timer": 1.1206305827106198, "learner_update_timer": 23.00883752880472, "synch_weights": 0.00745888381069049, "synch_env_connectors": 0.002303319194591317}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 12763, "speed_1_prey_5": 10397, "speed_1_prey_2": 12423, "speed_1_predator_0": 8819, "speed_2_predator_2": 9705, "speed_1_prey_7": 1754, "speed_2_prey_5": 10672, "speed_1_prey_3": 12724, "speed_1_prey_6": 3018, "speed_2_prey_3": 12126, "speed_1_predator_2": 8543, "speed_2_prey_0": 14491, "speed_1_predator_4": 439, "speed_1_prey_8": 1207, "speed_2_predator_0": 10657, "speed_2_prey_4": 12299, "speed_2_predator_3": 9878, "speed_1_prey_9": 809, "speed_1_prey_1": 12793, "speed_1_prey_0": 14710, "speed_1_predator_1": 8102, "speed_1_predator_3": 8218, "speed_2_predator_1": 9665, "speed_2_prey_1": 12146, "speed_1_prey_4": 12284, "speed_2_prey_6": 2587, "speed_2_predator_4": 920, "speed_2_predator_5": 374, "speed_2_prey_7": 1528, "speed_1_prey_11": 434, "speed_2_prey_8": 750, "speed_1_prey_10": 638, "speed_1_prey_12": 356, "speed_1_prey_14": 189, "speed_1_prey_13": 438, "speed_1_prey_15": 83, "speed_2_prey_11": 244, "speed_2_prey_10": 402, "speed_2_prey_9": 475, "speed_2_prey_14": 141, "speed_2_prey_13": 137, "speed_2_prey_16": 65, "speed_2_prey_12": 257, "speed_2_prey_15": 202}, "agent_episode_returns_mean": {"speed_1_prey_2": 11.0, "speed_1_prey_1": 10.1, "speed_1_predator_1": 0.1, "speed_2_predator_1": 1.7, "speed_1_prey_7": 3.2, "speed_2_prey_1": 8.5, "speed_1_prey_4": 8.3, "speed_1_prey_5": 6.9, "speed_1_predator_0": 1.2, "speed_2_predator_2": 1.2, "speed_2_prey_5": 9.3, "speed_1_prey_3": 9.8, "speed_1_prey_6": 4.1, "speed_2_prey_3": 6.0, "speed_1_predator_2": 0.6, "speed_2_prey_0": 13.2, "speed_1_predator_4": 0.0, "speed_1_prey_9": 2.8, "speed_1_prey_8": 3.6, "speed_1_prey_0": 9.5, "speed_2_predator_0": 2.8, "speed_1_predator_3": 0.8, "speed_2_prey_4": 6.2, "speed_2_predator_3": 0.4, "speed_2_prey_2": 6.7, "speed_2_prey_6": 3.2, "speed_2_predator_4": 1.6, "speed_2_predator_5": 0.47619047619047616, "speed_2_prey_7": 3.0, "speed_2_prey_8": 1.8, "speed_1_prey_10": 3.6, "speed_1_prey_12": 2.0000000000000004, "speed_1_prey_14": 0.0, "speed_1_prey_13": 9.5, "speed_1_prey_11": 0.4, "speed_1_prey_15": 0.0, "speed_2_prey_11": 0.0, "speed_2_prey_10": 0.0, "speed_2_prey_9": 0.0, "speed_2_prey_14": 0.0, "speed_2_prey_13": 0.0, "speed_2_prey_15": 0.0, "speed_2_prey_12": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.182308955611988e-05, "add_states_from_episodes_to_batch": 7.148613515803914e-06, "add_observations_from_episodes_to_batch": 9.971399025893193e-05, "add_time_dim_to_batch_and_zero_pad": 1.3139692131005956e-05, "agent_to_module_mapping": 1.0494582991277264e-05, "numpy_to_tensor": 8.173230736506527e-05}}, "connector_pipeline_timer": 0.0003176471865911331}, "num_agent_steps_sampled": {"speed_1_prey_9": 97, "speed_1_prey_1": 798, "speed_1_prey_0": 925, "speed_1_predator_1": 259, "speed_1_predator_3": 442, "speed_2_predator_1": 527, "speed_2_prey_1": 532, "speed_1_prey_4": 704, "speed_2_prey_2": 640, "speed_1_prey_5": 654, "speed_1_prey_2": 832, "speed_1_predator_0": 343, "speed_2_predator_2": 519, "speed_1_prey_7": 233, "speed_2_prey_5": 635, "speed_1_prey_3": 630, "speed_1_prey_6": 286, "speed_2_prey_3": 480, "speed_1_predator_2": 482, "speed_1_predator_4": 0, "speed_1_prey_8": 181, "speed_2_predator_0": 644, "speed_2_prey_4": 586, "speed_2_predator_3": 537, "speed_2_prey_0": 761, "speed_2_prey_6": 183, "speed_2_predator_5": 41, "speed_2_prey_7": 162, "speed_2_predator_4": 104, "speed_2_prey_8": 26, "speed_1_prey_10": 83, "speed_1_prey_11": 52, "speed_1_prey_12": 34, "speed_1_prey_14": 0, "speed_1_prey_13": 32, "speed_1_prey_15": 0, "speed_2_prey_11": 39, "speed_2_prey_10": 2, "speed_2_prey_9": 41, "speed_2_prey_14": 0, "speed_2_prey_13": 0, "speed_2_prey_16": 0, "speed_2_prey_15": 51, "speed_2_prey_12": 52}, "agent_steps": {"speed_1_prey_9": 53.2, "speed_1_prey_1": 118.36, "speed_1_prey_0": 129.32, "speed_1_predator_1": 46.11, "speed_1_predator_3": 54.13, "speed_1_prey_4": 120.32, "speed_2_prey_2": 103.45, "speed_1_prey_5": 112.15, "speed_1_prey_2": 119.68, "speed_2_predator_2": 63.95, "speed_2_predator_1": 71.86, "speed_1_prey_7": 62.18666666666667, "speed_2_prey_1": 114.0, "speed_2_prey_5": 100.58, "speed_2_prey_3": 98.46, "speed_1_predator_2": 64.66, "speed_1_predator_0": 61.05, "speed_1_predator_4": 49.68, "speed_1_prey_3": 109.71, "speed_1_prey_6": 81.3, "speed_1_prey_8": 57.44, "speed_2_predator_0": 78.89, "speed_2_prey_4": 115.3, "speed_2_predator_3": 51.33, "speed_2_prey_0": 121.53, "speed_2_prey_6": 67.09, "speed_2_predator_5": 78.9047619047619, "speed_2_predator_4": 80.08, "speed_2_prey_7": 67.1, "speed_2_prey_8": 41.24, "speed_1_prey_10": 44.74666666666667, "speed_1_prey_13": 70.7, "speed_1_prey_11": 46.86, "speed_1_prey_12": 51.22, "speed_1_prey_15": 38.0, "speed_1_prey_14": 46.26315789473684, "speed_2_prey_11": 11.9375, "speed_2_prey_10": 42.94736842105263, "speed_2_prey_9": 44.52173913043478, "speed_2_prey_15": 3.0, "speed_2_prey_12": 42.0, "speed_2_prey_13": 41.0, "speed_2_prey_14": 8.0}, "num_module_steps_sampled": {"speed_2_prey": 4190, "speed_1_prey": 5541, "speed_2_predator": 2372, "speed_1_predator": 1526}, "module_episode_returns_mean": {"speed_2_predator": 7.3, "speed_2_prey": 32.0, "speed_1_prey": 42.4, "speed_1_predator": 1.4}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 7.952729849580521e-06, "tensor_to_numpy": 0.00012067922083380292, "listify_data_for_vector_env": 5.396053859828026e-05, "un_batch_to_individual_items": 0.00015384678544878817, "get_actions": 0.0005086667712031225, "remove_single_ts_time_rank_from_batch": 1.9287385275649815e-06, "normalize_and_clip_actions": 0.00019974514178433192}}, "connector_pipeline_timer": 0.0011160873312096482}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 5, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 660.0, "num_episodes_lifetime": 160, "num_module_steps_sampled_lifetime": {"speed_2_predator": 41199, "speed_2_prey": 81285, "speed_1_prey": 84257, "speed_1_predator": 34121}, "env_step_timer": 0.0026258807870874284, "episode_return_min": 20.0, "episode_length": 82.60508743876366, "rlmodule_inference_timer": 0.0029454523026808195, "episode_return_mean": 129.6, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": 19494, "episode_len_max": 512, "num_env_steps_sampled": 1025, "env_to_module_sum_episodes_length_out": 81.3519308863756, "env_to_module_sum_episodes_length_in": 81.3519308863756, "sample": 0.947577865130314, "episode_len_mean": 152.35, "episode_len_min": 65, "episode_duration_sec_mean": 1.2346909356200286, "time_between_sampling": 22.398522792814934, "num_env_steps_sampled_lifetime_throughput": 30.909323950644783}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 7.296454551664056e-10, "policy_loss": -0.05586201325058937, "entropy": 1.9837024211883545, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 19.0, "total_loss": -0.04906133562326431, "gradients_default_optimizer_global_norm": 0.17211908102035522, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 7.296454551664056e-10, "num_module_steps_trained_lifetime": 2720000, "mean_kl_loss": 0.008955623023211956, "vf_explained_var": 0.9998877644538879, "num_module_steps_trained": 168576, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16646013060127607, "add_states_from_episodes_to_batch": 8.231300986025743e-06, "general_advantage_estimation": 0.1525351563518264, "add_columns_from_episodes_to_train_batch": 0.09660537218981707, "add_one_ts_to_episodes_and_truncate": 0.037108994662459205, "add_observations_from_episodes_to_batch": 0.0015691669100471027, "add_time_dim_to_batch_and_zero_pad": 2.522373190622073e-05, "agent_to_module_mapping": 0.0063487430115000704, "numpy_to_tensor": 0.007644767631502961}}, "connector_pipeline_timer": 0.4685939553109816}, "learner_connector_sum_episodes_length_out": 1024.0329783052111, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 10880000, "learner_connector_sum_episodes_length_in": 1024.0329783052111, "num_module_steps_trained": 674304, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 21802666, "num_env_steps_trained": 1349925, "num_env_steps_trained_lifetime_throughput": 40707.58715440879}, "speed_2_predator": {"num_module_steps_trained_lifetime": 2720000, "mean_kl_loss": 0.01507852878421545, "vf_explained_var": -8.344650268554688e-07, "num_module_steps_trained": 168576, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 14.634428977966309, "policy_loss": -0.21945008635520935, "entropy": 3.017205238342285, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 19.0, "total_loss": 1.1022032499313354, "gradients_default_optimizer_global_norm": 0.38454073667526245, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.311475396156311}, "speed_2_prey": {"vf_explained_var": -6.9141387939453125e-06, "policy_loss": -0.25346195697784424, "entropy": 2.850992202758789, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 19.0, "total_loss": 1.9244556427001953, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.4363589286804199, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.1600000858306885, "num_module_steps_trained": 168576, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 2720000, "mean_kl_loss": 0.017696024850010872, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 47.437110900878906}, "speed_1_prey": {"policy_loss": -0.2257491648197174, "entropy": 1.7804248332977295, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.278125047683716, "weights_seq_no": 19.0, "total_loss": 3.6540136337280273, "gradients_default_optimizer_global_norm": 1.174368143081665, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 3.840031147003174, "num_module_steps_trained_lifetime": 2720000, "vf_explained_var": -0.00012004375457763672, "num_module_steps_trained": 168576, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.017440592870116234, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 57.363643646240234}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 19494, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 30.909323950644783, "done": false, "training_iteration": 19, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-25-10", "timestamp": 1745893510, "time_this_iter_s": 33.10162162780762, "time_total_s": 545.2475409507751, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd7ad17c400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 545.2475409507751, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.919565217391305, "ram_util_percent": 42.7804347826087, "gpu_util_percent0": 0.36347826086956525, "vram_util_percent0": 0.22721303002626672}, "timing/iter_minutes": 0.5526963035265605, "timing/avg_minutes_per_iter": 0.4855569655435127, "timing/total_hours_elapsed": 0.1537597057554457}
{"timers": {"training_iteration": 24.327958852505084, "restore_env_runners": 1.2309836366976534e-05, "training_step": 24.327790282677267, "env_runner_sampling_timer": 1.1221868995735111, "learner_update_timer": 23.19551643653667, "synch_weights": 0.00745621131258623, "synch_env_connectors": 0.002304092232646759}, "env_runners": {"num_agent_steps_sampled_lifetime": {"speed_2_prey_2": 13465, "speed_1_prey_5": 11173, "speed_1_prey_2": 13149, "speed_1_predator_0": 9294, "speed_2_predator_2": 10188, "speed_1_prey_7": 2114, "speed_2_prey_5": 11272, "speed_1_prey_3": 13542, "speed_1_prey_6": 3446, "speed_2_prey_3": 12823, "speed_1_predator_2": 8963, "speed_2_prey_0": 15232, "speed_1_predator_4": 439, "speed_1_prey_8": 1447, "speed_2_predator_0": 11266, "speed_2_prey_4": 12982, "speed_2_predator_3": 10207, "speed_1_prey_9": 1021, "speed_1_prey_1": 13738, "speed_1_prey_0": 15596, "speed_1_predator_1": 8546, "speed_1_predator_3": 8629, "speed_2_predator_1": 10044, "speed_2_prey_1": 12838, "speed_1_prey_4": 13210, "speed_2_prey_6": 2858, "speed_2_predator_4": 1032, "speed_2_predator_5": 374, "speed_2_prey_7": 1710, "speed_1_prey_11": 616, "speed_2_prey_8": 871, "speed_1_prey_10": 841, "speed_1_prey_12": 528, "speed_1_prey_14": 314, "speed_1_prey_13": 584, "speed_1_prey_15": 159, "speed_2_prey_11": 261, "speed_2_prey_10": 455, "speed_2_prey_9": 550, "speed_2_prey_14": 141, "speed_2_prey_13": 137, "speed_2_prey_16": 65, "speed_2_prey_12": 265, "speed_2_prey_15": 202, "speed_1_prey_17": 31, "speed_1_prey_16": 67}, "agent_episode_returns_mean": {"speed_1_prey_2": 12.4, "speed_1_prey_1": 11.5, "speed_1_predator_1": 0.0, "speed_2_predator_1": 2.0, "speed_1_prey_7": 3.2, "speed_2_prey_1": 8.4, "speed_1_prey_4": 8.9, "speed_1_prey_5": 6.8, "speed_1_predator_0": 0.9, "speed_2_predator_2": 1.2, "speed_2_prey_5": 7.3, "speed_1_prey_3": 12.2, "speed_1_prey_6": 4.4, "speed_2_prey_3": 4.8, "speed_1_predator_2": 0.4, "speed_2_prey_0": 12.8, "speed_1_predator_4": 0.0, "speed_1_prey_9": 3.6, "speed_1_prey_8": 4.3, "speed_1_prey_0": 11.7, "speed_2_predator_0": 2.4, "speed_1_predator_3": 0.8, "speed_2_prey_4": 6.2, "speed_2_predator_3": 0.4, "speed_2_prey_2": 5.1, "speed_2_prey_6": 3.2, "speed_2_predator_4": 2.0, "speed_2_predator_5": 0.8333333333333334, "speed_2_prey_7": 2.4, "speed_2_prey_8": 1.6, "speed_1_prey_10": 4.0, "speed_1_prey_12": 2.0, "speed_1_prey_14": 0.0, "speed_1_prey_13": 7.2, "speed_1_prey_11": 0.8, "speed_1_prey_15": 0.0, "speed_2_prey_11": 0.0, "speed_2_prey_10": 0.0, "speed_2_prey_9": 0.0, "speed_2_prey_14": 0.0, "speed_2_prey_13": 0.0, "speed_2_prey_15": 0.0, "speed_2_prey_12": 0.0, "speed_1_prey_16": 0.0}, "connector_pipeline_timer": 0.0005534144999046475, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.195823303507544e-05, "add_states_from_episodes_to_batch": 7.131955579988606e-06, "add_observations_from_episodes_to_batch": 0.00010004768194031278, "add_time_dim_to_batch_and_zero_pad": 1.312440228827766e-05, "agent_to_module_mapping": 1.0532764904429961e-05, "numpy_to_tensor": 8.172594375526267e-05}}, "connector_pipeline_timer": 0.00031797371815282414}, "num_agent_steps_sampled": {"speed_1_prey_9": 212, "speed_1_prey_1": 945, "speed_1_prey_0": 886, "speed_1_predator_1": 444, "speed_1_predator_3": 411, "speed_2_predator_1": 379, "speed_2_prey_1": 692, "speed_1_prey_4": 926, "speed_2_prey_2": 702, "speed_1_prey_5": 776, "speed_1_prey_2": 726, "speed_1_predator_0": 475, "speed_2_predator_2": 483, "speed_1_prey_7": 360, "speed_2_prey_5": 600, "speed_1_prey_3": 818, "speed_1_prey_6": 428, "speed_2_prey_3": 697, "speed_1_predator_2": 420, "speed_1_predator_4": 0, "speed_1_prey_8": 240, "speed_2_predator_0": 609, "speed_2_prey_4": 683, "speed_2_predator_3": 329, "speed_2_prey_0": 741, "speed_2_prey_6": 271, "speed_2_predator_5": 0, "speed_2_prey_7": 182, "speed_2_predator_4": 112, "speed_2_prey_8": 121, "speed_1_prey_10": 203, "speed_1_prey_11": 182, "speed_1_prey_12": 172, "speed_1_prey_14": 125, "speed_1_prey_13": 146, "speed_1_prey_15": 76, "speed_2_prey_11": 17, "speed_2_prey_10": 53, "speed_2_prey_9": 75, "speed_2_prey_14": 0, "speed_2_prey_13": 0, "speed_2_prey_16": 0, "speed_2_prey_15": 0, "speed_2_prey_12": 8, "speed_1_prey_16": 67, "speed_1_prey_17": 31}, "agent_steps": {"speed_1_prey_9": 58.17333333333333, "speed_1_prey_1": 123.07, "speed_1_prey_0": 131.52, "speed_1_predator_1": 46.56, "speed_1_predator_3": 59.18, "speed_1_prey_4": 124.02, "speed_2_prey_2": 97.69, "speed_1_prey_5": 112.08, "speed_1_prey_2": 122.54, "speed_2_predator_2": 70.63, "speed_2_predator_1": 72.62, "speed_1_prey_7": 66.25333333333333, "speed_2_prey_1": 98.23, "speed_2_prey_5": 89.23, "speed_2_prey_3": 81.5, "speed_1_predator_2": 61.73, "speed_1_predator_0": 60.6, "speed_1_predator_4": 49.76, "speed_1_prey_3": 116.84, "speed_1_prey_6": 80.53, "speed_1_prey_8": 55.29, "speed_2_predator_0": 76.08, "speed_2_prey_4": 103.57, "speed_2_predator_3": 55.61, "speed_2_prey_0": 111.63, "speed_2_prey_6": 65.97, "speed_2_predator_5": 80.0, "speed_2_predator_4": 83.64, "speed_2_prey_7": 58.76, "speed_2_prey_8": 39.8, "speed_1_prey_10": 46.68, "speed_1_prey_13": 69.04, "speed_1_prey_11": 44.22666666666666, "speed_1_prey_12": 47.1, "speed_1_prey_15": 36.125, "speed_1_prey_14": 43.08, "speed_2_prey_11": 12.842105263157896, "speed_2_prey_10": 41.833333333333336, "speed_2_prey_9": 47.3, "speed_2_prey_15": 3.0, "speed_2_prey_12": 42.0, "speed_2_prey_13": 41.0, "speed_2_prey_14": 8.0, "speed_1_prey_16": 3.0}, "num_module_steps_sampled": {"speed_2_prey": 4842, "speed_1_prey": 7319, "speed_2_predator": 1912, "speed_1_predator": 1750}, "module_episode_returns_mean": {"speed_2_predator": 7.2, "speed_2_prey": 26.4, "speed_1_prey": 40.0, "speed_1_predator": 0.9}, "module_to_env_connector": {"timers": {"connectors": {"module_to_agent_unmapping": 7.9526606617997e-06, "tensor_to_numpy": 0.00011947780166196967, "listify_data_for_vector_env": 5.407354576680864e-05, "un_batch_to_individual_items": 0.00015408165998171623, "get_actions": 0.0005062176412454659, "remove_single_ts_time_rank_from_batch": 1.928228443494619e-06, "normalize_and_clip_actions": 0.0001991669824844445}}, "connector_pipeline_timer": 0.0011119556060280454}, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0001339227501375717, "add_time_dim_to_batch_and_zero_pad": 2.079074988614593e-05, "agent_to_module_mapping": 1.3952000131212117e-05, "numpy_to_tensor": 0.0001464442498217977, "batch_individual_items": 0.00010349824992772483, "add_states_from_episodes_to_batch": 7.815999992999423e-06}}, "num_episodes": 8, "env_reset_timer": 0.0015773890000900792, "episode_return_max": 660.0, "num_episodes_lifetime": 168, "num_module_steps_sampled_lifetime": {"speed_2_predator": 43111, "speed_2_prey": 86127, "speed_1_prey": 91576, "speed_1_predator": 35871}, "env_step_timer": 0.002642835353635843, "episode_return_min": 10.0, "episode_length": 82.98289809197975, "rlmodule_inference_timer": 0.0029306254158516995, "episode_return_mean": 129.2, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": 20520, "episode_len_max": 512, "num_env_steps_sampled": 1026, "env_to_module_sum_episodes_length_out": 82.04516855313469, "env_to_module_sum_episodes_length_in": 82.04516855313469, "sample": 0.9480913969103011, "episode_len_mean": 146.81, "episode_len_min": 52, "episode_duration_sec_mean": 1.2007918361899965, "time_between_sampling": 22.431545684643808, "num_env_steps_sampled_lifetime_throughput": 23.843225614121216}, "learners": {"speed_1_predator": {"num_trainable_parameters": 66250.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 4.17461221147164e-09, "policy_loss": -0.05800817906856537, "entropy": 1.9767709970474243, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7593750357627869, "weights_seq_no": 20.0, "total_loss": -0.04990636929869652, "gradients_default_optimizer_global_norm": 0.14260439574718475, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 4.17461221147164e-09, "num_module_steps_trained_lifetime": 2942848, "mean_kl_loss": 0.010669050738215446, "vf_explained_var": 0.9998793601989746, "num_module_steps_trained": 222848, "default_optimizer_learning_rate": 0.0003}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.16645962575482207, "add_states_from_episodes_to_batch": 8.22905355831323e-06, "general_advantage_estimation": 0.15240202450449888, "add_columns_from_episodes_to_train_batch": 0.09660946925627642, "add_one_ts_to_episodes_and_truncate": 0.03707656273643314, "add_observations_from_episodes_to_batch": 0.0015686855657611237, "add_time_dim_to_batch_and_zero_pad": 2.52191312397893e-05, "agent_to_module_mapping": 0.006348239150956081, "numpy_to_tensor": 0.007643803931026831}}, "connector_pipeline_timer": 0.46842982576656783}, "learner_connector_sum_episodes_length_out": 1024.03629951678, "num_non_trainable_parameters": 0.0, "num_module_steps_trained_lifetime": 11771392, "learner_connector_sum_episodes_length_in": 1024.03629951678, "num_module_steps_trained": 891392, "num_trainable_parameters": 341960.0, "num_env_steps_trained_lifetime": 23588932, "num_env_steps_trained": 1786266, "num_env_steps_trained_lifetime_throughput": 41511.05250464107}, "speed_2_predator": {"num_module_steps_trained_lifetime": 2942848, "mean_kl_loss": 0.01001821830868721, "vf_explained_var": 2.1457672119140625e-06, "num_module_steps_trained": 222848, "num_trainable_parameters": 94938.0, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 2.3422088623046875, "policy_loss": -0.0714484304189682, "entropy": 3.012547254562378, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.675000011920929, "weights_seq_no": 20.0, "total_loss": 0.25789451599121094, "gradients_default_optimizer_global_norm": 0.10671533644199371, "default_optimizer_learning_rate": 0.0003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.32258063554763794}, "speed_2_prey": {"vf_explained_var": 4.8279762268066406e-05, "policy_loss": -0.1747308224439621, "entropy": 2.9017176628112793, "curr_kl_coeff": 1.0125000476837158, "weights_seq_no": 20.0, "total_loss": 2.539076805114746, "curr_entropy_coeff": 0.0, "gradients_default_optimizer_global_norm": 0.263407438993454, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 2.6984310150146484, "num_module_steps_trained": 222848, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 108826.0, "num_module_steps_trained_lifetime": 2942848, "mean_kl_loss": 0.015187067911028862, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 40.641563415527344}, "speed_1_prey": {"policy_loss": -0.10183452814817429, "entropy": 1.8125081062316895, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.278125047683716, "weights_seq_no": 20.0, "total_loss": 1.9211493730545044, "gradients_default_optimizer_global_norm": 1.3321456909179688, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 1.9846101999282837, "num_module_steps_trained_lifetime": 2942848, "vf_explained_var": -0.00020599365234375, "num_module_steps_trained": 222848, "default_optimizer_learning_rate": 0.0003, "num_trainable_parameters": 71946.0, "mean_kl_loss": 0.01684444211423397, "module_train_batch_size_mean": 128.0, "vf_loss_unclipped": 22.970882415771484}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 20520, "fault_tolerance": {"num_healthy_workers": 4, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "num_env_steps_sampled_lifetime_throughput": 23.843225614121216, "done": false, "training_iteration": 20, "trial_id": "e1a9a_00000", "date": "2025-04-28_19-25-53", "timestamp": 1745893553, "time_this_iter_s": 43.39988374710083, "time_total_s": 588.647424697876, "pid": 22224, "hostname": "bocchi", "node_ip": "172.31.84.7", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "PredPreyGrass", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 4, "num_envs_per_env_runner": 2, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 3, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 600, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "num_learners": 1, "num_gpus_per_learner": 1, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 1024, "num_epochs": 30, "minibatch_size": 128, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fd7ad1207c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "MultiRLModuleSpec(multi_rl_module_class=<class 'ray.rllib.core.rl_module.multi_rl_module.MultiRLModule'>, observation_space=None, action_space=None, inference_only=False, model_config=None, rl_module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)}, load_state_path=None, modules_to_load=None, module_specs={'speed_1_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_predator': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 7, 7), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_1_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(9), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None), 'speed_2_prey': RLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.default_ppo_torch_rl_module.DefaultPPOTorchRLModule'>, observation_space=Box(0.0, 100.0, (4, 9, 9), float64), action_space=Discrete(25), inference_only=False, learner_only=False, model_config={'conv_filters': [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], 'fcnet_hiddens': [256, 256], 'fcnet_activation': 'relu'}, catalog_class=None, load_state_path=None, model_config_dict=None)})", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"speed_1_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(9)", {}], "speed_2_predator": [null, "Box(0.0, 100.0, (4, 7, 7), float64)", "Discrete(25)", {}], "speed_1_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(9)", {}], "speed_2_prey": [null, "Box(0.0, 100.0, (4, 9, 9), float64)", "Discrete(25)", {}]}, "callbacks": "<class 'utils.episode_return_callback.EpisodeReturn'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 588.647424697876, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 8.62542372881356, "ram_util_percent": 42.9864406779661, "gpu_util_percent0": 0.3622033898305085, "vram_util_percent0": 0.23755447547603084}, "timing/iter_minutes": 0.7242993871370952, "timing/avg_minutes_per_iter": 0.49749408662319183, "timing/total_hours_elapsed": 0.16583136220773062}
